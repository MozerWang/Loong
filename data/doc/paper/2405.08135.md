# An Optimal Multilevel Quorum System for Probabilistic Consensus 

Kenan Wood<br>kewood@davidson.edu<br>Davidson College

Hammurabi Mendes<br>hamendes@davidson.edu<br>Davidson College

Jonad Pulaj<br>jopulaj@davidson.edu<br>Davidson College


#### Abstract

We present the notion of a multilevel, slashable quorum system, where an application can obtain gradual levels of assurance that a certain value is bound to be decided (or "finalized") in a global consensus procedure, unless a large number of Byzantine processes are exposed to slashing (that is, penalty on staked assets). Our construction is a highly parameterized generalization of quorum systems based on finite projective spaces, with asymptotic high availability and optimal slashing properties. In particular, we show that any quorum system whose ground elements are disjoint subsets of nodes (e.g. "commmittees" in committee-based consensus protocols) has asymptotic high availability under very reasonable conditions, a general proof with significance of its own. Under similarly relaxed conditions, we show that our construction has asymptotically optimal slashing properties with respect to message complexity and process load; this illustrates a fundamental trade off between message complexity, load, and slashing. Our multilevel construction allows nodes to decide how many "levels" of finalization assurance they wish to obtain, noting that this functionality, if applied to a proof-of-stake blockchain, can be seen either as (i) a form of an early, slashing-based, probabilistic block finalization; or (ii) a service for reorg tolerance.


## 1 Introduction

Quorum systems are set structures whose elements are typically distributed processes (say, servers in a distributed system), so that any two such sets (called quorums) intersect in at least one process. The idea is that applications can obtain an acknowledgment of an operation from all members of a chosen quorum, so that any two such acknowledgements are consistent, due to the intersecting property. Quorum systems have been studied extensively [19, 17, 11] , with applications to consensus [18], database synchronization [1, finite-state-machine replication [12], mutual exclusion [16], among many others.

We are interested in larger, partially-synchronous distributed systems - for instance, blockchains - where consensus is performed using sets of processes called committees. Committees typically produce or acknowledge the next batch of operations - e.g. the next block in blockchains - but, for our purposes, we treat this next batch of operations simply as an arbitrary value $v$. The advantage of using committees is that they can restrict expensive communication primitives [28, 2, 44 to processes confined within each committee, and then later generate a compact committee signature that indicates internal agreement on a certain value $v$. Those compact committee signatures can then be communicated globally with the intention to reach global consensus on $v$.

In blockchains, more specifically, it is very common to have a heuristic-based "fork-choice rule" that constantly defines the "best chain" of ongoing operations, along with a separate "finalization gadget", which chooses one unique, canonical chain to be "final" [21, 3, 29]. The blockchain literature often refers to the fork-choice's "best chain" as the available chain, because its simple
heuristics always allow applications to apply its rules and decide on the most representative chain. That is in contrast with what is often referred as the final chain, which has been subject to the finalization gadget, and often depends on the partially-synchronous assumptions for progress (66, 31] among many others). In this work, we see the heuristic-based fork-choice rules simply as an accounting mechanism pre-consensus, and the finalization gadgets as a formal, global consensus protocols. Our main contribution is to close the semantic gap between the accounting mechanism and the global consensus, giving applications gradual levels of trust - a "sliding window" of trust - that a value will be decided. Importantly, we need to make sure that the availability of the mechanism (that is, its tolerance to unresponsive nodes) remains high, otherwise an operational gap would still exist between the accounting mechanism and the global consensus.

We propose the notion of a multilevel, slashable quorum systems, where processes obtain multiple "levels" of increasing trust that some value $v$ is bound to be decided, unless the adversary exposes a large number of Byzantine processes. As we assume that the adversary deposited a tangible financial stake as guarantee of having their nodes follow the protocol, the scenario where Byzantine processes are exposed incurs in having that stake slashed (that is, reduced). Our technical contributions are:

(i) on a quorum system design applying projective spaces over finite fields to committee-based consensus, a generalization of a previous approach that only used projective planes [24];

(ii) on defining and analyzing slashability - the relation of quorum size and the magnitude of slashing associated with a level of trust, - and showing that our construction is optimal with respect to worst-case message complexity and process load, demonstrating a fundamental trade off between slashability, message complexity, and load; and finally

(iii) on proving that a general class of quorum systems based on disjoint subsets of elements achieve asymptotic high availability under reasonable conditions.

Obtaining the higher-dimensional structures used to define our quorums is expensive, but can be done a priori for reasonable parameters, and later mapped to a running system. We discuss some practical scenarios in Sec. 3 .

Although our results are framed in a larger context, we design our system so that it could be integrated into a proof-of-stake blockchain: nodes initially attest to different next-block candidates, exchange attestations within committees, produce compact threshold signatures of attestations, and, once enough attestations are observed (either directly or indirectly via committee signatures), the nodes globally decide on the next block. We give applications the flexibility to choose the balance of trust and potential adversarial slashing with our quorum construction. We note that this functionality, in the context of blockchains, can be seen either as (i) a form of an early, slashing-based probabilistic block finalization; or (ii) a service for reorg tolerance. Reorgs [27, 22] are situations where applications consider some chain $v$ as the logical continuation of the blockchain ledger because a fraction of nodes attest $v$, but later are forced to consider $v^{\prime}$ as such because a (typically larger) fraction of nodes became visible while attesting $v^{\prime}$. In our system, once applications obtain a certain number of levels of assurance that $v$ is the next block to be finalized, a different block $v^{\prime}$ that takes its place will incur significant adversarial slashing, superlinear to the number of assurance levels originally obtained. Before we discuss the details of our construction in Sec. 3, let us highlight the properties that we are interested in analysing:

- Slashability. If two non-faulty processes trust or decide on different values, there is a large number of Byzantine processes that can be provably slashed.
- Availability. If all non-faulty processes attest to $v$, then with high probability, all processes will decide on $v$.
- Message complexity and load. Quorums must be small relative to the system size, so that the number of network messages needed for a process or committee to query such quorums is small. Furthermore, the maximum load on any process should be low, so that no process or committee is forced to fulfil too many queries.

In Sec. 2, we present basic notation and definitions for quorum systems and for projective spaces over finite fields, which substantiate our construction, given in Sec. 3. In Sec. 4, we show that our construction yields optimal slashing with respect to overall message complexity and maximum load (in particular, the product of the two quantities; see Definition 4.5 and Theorem 4.7) as processes obtain multiple levels of trust in a given value. In Sec. 5 we prove high availability not only for our multilevel quorum system, but to a much larger class of quorum systems. On Sec. 6, we analyze a probabilistic experiment in order to obtain a notion of probabilistic time complexity under idealized network conditions with an ideal broadcasting algorithm; we prove a result which bounds this time complexity in a generalized construction. Finally, we present concluding remarks in Sec. 8 .

## 2 Quorum Systems and Projective Spaces

In this section, we present basic definitions on quorum systems and projective spaces over finite fields, used in our quorum system construction, provided in Sec. 3. In this paper we use the following standard combinatorial notation: for a positive integer $m$, we denote by $[m]$ the set $\{1, \ldots, m\}$. For probability computations, $\mathbf{P}(A)$ denotes the probability of an event $A$ and $\mathbf{E} X$ denotes an expectation of a random variable $X$. Throughout the paper, we assume that the network is partially-synchronous and that less than $1 / 3$ of nodes are subject to Byzantine failures.

### 2.1 Quorum Systems

Let us start with a definition of quorum system, below:

Definition 2.1 (Quorum System). A quorum system is simply a nonempty finite collection of finite sets $\mathcal{Q}$ such that any two sets $A, B \in \mathcal{Q}$ have a nonempty intersection. The sets in $\mathcal{Q}$ are called quorums, and we refer to $\bigcup \mathcal{Q}$ as the ground set of $\mathcal{Q}$.

Quorum systems provide a framework for ensuring probabilistic trust among decided values. Suppose the ground set of a quorum system $\mathcal{Q}$ is the set of processes $\mathbb{P}$. Then if all processes in some quorum $A \in \mathcal{Q}$ attest to a value $v$ and all processes in some quorum $B \in \mathcal{Q}$ attest to $v^{\prime} \neq v$, all processes will eventually learn this information (since every message is attached with a digital signature and the network is partially synchronous). We will therefore be able to deduce that every process in the nonempty set $A \cap B$ attested to different values and can slash these processes' staked assets.

Now, observe that if every quorum contains an adversarial process, these processes can simply be silent forever, which means that no decision can ever be made with this protocol, even if every correct process attested to the same value. This motivates the following:

Definition 2.2 (Availability). Let $\mathcal{Q}$ be a quorum system. Give each element of $\cup \mathbb{Q}$ a fixed probability of availability $p$, so the elements are independently non-faulty with probability $p$ and faulty (Byzantine) with probability $1-p$. Let $F_{p}(\mathcal{Q})$ denote the probability that every quorum in $\mathcal{Q}$ has at least one faulty element. The quantity $A_{p}(\mathcal{Q}):=1-F_{p}(\mathcal{Q})$ is called the availability of $\mathcal{Q}$ with respect to $p$.

Another potential problem is that it is possible for two processes to trust different values if every process in $A \cap B$ is Byzantine, for quorums $A, B \in \mathcal{Q}$. Thus if $\min _{A, B \in \mathcal{Q}}|A \cap B|$ is small, then it is possible for an adversary to make processes decide on different values with only a small amount of its stake being slashed. Thus, a desirable property of quorum systems is that $|A \cap B|$ should be large for all $A, B \in \mathcal{Q}$.

Definition 2.3 (Slashability). For a quorum system $\mathcal{Q}$, define the slashability of $\mathcal{Q}$ to be the quantity $\min _{A, B \in \mathcal{Q}}|A \cap B|$. The slashability of $\mathcal{Q}$ is denoted $\operatorname{slash}(\mathcal{Q})$.

In our design, the elements of the quorums are disjoint committees, which are sets of processes in $\mathbb{P}$. We say that a committee is $r$-available for some $r \in(0,1)$ if at least an $r$ fraction of its processes are available. This motivates the following definition.

Definition 2.4. If $\mathbb{Q}$ is a quorum system whose elements are disjoint committees and $r \in(0,1)$, we denote by $\mathbb{P}_{r}(\mathbb{Q})$ the quorum system

$$
\mathbb{P}_{r}(\mathbb{Q})=\{S \subseteq \mathbb{P}: \exists \mathcal{Q} \in \mathbb{Q}, \forall Q \in \mathcal{Q},|Q \cap S| \geq r|Q|\}
$$

That is, a set of processes forms a quorum in $\mathbb{P}_{r}(\mathbb{Q})$ if it contains at least an $r$-fraction of every committee inside a quorum $\mathcal{Q} \in \mathbb{Q}$. The number $r$ is said to be the threshold of $\mathbb{P}_{r}(\mathbb{Q})$.

The following definitions are inspired by similar notions in 19. These definitions have fundamental connections to slashability, as seen in Sec. 4. In our system, we assume that processes actively participate in obtaining quorums to reduce message complexity. In particular, committees select quorums uniformly at random to which they query messages. Thus, having small quorums is necessary, motivating the following definition.

Definition 2.5 (Message Complexity). Given a quorum system $\mathbb{Q}$, let $\operatorname{msg}(\mathbb{Q})$ denote the maximum size of a quorum in $\mathbb{Q}$. The quantity $\operatorname{msg}(\mathbb{Q})$ is called the message complexity of $\mathbb{Q}$.

Additionally, with this system of actively obtaining quorums, we would like to ensure that no committee is especially busy handling queries from other committees, motivating another concept:

Definition 2.6 (Load). Given a quorum system $\mathbb{Q}$, the load of some $C \in \bigcup \mathbb{Q}$, denoted $\operatorname{load}_{\mathbb{Q}}(C)$, is the probability that a quorum of $\mathbb{Q}$ selected uniformly at random contains $C$. The load of $\mathbb{Q}$ is defined to be the maximum load of any element of $\bigcup \mathbb{Q}: \operatorname{load}(\mathbb{Q}):=\max _{C \in \cup \mathbb{Q}} \operatorname{load}_{\mathbb{Q}}(C)$.

When $\mathbb{Q}$ is clear from context, we simply write $\operatorname{load}(C)$ instead of $\operatorname{load}_{\mathbb{Q}}(C)$, where $C \in \bigcup \mathbb{Q}$. There is a connection between the load of an element of a quorum system and the degree of that element (using terminology from graph theory).

Definition 2.7 (Degree). Given a quorum system $\mathbb{Q}$, the degree of some $C \in \cup \mathbb{Q}$ in $\mathbb{Q}$, written $\operatorname{deg}_{\mathbb{Q}}(C)$, is the number of quorums of $\mathbb{Q}$ containing $C$. The maximum degree of any element of $\bigcup \mathbb{Q}$ is denoted $\Delta(\mathbb{Q})$.

When $\mathbb{Q}$ is clear from context, we write $\operatorname{deg}(C)$ instead of $\operatorname{deg}_{\mathbb{Q}}(C)$, where $C \in \cup \mathbb{Q}$. The following result should be clear from the definition of load and uniform selection.

Observation 2.8. If $\mathbb{Q}$ is a quorum system and $C \in \bigcup \mathbb{Q}$, then

$$
\operatorname{load}(C)=\frac{\operatorname{deg}(C)}{|\mathbb{Q}|} \quad \text { and } \quad \operatorname{load}(\mathbb{Q})=\frac{\Delta(\mathbb{Q})}{|\mathbb{Q}|}
$$

### 2.2 Projective Spaces

Projective geometry provides a rich source of quorum systems that are highly symmetric (having a transitive automorphism group). Most of the definitions and notation in this section are similar to those presented in [7]. To begin, we have the following known result pertaining to finite fields.

Proposition 2.9. If $\mathbb{F}$ is a finite field, then the order of $\mathbb{F}$ is a prime power. Furthermore, if $q$ is a prime power, then there is a unique (up to isomorphism) finite field of order $q$.

Thus, given a prime power $q$, we may let $\mathbb{F}_{q}$ denote the finite field of order $q$. For the following definitions, let $V$ be a vector space over a field $\mathbb{F}$.

Definition 2.10 (Projective Space). The projective space of $V$, denoted $\operatorname{PG}(V)$, is the set of 1 dimensional vector subspaces of $V$. In the case when $\mathbb{F}=\mathbb{F}_{q}$ for a prime power $q$ and $V=\mathbb{F}^{k+1}$, we may write $\mathrm{PG}(k, q)$ instead of $\mathrm{PG}(V)$. If $V$ is finite-dimensional, then the projective dimension of $\mathrm{PG}(V)$ is $\operatorname{dim} \mathrm{PG}(V)=\operatorname{dim} V-1$.

Definition 2.11 (Projective Subspace). If $U$ is a vector subspace of $V$, then $\operatorname{PG}(U)$ is a projective subspace of $\mathrm{PG}(V)$.

Definition 2.12. If $d \geq 0$, let $\mathrm{PG}_{d}(V)$ be the set of all projective subspaces of $\mathrm{PG}(V)$ with (projective) dimensiond. Just as before, if $\mathbb{F}=\mathbb{F}_{q}$ and $V=\mathbb{F}^{k+1}$, we write this as $\mathrm{PG}_{d}(k, q)$.

The following result will be useful for analyzing the slashability of our system design.

Proposition 2.13. Let $k \geq d \geq 0$ and let $q$ be a prime power. Then for any $S, T \in \mathrm{PG}_{d}(k, q)$, then $S \cap T$ is a projective subspace of $\mathrm{PG}(k, q)$ of dimension at least $2 d-k$. If $2 d \geq k$, this bound is sharp for some $S, T \in \mathrm{PG}_{d}(k, q)$.

Proof. Suppose $S, T \in \mathrm{PG}_{d}(k, q)$. Then there exists $(d+1)$-dimensional vector subspaces $U, W \subseteq$ $\mathbb{F}_{q}^{k+1}$ such that $S=\operatorname{PG}(U)$ and $T=\mathrm{PG}(W)$. It follows that $S \cap T=\mathrm{PG}(U \cap W)$, so $S \cap T$ is indeed a projective subspace of $\mathrm{PG}(k, q)$. Since $U+W$ is a subspace of $\mathbb{F}_{q}^{k+1}, U+W$ has dimension at most $k+1$, which shows

$$
\begin{aligned}
\operatorname{dim}(S \cap T) & =\operatorname{dim} \mathrm{PG}(U \cap W)=\operatorname{dim}(U \cap W)-1=\operatorname{dim} U+\operatorname{dim} W-\operatorname{dim}(U+W)-1 \\
& \geq \operatorname{dim} U+\operatorname{dim} W-(k+1)-1=2(d+1)-k-2=2 d-k
\end{aligned}
$$

To show that this bound is sharp for some choice of $S$ and $T$, suppose $2 d \geq k$ and consider any basis $v_{1}, \ldots, v_{k+1}$ of $\mathbb{F}_{q}^{k+1}$. Let $U=\operatorname{span}\left(v_{1}, \ldots, v_{d+1}\right)$ and $W=\operatorname{span}\left(v_{k+1}, v_{k}, \ldots, v_{k-d+1}\right)$. Clearly both $U$ and $W$ are vector spaces of dimension $d+1$. Also, $U \cap W=\operatorname{span}\left(v_{k-d+1}, \ldots, v_{d+1}\right)$, which is a vector space of dimension $(d+1)-(k-d+1)+1=2 d-k+1$. Hence, $\mathrm{PG}(U), \mathrm{PG}(W) \in \mathrm{PG}_{d}(k, q)$ and $\mathrm{PG}(U) \cap \mathrm{PG}(W)=\mathrm{PG}(U \cap W)$ is a projective subspace of $\mathrm{PG}(k, q)$ with projective dimension $\operatorname{dim}(U \cap W)-1=2 d-k$, as desired.

This also gives the following immediate corollary.

Corollary 2.14. If $2 d>k$ and $q$ is any prime power, then $\mathrm{PG}_{d}(k, q)$ is a quorum system.

Here we have a standard result regarding the number of $d$-dimensional projective subspaces of $\mathrm{PG}(k, q)$, which can be easily proven by counting the number of linearly independent lists in $\mathbb{F}_{q}^{k+1}$ of length $d+1$ in two different ways. Given nonnegative integers $r, s$ and $q \geq 2$, recall the known $q$-Gaussian binomial coefficient by the following equality

$$
\binom{s}{r}_{q}=\frac{\left(q^{s}-1\right)\left(q^{s}-q\right) \cdots\left(q^{s}-q^{r-1}\right)}{\left(q^{r}-1\right)\left(q^{r}-q\right) \cdots\left(q^{r}-q^{r-1}\right)}
$$

Proposition 2.15. For all $k \geq d \geq 0$ and prime powers $q$, we have

$$
\left|\mathrm{PG}_{d}(k, q)\right|=\binom{k+1}{d+1}_{q}
$$

We will make use of the following corollary most of the time.

Corollary 2.16. For all $k \geq d \geq 0$ and prime powers $q$,

$$
|\mathrm{PG}(k, q)|=\frac{q^{k+1}-1}{q-1}
$$

Proof. This follows from Theorem 2.15 by observing that $\mathrm{PG}_{0}(k, q)=\{\{S\}: S \in \mathrm{PG}(k, q)\}$, so $\mathrm{PG}(k, q)$ is in bijection with $\mathrm{PG}_{0}(k, q)$.

## 3 System Design

Consider a system of $n$ processes $\mathbb{P}=\left\{P_{1}, \ldots, P_{n}\right\}$. We use the standard assumption that less than $1 / 3$ of $\mathbb{P}$ might display Byzantine behaviour (so basic network primitives such as [2, 28] work) but at the same time assume that processes are non-faulty independently with probability $p$. We assume authenticated channels, that is, every message sent has a digital signature for which it is computationally infeasible for an adversary to forge.

In this section, we will describe a multilevel quorum system where, in each level $j \in[\ell]$, we have a quorum system of its own with ground set composed of committees in $\mathbb{P}$. Obtaining a quorum asserting value $v$ within each level will increase the assurance that a value $v$ is bound to be decided in the global consensus - that is, increase the associated slashing in case $v$ is not decided. We do this while allowing small quorums relative to system size (so with less communication complexity) and very high slashing relative to the size of the quorums. Our system also ensures a small load, as every committee is in the same number of quorums and no committee is particularly overrepresented.

Our multilevel quorum system is defined as follows.

1. Assume a set-up procedure to generate $|\mathrm{PG}(k, q)|$ committees that equitably partition the set of processes $\mathbb{P}$, where $k \geq 0$ is an integer and $q$ is a prime power such that $n \geq|\operatorname{PG}(k, q)|$. Note that when $q$ is a prime power, this is always well-defined. Denote the set of these committees by $\mathcal{C}$, so that $|\mathcal{C}|=|\mathrm{PG}(k, q)|$.
2. Next, define a one-to-one correspondence com : $\mathrm{PG}(k, q) \rightarrow \mathcal{C}$, and two weakly increasing sequences:

- $\left(d_{j}\right)_{j \in[\ell]}$ of integers in $\left(\frac{k}{2}, k\right)$;
- $\left(r_{j}\right)_{j \in[\ell]}$ of real numbers in $\left(\frac{1}{2}, p\right)$.

3. For each level $j \in[\ell]$, the $j$ th level committee quorum system is defined to be

$$
\mathbb{Q}_{j}=\left\{\operatorname{com}(S): S \in \mathrm{PG}_{d_{j}}(k, q)\right\}
$$

4. Finally, for all $j \in[\ell]$, the $j$ th level process quorum system is defined as

$$
\mathcal{Q}_{j}=\mathbb{P}_{r_{j}}\left(\mathbb{Q}_{j}\right)
$$

(i)

![](https://cdn.mathpix.com/cropped/2024_06_04_cdd1db7350d5799306b5g-07.jpg?height=394&width=1549&top_left_y=237&top_left_x=315)

(ii)
![](https://cdn.mathpix.com/cropped/2024_06_04_cdd1db7350d5799306b5g-07.jpg?height=686&width=1468&top_left_y=631&top_left_x=402)

(iii)

![](https://cdn.mathpix.com/cropped/2024_06_04_cdd1db7350d5799306b5g-07.jpg?height=336&width=1532&top_left_y=1334&top_left_x=340)

Figure 1: A tetrahedral visualization of $P G(3,2)$, which contains 15 points, 15 planes, and 35 lines (circles are viewed as lines in projective geometry). More details in the text.

Notice that each $\mathbb{Q}_{j}$ is indeed a quorum system as $\mathrm{PG}_{d_{j}}(k, q)$ is a quorum system by Corollary 2.14. In addition, observe that for all $1 \leq i<j \leq \ell$, every quorum in $\mathcal{Q}_{j}$ contains a quorum in $\mathcal{Q}_{i}$; since every $d_{j}$-dimensional projective subspace of $\mathrm{PG}(k, q)$ contains a $d_{i}$-dimensional projective subspace (this follows from $d_{1} \leq d_{2} \cdots \leq d_{\ell}$ ). Thus, we say that a process trusts a value $v$ with $j$ degrees of assurance if that process obtains a quorum accepting $v$ from $\mathcal{Q}_{j}$.

Visualization. To motivate the geometry of our construction with an example, in Figure 1 we give a tetrahedral visualization of $P G(3,2)$, the smallest three-dimensional projective space. While the dimensions are low enough to allow a visualization, they only allow for a single level in our construction (with $d_{1}=2$ ). Nevertheless, they should be useful to comprehend the system in higher dimensions. For the sake of simplicity, we disregard $r$ and focus on $\mathbb{Q}_{1}$. By definition $P G_{2}(3,2)$ is the set of planes in $P G(3,2)$, where each plane is isomorphic to the Fano plane. In (i),[^0]the outer faces of the tetrahedron are each a Fano plane. In (ii), the internal "wedge" planes are represented, with two planes highlighted. In (iii), we show Fano planes that are isomorphic to the additional planes inside the tetrahedron. Mapping the points in each Fano plane to corresponding points in the tetrahedron and preserving the incidence structure recovers the original plane. Our quorum system $\mathbb{Q}_{1}$ is set of all the visualized Fano planes. It is straightforward to check that any two distinct quorums intersect in a line, in other words they share three committees.

Choice of Parameters (Example). It is crucial that parameters are chosen carefully, or the number of quorums at each level can quickly become too large. In that case, even the idea of precalculating quorums and later have them mapped to committees at runtime would be impractical. But many reasonable choices might exist: for example, consider a network of 2 million nodes, with committee sizes of about 8000 nodes. We can set $k=7, q=2$ and have $d_{1}=4, d_{2}=5$, and $d_{3}=6$, which creates a 3 -level quorum system with sizes $\left|\mathbb{Q}_{1}\right|=\binom{8}{5}_{2}=97155,\left|\mathbb{Q}_{2}\right|=\binom{8}{6}_{2}=10795$ and $\left|\mathbb{Q}_{3}\right|=\binom{8}{7}_{2}=255$ (Proposition 2.15). In the first level, applications need to obtain assurances only from 4 committees forming a quorum $\left(d_{1}=4\right)$ out of 97155 quorums available $\left(\left|\mathbb{Q}_{1}\right|\right)$. Any conflicting quorum intersects in $2^{2 \cdot 4-7+1}-1=3$ committees in common (Lemma 4.3). If we assume that applications get threshold signatures from committees representing a fraction of $r=60 \%$ of their size, this must expose $3 \cdot(0.2 \cdot 8000)$ Byzantine nodes to slashing ${ }^{2}$. In the second level, applications get one extra committee $\left(d_{2}=5\right)$, essentially choosing one quorum out of 10795 options $\left(\left|\mathbb{Q}_{2}\right|\right)$. Now, the number of committees in common jumps to $2^{2 \cdot 5-7+1}-1=15$, thus exposing $15 \cdot(0.2 \cdot 8000)$ Byzantine nodes. In the third level, once again, applications get one extra committee $\left(d_{3}=6\right)$, essentially choosing one quorum out of 255 options $\left(\left|\mathbb{Q}_{3}\right|\right)$. Now, the number of committees in common jumps to $2^{2 \cdot 6-7+1}-1=63$, thus exposing $63 \cdot(0.2 \cdot 8000$ ) Byzantine nodes. Note how applications have many quorum choices at each level, and that the slashing grows super-linearly compared to the number of committees that we need acknowledgement from.

Implementation. While the system as described above is mathematically elegant, and achieves asymptotically optimal slashing (Sec. 4) and high availability (Sec. 5), the above example points out that the number of quorums per level may become too large. As we (reasonably) assume that there is an operational network cost to keep track of quorums (for instance, joining gossip channels in [30]), the applicability is compromised. In addition, calculating such large sets would be inviable. A probabilistic solution for reducing the number of quorums that works for reasonable choices of parameters is the following (reasonable meaning that committee size is large enough so that $k, q$ are small enough).

The first two steps from the above construction remain the same, except, now we have additional parameters that heuristically bound the number of quorums in each level. Let $\left(\delta_{j}\right)_{j \in[\ell]}$ be a weakly increasing list of positive integers such that there exists $\delta_{j}$ distinct $d_{j}$-dimensional projective subspaces of $\mathrm{PG}(k, q)$ with a nonempty intersection. The construction of the $j$ th level committee quorum system is now defined as follows. Define a random map $N_{j}: \mathrm{PG}(k, q) \rightarrow 2^{\mathrm{PG}_{d_{j}}(k, q)}$ by setting $N_{j}(A)$ to be a set of $\delta_{j}$ distinct $d_{j}$-dimensional projective subspaces of $\mathrm{PG}(k, q)$ that contain $A$, chosen uniformly at random ${ }^{3}$. Then, the $j$ th level committee quorum system will be

$$
\mathbb{Q}_{j}^{\prime}=\left\{\operatorname{com}(S): S \in \bigcup_{A \in \operatorname{PG}(k, q)} N_{j}(A)\right\}
$$

and the corresponding $j$ th level process quorum system is still

$$
\mathcal{Q}_{j}^{\prime}=\mathbb{P}_{r_{j}}\left(\mathbb{Q}_{j}^{\prime}\right)
$$[^1]

With this construction, each committee is in approximately the same number of quorums in $\mathbb{Q}_{j}^{\prime}$ with high probability, and we always have that the size of each quorum in $\mathbb{Q}_{j}^{\prime}$ equals the size of each quorum in $\mathbb{Q}_{j}$. Thus the load of $\mathbb{Q}_{j}^{\prime}$ is approximately equal to the load of $\mathbb{Q}_{j}$, and the message complexities of $\mathbb{Q}_{j}^{\prime}$ and $\mathbb{Q}_{j}$ are the same (refer to Definitions 2.6 and 2.5, and Observation 2.8). We also know that $\mathbb{Q}_{j}^{\prime} \subseteq \mathbb{Q}_{j}$ by construction, which immediately implies that the slashability of $\mathbb{Q}_{j}^{\prime}$ (resp. $\mathcal{Q}_{j}^{\prime}$ ) is at least that of $\mathbb{Q}_{j}$ (resp. $\mathcal{Q}_{j}$ ), and equal with very high probability. The availability and probabilistic time results we prove in Secs. 5 and 6 only depend on $\mathcal{C}$, so we obtain the same results with $\mathcal{Q}_{j}$ and with $\mathcal{Q}_{j}^{\prime}$. However, the number of quorums using this method is significantly reduced. In particular, by Proposition 2.15 and Corollary 2.16,

$$
\begin{aligned}
& \left|\mathbb{Q}_{j}^{\prime}\right|=\left|\bigcup_{A \in \operatorname{PG}(k, q)} N_{j}(A)\right| \leq \sum_{A \in \operatorname{PG}(k, q)}\left|N_{j}(A)\right|=\delta_{j}|\mathcal{C}| \\
& \left|\mathbb{Q}_{j}\right|=\binom{k+1}{d_{j}+1}_{q} \approx q^{\left(k-d_{j}\right)\left(d_{j}+1\right)} \geq q^{k d_{j}-d_{j}} \approx|\mathcal{C}|^{d_{j}-\frac{d_{j}}{k}} \geq|\mathcal{C}|^{d_{j}-1}
\end{aligned}
$$

Depending on the application, a more dense or less dense quorum system may be desirable. For example, the density (number of quorums out of all possible) may be related to resilience to an adversary that can target specific processes, instead of a case where Byzantine failures are independent and randomly distributed. However, analysis in different failure models is outside the scope of this paper and relegated to future work.

## 4 Slashability

In this section, we show that our quorum system $\mathcal{Q}_{j}$ has asymptotically optimal slashability, over a general class of quorum systems constructed from committees. Informally, we prove the following.

Theorem 4.1 (Slashing Optimality: Informal). The slashability of the jth-level quorum system $\mathcal{Q}_{j}=\mathbb{P}_{r_{j}}\left(\mathbb{Q}_{j}\right)$ is asymptotically optimal over all quorum systems built with the same set of committees and the same threshold $\left(r_{j}\right)$ with at least as good overall message complexity and load, allowing a certain trade off between the two quantities.

The formal statement and proof of Theorem 4.1 is given in Theorem 4.7, following some useful lemmas. First, let us compute the size of the quorums in $\mathbb{Q}_{j}$ and the slashability of $\mathcal{Q}_{j}$.

Consider the system with parameters as above, all viewed as a function of the number of processes $n$. Fix some $j \in[\ell]$ (also a function of $n$ ). For a more formalized treatment of asymptotic notations as in this section, see Sec. 5. Given functions $f$ and $g$ from $\mathbb{N}$ to $\mathbb{R}$, we say $f$ and $g$ are asymptotically equivalent, written $f \sim g$, if $\lim _{n \rightarrow \infty} \frac{f(n)}{g(n)}=1$.

These first two lemmas compute $\operatorname{msg}\left(\mathbb{Q}_{j}\right)$ and $\operatorname{slash}\left(\mathbb{Q}_{j}\right)$.

Lemma 4.2. The size of each quorum in $\mathbb{Q}_{j}$ is precisely $\frac{q^{d_{j}+1}-1}{q-1}$. If $q=\omega(1)$, then this quantity is asymptotically equivalent to $q^{d_{j}}$.

Proof. Consider any $Q \in \mathbb{Q}_{j}$. Then there exists some $S \in \mathrm{PG}_{d_{j}}(k, q)$ such that $\operatorname{com}(S)=Q$. This implies that $S$ is a $d_{j}$-dimensional projective subspace of $\mathrm{PG}(k, q)$. Hence $S$ is isomorphic to $\mathrm{PG}\left(d_{j}, q\right)$, which has exactly $\frac{q_{j}^{d_{j}+1}-1}{q-1}$ elements, by Corollary 2.16. Since com is a bijection, it follows that $|S|=|Q|=\frac{q^{d_{j}+1}-1}{q-1}$. The second statement follows immediately.

Lemma 4.3. The slashability of $\mathbb{Q}_{j}$ is precisely $\frac{q^{2 d_{j}-k+1}-1}{q-1}$. If $q=\omega(1)$, then this quantity is asymptotically equivalent to $q^{2 d_{j}-k}$.

Proof. Suppose $Q, R \in \mathbb{Q}_{j}$. Then there exist $S, T \in \mathrm{PG}_{d_{j}}(k, q)$ where $\operatorname{com}(S)=Q$ and $\operatorname{com}(T)=R$. By Proposition 2.13, $S \cap T$ is a projective subspace of $\mathrm{PG}(k, q)$ of dimension at least $2 d_{j}-k$. By Corollary 2.16. this implies that $|S \cap T| \geq \frac{q^{2 d_{j}-k+1}-1}{q-1}$. Since com is a bijection, this implies that $\operatorname{slash}\left(\mathbb{Q}_{j}\right) \geq \frac{q^{2 d_{j}-k+1}-1}{q-1}$. However, since the bound in Proposition 2.13 is sharp, this shows $\operatorname{slash}\left(\mathbb{Q}_{j}\right)=\frac{q^{2 d_{j}-k+1}-1}{q-1}$. The second statement follows immediately.

Then Lemmas 4.2 and 4.3 show that if $q=\omega(1)$,

$$
\operatorname{slash}\left(\mathbb{Q}_{j}\right) \sim q^{2 d_{j}-k}=\left(q^{d_{j}}\right)^{2-\frac{k}{d_{j}}} \sim \operatorname{msg}\left(\mathbb{Q}_{j}\right)^{2-\frac{k}{d_{j}}}
$$

Hence $\operatorname{slash}\left(\mathbb{Q}_{j}\right) \sim \operatorname{msg}\left(\mathbb{Q}_{j}\right)^{2-\frac{k}{d_{j}}}$.

In the following result, we assume each committee has the same size, but loosening this restriction does not change the result and is only for simplification.

Proposition 4.4. Suppose every committee in $\mathcal{C}$ contains exactly c processes such that $r_{j} c \in \mathbb{Z}$. Then

$$
\operatorname{slash}\left(\mathcal{Q}_{j}\right)=\left(2 r_{j}-1\right) c \cdot \operatorname{slash}\left(\mathbb{Q}_{j}\right)=\left(2 r_{j}-1\right) c \frac{q^{2 d_{j}-k+1}-1}{q-1}=\left(2 r_{j}-1\right) \frac{q^{2 d_{j}-k+1}-1}{q^{k+1}-1} n
$$

If $q=\omega(1)$,

$$
\operatorname{slash}\left(\mathcal{Q}_{j}\right) \sim\left(2 r_{j}-1\right) q^{2 d_{j}-2 k} n
$$

Proof. Suppose $S, T \in \mathcal{Q}_{j}$. Then there exists $\mathcal{S}, \mathcal{T} \in \mathbb{Q}_{j}$ such that $S$ contains at least $r_{j} c$ processes from each committee in $\mathcal{S}$, and similarly for $T$. Then for each $C \in \mathcal{S} \cap \mathcal{T}$, we have

$$
\begin{aligned}
|S \cap T \cap C| & =|(S \cap C) \cap(T \cap C)| \\
& =|S \cap C|+|T \cap C|-|(S \cap C) \cup(T \cap C)| \\
& \geq r_{j} c+r_{j} c-c=\left(2 r_{j}-1\right) c .
\end{aligned}
$$

Also, $|\mathcal{S} \cap \mathcal{T}| \geq \operatorname{slash}\left(\mathbb{Q}_{j}\right)$. Hence

$$
\begin{aligned}
|S \cap T| & =\sum_{C \in \mathcal{C}}|S \cap T \cap C| \\
& \geq \sum_{C \in \mathcal{S} \cap \mathcal{T}}|S \cap T \cap C| \\
& \geq\left(2 r_{j}-1\right) c \cdot \operatorname{slash}\left(\mathbb{Q}_{j}\right)
\end{aligned}
$$

It follows that $\operatorname{slash}\left(\mathcal{Q}_{j}\right) \geq\left(2 r_{j}-1\right) c \cdot \operatorname{slash}\left(\mathbb{Q}_{j}\right)$.

To prove equality, consider $\mathcal{S}, \mathcal{T} \in \mathbb{Q}_{j}$ such that $|\mathcal{S} \cap \mathcal{T}|=\operatorname{slash}\left(\mathbb{Q}_{j}\right)$. In the following, we say that the identity of process $P_{i} \in \mathbb{P}$ is $i$; the set of process identities is thus $[n]$. Let $S \subseteq \mathbb{P}$ be defined by the following: for all $X \in \mathcal{S}$, pick each of the $r_{j} c$ processes in $X$ with the least identities to be in $S$. Define $T \subseteq \mathbb{P}$ similarly, by selecting the $r_{j} c$ processes of each $X \in \mathcal{T}$ with the greatest identities to be in $T$. Since $r_{j}>\frac{1}{2}$, for all $X \in \mathcal{S} \cap \mathcal{T}$, we have $(S \cap X) \cup(T \cap X)=X$, so that

$$
|S \cap T \cap X|=|S \cap C|+|T \cap C|-|(S \cap C) \cup(T \cap C)|=r_{j} c+r_{j} c-c=\left(2 r_{j}-1\right) c
$$

Hence

$$
|S \cap T|=\sum_{X \in \mathcal{S} \cap \mathcal{T}}|S \cap T \cap X|=\left(2 r_{j}-1\right) c \cdot \operatorname{slash}\left(\mathbb{Q}_{j}\right)
$$

It follows that $\operatorname{slash}\left(\mathcal{Q}_{j}\right)=\left(2 r_{j}-1\right) c \cdot \operatorname{slash}\left(\mathbb{Q}_{j}\right)$.

Since $\mathcal{C}$ is a partition of $\mathbb{P}$, we know $c|\mathcal{C}|=n$, so

$$
c=\frac{n}{|\mathcal{C}|}=\frac{n}{|\mathrm{PG}(k, q)|}=\frac{n(q-1)}{q^{k+1}-1}
$$

by Corollary 2.16. Substituting this expression for $c$ applying Lemma 4.3, we obtain

$$
\operatorname{slash}\left(\mathcal{Q}_{j}\right)=\left(2 r_{j}-1\right) c \frac{q^{2 d_{j}-k+1}-1}{q-1}=\left(2 r_{j}-1\right) \frac{q^{2 d_{j}-k+1}-1}{q^{k+1}-1} n
$$

The simplified asymptotic expression for $\operatorname{slash}\left(\mathcal{Q}_{j}\right)$ when $q=\omega(1)$ follows immediately.

Let us now show the asymptotic optimality of our system. Denote $m=|\mathcal{C}|$, so $m$ is the number of committees. Recall Definitions 2.5 and 2.6. The following defines the set of quorum systems over which we prove optimality.

Definition 4.5. Given $r \in\left(\frac{1}{2}, 1\right), \lambda \in(0,1)$, and a positive integer $1 \leq \mu \leq m$, let $\mathbb{S}(\mu, \lambda, r)$ be the set of all quorum systems of the form $\mathbb{P}_{r}(\mathbb{Q})$, where $\mathbb{Q}$ is a quorum system with ground set $\mathcal{C}$ such that the product of its message complexity and its load is at most $\mu \cdot \lambda$; that is, $\operatorname{msg}(\mathbb{Q}) \cdot \operatorname{load}(\mathbb{Q}) \leq \mu \cdot \lambda$.

Since we will prove the optimality of $\mathcal{Q}_{j}$, we are interested in the maximum slashability of any quorum system in $\mathbb{S}\left(\operatorname{msg}\left(\mathcal{Q}_{j}\right)\right.$, load $\left.\left(\mathbb{Q}_{j}\right), r_{j}\right)$. A special case of a quorum system in this set is $\mathbb{P}_{r_{j}}(\mathbb{Q})$, where $\bigcup \mathbb{Q}=\mathcal{C}$ and $\operatorname{msg}(\mathbb{Q}) \leq \operatorname{msg}\left(\mathbb{Q}_{j}\right)$ and $\operatorname{load}(\mathbb{Q}) \leq \operatorname{load}\left(\mathbb{Q}_{j}\right)$, although we prove optimality in a more general setting.

Lemma 4.6. Suppose each committee has size $c$ and $r c$ is an integer. Let $1 \leq \mu \leq m$ and $\lambda \in(0,1)$. For all $\mathcal{Q} \in \mathbb{S}(\mu, \lambda, r)$, we have $\operatorname{slash}(\mathcal{Q}) \leq(2 r-1) c \cdot \mu \cdot \lambda$.

Proof. Let $\mathcal{Q} \in \mathbb{S}(\mu, \lambda, r)$; let $\mathbb{Q}$ be a quorum system such that $\mathcal{Q}=\mathbb{P}_{r}(\mathbb{Q})$. Then $\operatorname{msg}(\mathbb{Q}) \cdot \operatorname{load}(\mathbb{Q}) \leq$ $\mu \cdot \lambda$. Select $\mathcal{A}, \mathcal{B} \in \mathbb{Q}$ independently and uniformly at random. Then $\operatorname{slash}(\mathbb{Q}) \leq|\mathcal{A} \cap \mathcal{B}|$, so $\operatorname{slash}(\mathbb{Q}) \leq \mathbf{E}|\mathcal{A} \cap \mathcal{B}|$. For each committee $C \in \bigcup \mathbb{Q}$, let $X_{C}$ be the indicator random variable for $C \in \mathcal{A}$ and $C \in \mathcal{B}$, so that $|\mathcal{A} \cap \mathcal{B}|=\sum_{C \in \mathcal{C}} X_{C}$. By linearity of expectation,

$$
\mathbf{E}|\mathcal{A} \cap \mathcal{B}|=\sum_{C \in \mathcal{C}} \mathbf{E} X_{C}
$$

A simple double counting argument shows that

$$
\sum_{C \in \mathcal{C}} \operatorname{deg}(C)=\sum_{\mathcal{S} \in \mathbb{Q}}|\mathcal{S}| \leq \operatorname{msg}(\mathbb{Q}) \cdot|\mathbb{Q}|
$$

so

$$
\sum_{C \in \mathcal{C}} \operatorname{load}(C) \leq \operatorname{msg}(\mathbb{Q})
$$

by Observation 2.8. Also, $\operatorname{load}(C) \leq \operatorname{load}(\mathbb{Q})$ for all $C \in \mathcal{C}$. Since for all $C \in \mathcal{C}$, the events $C \in \mathcal{A}$ and $C \in \mathcal{B}$ are independent with probability $\operatorname{load}(C)$, it follows that

$$
\mathbf{E} X_{C}=\mathbf{P}(C \in \mathcal{A}, C \in \mathcal{B})=\mathbf{P}(C \in \mathcal{A}) \cdot \mathbf{P}(C \in \mathcal{B})=\operatorname{load}(C)^{2}
$$

Hence,

$$
\begin{aligned}
\operatorname{slash}(\mathbb{Q}) & \leq \mathbf{E}|\mathcal{A} \cap \mathcal{B}|=\sum_{C \in \mathcal{C}} \operatorname{load}(C)^{2} \\
& \leq \sum_{C \in \mathcal{C}} \operatorname{load}(\mathbb{Q}) \cdot \operatorname{load}(C) \\
& \leq \operatorname{load}(\mathbb{Q}) \cdot \operatorname{msg}(\mathbb{Q}) \leq \mu \cdot \lambda
\end{aligned}
$$

By the proof of Proposition 4.4 ,

$$
\operatorname{slash}(\mathcal{Q})=(2 r-1) c \cdot \operatorname{slash}(\mathbb{Q}) \leq(2 r-1) c \cdot \lambda \cdot \mu
$$

We now come to our main result with respect to slashability, which is a formalization of Theorem 4.1.

Theorem 4.7. Suppose each committee in $\mathcal{C}$ contains c processes and $r_{j} c \in \mathbb{Z}$. Then $\mathcal{Q}_{j} \in$ $\mathbb{S}\left(\operatorname{msg}\left(\mathbb{Q}_{j}\right), \operatorname{load}\left(\mathbb{Q}_{j}\right), r_{j}\right)$ and if $q=\omega(1)$, then

$$
\operatorname{slash}\left(\mathcal{Q}_{j}\right) \sim \max \left\{\operatorname{slash}(\mathcal{Q}): \mathcal{Q} \in \mathbb{S}\left(\operatorname{msg}\left(\mathbb{Q}_{j}\right), \operatorname{load}\left(\mathbb{Q}_{j}\right), r_{j}\right)\right\}
$$

Proof. It is clear by definition that $\mathcal{Q}_{j} \in \mathbb{S}\left(\operatorname{msg}\left(\mathbb{Q}_{j}\right), \operatorname{load}\left(\mathbb{Q}_{j}\right), r_{j}\right)$. Suppose $q=\omega(1)$. It is also easy to see that

$$
\lim _{n \rightarrow \infty} \frac{\operatorname{slash}\left(\mathcal{Q}_{j}\right)}{\max \left\{\operatorname{slash}(\mathcal{Q}): \mathcal{Q} \in \mathbb{S}\left(\operatorname{msg}\left(\mathbb{Q}_{j}\right), \operatorname{load}\left(\mathbb{Q}_{j}\right), r_{j}\right)\right\}} \leq 1
$$

By Lemma 2.16. $\operatorname{msg}\left(\mathbb{Q}_{j}\right)=\frac{q^{d_{j}+1}-1}{q-1}$. Since every committee in $\mathcal{C}$ has the degree $\Delta\left(\mathbb{Q}_{j}\right)$ in $\mathbb{Q}_{j}$ and every quorum has size $\operatorname{msg}\left(\mathbb{Q}_{j}\right)$, we also have

$$
m \cdot \Delta\left(\mathbb{Q}_{j}\right)=\sum_{C \in \mathcal{C}} \operatorname{deg}_{\mathbb{Q}_{j}}(C)=\sum_{Q \in \mathbb{Q}_{j}}|Q|=\left|\mathbb{Q}_{j}\right| \cdot \operatorname{msg}\left(\mathbb{Q}_{j}\right)
$$

It follows by Observation 2.8 that

$$
\operatorname{load}\left(\mathbb{Q}_{j}\right)=\frac{\Delta\left(\mathbb{Q}_{j}\right)}{\left|\mathbb{Q}_{j}\right|}=\frac{\operatorname{msg}\left(\mathbb{Q}_{j}\right)}{m}
$$

Also, by Corollary 2.16, $m=|\mathcal{C}|=|\mathrm{PG}(k, q)|=\frac{q^{k+1}-1}{q-1}$. By Proposition 4.4, $\operatorname{slash}\left(\mathcal{Q}_{j}\right)=\left(2 r_{j}-\right.$ 1)c $\frac{q^{2 d_{j}-k+1}-1}{q-1}$. By Lemma 4.6, we then have

$$
\begin{aligned}
\frac{\operatorname{slash}\left(\mathcal{Q}_{j}\right)}{\max \left\{\operatorname{slash}(\mathcal{Q}): \mathcal{Q} \in \mathbb{S}\left(\operatorname{msg}\left(\mathbb{Q}_{j}\right), \operatorname{load}\left(\mathbb{Q}_{j}\right), r_{j}\right)\right\}} & \geq \frac{\left(2 r_{j}-1\right) c \frac{q^{q_{j}-k+1}-1}{q-1}}{\left(2 r_{j}-1\right) c \cdot \operatorname{msg}\left(\mathbb{Q}_{j}\right) \cdot \operatorname{load}\left(\mathbb{Q}_{j}\right)} \\
& =\frac{\frac{q^{2 d_{j}-k+1}-1}{q-1}}{\frac{\operatorname{msg}\left(\mathbb{Q}_{j}\right)^{2}}{m}} \\
& =\frac{q^{2 d_{j}-k+1}-1}{q-1} \cdot \frac{\frac{q^{k+1}-1}{q-1}}{\left(\frac{q^{d_{j}+1}-1}{q-1}\right)^{2}} \\
& =\frac{\left(q^{2 d_{j}-k+1}-1\right)\left(q^{k+1}-1\right)}{\left(q^{d_{j}+1}-1\right)^{2}} \\
& \sim 1,
\end{aligned}
$$

as $n \rightarrow \infty$, where the last 1 denotes the constant function on $\mathbb{N}$ that is always equal to the number 1. It follows that

$$
\operatorname{slash}\left(\mathcal{Q}_{j}\right) \sim \max \left\{\operatorname{slash}(\mathcal{Q}): \mathcal{Q} \in \mathbb{S}\left(\operatorname{msg}\left(\mathbb{Q}_{j}\right), \operatorname{load}\left(\mathbb{Q}_{j}\right), r_{j}\right)\right\}
$$

## 5 Availability

In this section we demonstrate that under only mild assumptions, any multilevel quorum system that generalizes our approach has an asymptotically high availability (including the case when the number of levels is 1 ). We consider the results of this section relevant on their own, thus the results will be presented with a more general notation (from Sec. 21, rather than relying on specific notation from of our concrete construction in Sec. 3. In particular, we prove a formalization of the following statement. The ideas used in its proof are inspired by the proof of high availability in the projective plane system in $[24]$.

Theorem 5.1 (Availability: Informal). Suppose processes are available with probability $p$. Suppose $\mathcal{C}$ is a partition of the processes into committees and $\mathbb{Q}$ is any quorum system with ground set $\mathcal{C}$. If $\frac{1}{2}<r<p$ and the smallest committee has size $\Omega(\log n)$, then the quorum system $\mathbb{P}_{r}(\mathbb{Q})$ has availability converging to 1 .

The formal statement and proof of Theorem 5.1 is concluded in Corollary 5.6, following some useful lemmas below. Lets start by formalizing our assumptions. For each $n \geq 1$, let $\mathcal{C}^{n}$ be a partition of an $n$-element set of processes, and let $\mathbb{Q}^{n}$ be a quorum system with ground set $\mathcal{C}^{n}$. Let $p$ be the probability a process is available in its steady-state, with $p>1 / 2$. For each $n \geq 1$, let $r_{n} \in\left(\frac{1}{2}, p\right)$ so that $\left(r_{n}\right)_{n \in \mathbb{N}}$ is weakly increasing and $r:=\sup _{n \in \mathbb{N}} r_{n}<p 4^{4}$ Finally, define $c_{n}=\min _{C \in \mathcal{C}^{n}}|C|$; that is, $c_{n}$ the smallest size of any set within the partition $\mathcal{C}^{n}$ (that, more generally, models committees).

First, we state the following well-known Chernoff bound on the binomial tail probability.

Lemma 5.2. Let $Z$ be a binomial random variable with parameters $n$ and $q$. If $\delta>0$, then

$$
\mathbf{P}(Z \geq(1+\delta) n q) \leq \exp \left(-\frac{\delta^{2} n q}{2+\delta}\right)
$$

Now let us bound the probability that a committee of size $c$ does not have at least $r c$ available processes. Denote this probability by $F_{p}(c ; r)$. Define the function $a_{1}(x)=\frac{(p-x)^{2}}{2-p-x}$ for $x \in[0, r]$.

Lemma 5.3. Suppose $0<r<p<1$. We have $F_{p}(c ; r) \leq e^{-a_{1}(r) \cdot c}$.

Proof. Let $Z$ be the number of unavailable processes in a committee of size $c$. It is easy to see that $Z$ is a binomial random variable with parameters $c$ and $q=1-p$. Then we have

$$
F_{p}(c ; r)=\mathbf{P}(Z>c-r c) \leq \mathbf{P}\left(Z \geq \frac{1-r}{q} \cdot c q\right)=\mathbf{P}\left(Z \geq\left(1+\frac{1-r-q}{q}\right) \cdot c q\right)
$$[^2]

Using $\delta=\frac{1-r-q}{q}=\frac{p-r}{q}$ in Lemma $5.2(\delta>0$ since $r<p)$, we obtain

$$
F_{p}(c ; r) \leq \exp \left(-\frac{1}{2+\frac{p-r}{q}}\left(\frac{p-r}{q}\right)^{2} c q\right)=\exp \left(-\frac{(p-r)^{2}}{2-p-r} \cdot c\right)
$$

Lemma 5.4. For all positive integers $n$, we have

$$
A_{p}\left(\mathbb{P}_{r_{n}}\left(\mathbb{Q}^{n}\right)\right) \geq 1-\frac{n}{c_{n}} \cdot e^{-a_{1}(r) \cdot c_{n}}
$$

Proof. Recall $r=\sup _{n \in \mathbb{N}} r_{n}<p$. Fix some positive integer $n$. For each $C \in \mathcal{C}^{n}$, let $E_{C}$ be the event that at least $r_{n}|C|$ of the processes in $C$ are available. Then each $E_{C}$ is independent since the sets in $\mathcal{C}^{n}$ are pairwise disjoint. Hence, by Lemma 5.3,

$$
\begin{aligned}
A_{p}\left(\mathbb{P}_{r_{n}}\left(\mathbb{Q}^{n}\right)\right) & \geq \mathbf{P}\left(\bigcap_{C \in \mathcal{C}^{n}} E_{C}\right)=\prod_{C \in \mathcal{C}^{n}} \mathbf{P}\left(E_{C}\right) \\
& =\prod_{C \in \mathcal{C}^{n}}\left(1-F_{p}\left(|C| ; r_{n}\right)\right) \\
& \geq \prod_{C \in \mathcal{C}^{n}}\left(1-\exp \left(-a_{1}\left(r_{n}\right) \cdot|C|\right)\right)
\end{aligned}
$$

A straightforward computation shows that for $x \in[0, r]$, we have $a_{1}^{\prime}(x)=\frac{(x-p)(4-3 p-x)}{(2-p-x)^{2}}$; since $0 \leq x \leq r<p$, we have $x-p<0,4-3 p-x>0$, and $(2-p-x)^{2}>0$, which implies $a_{1}^{\prime}(x)<0$ on $[0, r]$. Thus $a_{1}(x)$ is decreasing on $[0, r]$. Since $r_{n} \leq r<p$, this shows $a_{1}\left(r_{n}\right) \geq a_{1}(r)$. Also, $|C| \geq c_{n}$ for all $C \in \mathcal{C}^{n}$ implies $\left|\mathcal{C}^{n}\right| \leq \frac{n}{c_{n}}$. Putting these results together, we obtain

$$
\begin{aligned}
A_{p}\left(\mathbb{P}_{r_{n}}\left(\mathbb{Q}^{n}\right)\right) & \geq \prod_{C \in \mathcal{C}^{n}}\left(1-\exp \left(-a_{1}(r) \cdot c_{n}\right)\right) \\
& =\left(1-e^{-a_{1}(r) \cdot c_{n}}\right)^{\left|\mathcal{C}^{n}\right|} \geq\left(1-e^{-a_{1}(r) \cdot c_{n}}\right)^{\frac{n}{c_{n}}}
\end{aligned}
$$

Recall that for all $k \geq 1$ and $0 \leq y \leq x \leq 1$, the following known inequality $k(x-y) \geq x^{k}-y^{k}$ holds. Using $k=\frac{n}{c_{n}}$ (which is at least 1 since $\left.c_{n} \leq n\right), x=1, y=1-e^{-a_{1}(r) \cdot c_{n}}$ yields $\frac{n}{c_{n}}(1-(1-$ $\left.\left.e^{-a_{1}(r) \cdot c_{n}}\right)\right) \geq 1-\left(1-e^{-a_{1}(r) \cdot c_{n}}\right)^{\frac{n}{c_{n}}}$, which, following algebraic manipulations, implies the desired bound.

Now we are ready to prove our main theorem. We say a property $R(n)$ that is true or false for every positive integer $n$ holds for sufficiently large $n$ if there exists a positive integer $N$ such that $n \geq N$ implies $R(n)$ is true.

Theorem 5.5. Suppose $a>0$ such that for all sufficiently large $n$, we have $c_{n} \geq a \log n$. If $a=\frac{b+1}{a_{1}(r)}=\frac{2-p-r}{(p-r)^{2}}(b+1)$ for some constant $b$, then

$$
A_{p}\left(\mathbb{P}_{r_{n}}\left(\mathbb{Q}^{n}\right)\right) \geq 1-\frac{1}{a \cdot n^{b} \cdot \log n}=1-O\left(\frac{1}{n^{b} \cdot \log n}\right)
$$

Proof. Using the bound in Lemma 5.4, for sufficiently large $n$, we obtain

$$
\begin{aligned}
A_{p}\left(\mathbb{P}_{r_{n}}\left(\mathbb{Q}^{n}\right)\right) & \geq 1-\frac{n}{c_{n}} \cdot e^{-a_{1}(r) \cdot c_{n}} \geq 1-\frac{n}{a \log n} \cdot e^{-a_{1}(r) \cdot a \log n} \\
& =1-\frac{n}{a \log n} \cdot n^{-a_{1}(r) a}=1-\frac{1}{a \cdot n^{a_{1}(r) a-1} \cdot \log n} \\
& =1-\frac{1}{a \cdot n^{b} \cdot \log n}
\end{aligned}
$$

This immediately leads to the following corollary.

Corollary 5.6. Suppose $a$ and $b$ are constants satisfying the hypotheses of Theorem 5.5. If $b \geq 0$, then

$$
\lim _{n \rightarrow \infty} A_{p}\left(\mathbb{P}_{r_{n}}\left(\mathbb{Q}^{n}\right)\right)=1
$$

## 6 Probabilistic Time Complexity

In this section, we are interested in bounding the expected number of messages needed for a given process to decide under very idealized network conditions. Since the network is assumed to be partially synchronous, all messages arrive after an unknown, but bounded delay. We assume that no processes are faulty and that we have an underlying broadcast protocol where processes immediately forward a received message directly to every other process. These assumptions are highly theoretical and admittedly unrealistic, but nonetheless provide a heuristic model for analyzing time complexity. Within this model, messages are received in an essentially random order, so our measure of time complexity is probabilistic and defined as follows.

Definition 6.1 (Probabilistic Time). Let $\mathcal{Q}$ be a quorum system with elements $X$. Consider the following probabilistic experiment. Initialize $S$ with $\emptyset$. While $S$ does not contain any quorum of $\mathcal{Q}$, pick $x$ uniformly at random from $X \backslash S$ and add $x$ to $S$. We define the probabilistic time of $\mathcal{Q}$, denoted $T(\mathcal{Q})$ to be the quantity $\mathbf{E}|S|$.

In the main result of this section (Corollary 6.3), we analyze the probabilistic time of our system. Similarly to the previous section, we present our results with more general applicability (any multilevel quorum system, including the case when the number of levels is 1).

Let $\mathcal{C}$ be a partition of $n$ processes $\mathbb{P}$ and $\mathbb{Q}$ be a quorum system whose ground set is $\mathcal{C}$. Define $r \in\left(\frac{1}{2}, 1\right)$, and view $\mathcal{C}, \mathbb{P}, \mathbb{Q}$ as functions of $n$. We will analyze the probabilistic time complexity of $\mathcal{Q}=\mathbb{P}_{r}(\mathbb{Q})$. Similar to the last section, we define $c=\min _{C \in \mathcal{C}}|C|$.

Theorem 6.2. Suppose $c \geq a \log n$ for a positive constant a satisfying $a>\frac{4}{1-r}$. Then

$$
\lim _{n \rightarrow \infty} \frac{T(\mathcal{Q})}{n} \leq r+2 \sqrt{\frac{1-r}{a}}
$$

Proof. Let $\pi=\pi_{1} \cdots \pi_{n}$ be a permutation of $\mathbb{P}$ chosen uniformly at random. Let $X$ be the least $k$ such that $\left\{\pi_{1}, \ldots, \pi_{k}\right\}$ contains a quorum of $\mathcal{Q}$. For each $k \in[n]$, let $E_{k}$ be the event that $\left\{\pi_{1}, \ldots, \pi_{k}\right\}$ contains some quorum of $\mathcal{Q}$; let $X_{k}$ be the indicator random variable for $E_{k}$, so $X_{k}=I\left(E_{k}\right)$. It follows that

$$
X=X_{1}+2\left(X_{2}-X_{1}\right)+3\left(X_{3}-X_{2}\right)+\cdots+n\left(X_{n}-X_{n-1}\right)=n X_{n}-\left(X_{1}+\cdots+X_{n-1}\right)
$$

By linearity of expectation and observing that clearly $\mathbf{E} X_{n}=1$, we obtain

$$
\begin{equation*}
T(\mathcal{Q})=\mathbf{E} X=n-\left(\mathbf{E} X_{1}+\cdots+\mathbf{E} X_{n-1}\right) \tag{1}
\end{equation*}
$$

To upper bound $\mathbf{E} X$, it suffices to lower bound each $\mathbf{E} X_{k}$. So fix $k \in[n]$. It is clear that $\mathbf{E} X_{k}$ is the probability that a randomly chosen $k$-element subset of $\mathbb{P}$ contains a quorum of $\mathcal{Q}$. Instead, consider the following random experiment. Let $S$ be a subset of $\mathbb{P}$ chosen so that each $P_{i} \in \mathbb{P}$ is in $S$ with probability $p_{k}=\frac{1}{1+\delta_{k}} \frac{k}{n}$, where $\delta_{k} \geq 0$. (Below we derive restrictions on $\delta_{k}$ to get the desired result.) Let $R_{k}$ be the event that $S$ contains a quorum of $\mathcal{Q}$. Observe that $|S|$ has a binomial distribution with parameters $n$ and $p_{k}$, so $\mathbf{E}|S|=n p_{k}=\frac{k}{1+\delta_{p}}$. By the Chernoff bound for the binomial distribution (Lemma 5.2), we have

$$
\mathbf{P}(|S|>k) \leq \mathbf{P}(|S| \geq k)=\mathbf{P}\left(|S| \geq\left(1+\delta_{k}\right) \mathbf{E}|S|\right) \leq e^{-\frac{\delta_{k}^{2} \frac{k}{1+\delta_{k}}}{2+\delta_{k}}}=e^{-\frac{\delta_{k}^{2}}{\left(1+\delta_{k}\right)\left(2+\delta_{k}\right)} k}
$$

Then,

$$
\begin{aligned}
\mathbf{E} X_{k} & =\mathbf{P}\left(R_{k}|| S \mid=k\right) \geq \mathbf{P}\left(R_{k}|| S \mid \leq k\right) \\
& =\frac{\mathbf{P}\left(R_{k},|S| \leq k\right)}{\mathbf{P}(|S| \leq k)} \\
& =\frac{\mathbf{P}\left(R_{k}\right)-\mathbf{P}\left(R_{k},|S|>k\right)}{\mathbf{P}(|S| \leq k)} \\
& \geq \mathbf{P}\left(R_{k}\right)-\mathbf{P}(|S|>k) \\
& \geq A_{p_{k}}\left(\mathbb{P}_{r}(\mathbb{Q})\right)-e^{-\frac{\delta_{k}^{2}}{\left(1+\delta_{k}\right)\left(2+\delta_{k}\right)}} k
\end{aligned}
$$

Let us apply Theorem 5.5, so we must assume $p_{k}>r$, which holds if and only if $\delta_{k}<\frac{k}{r n}-1$. Let $b=a \cdot \frac{\left(p_{k}-r\right)^{2}}{2-p_{k}-r}-1$. Then Theorem 5.5 shows that

$$
\mathbf{E} X_{k} \geq 1-\frac{1}{a \cdot n^{b} \cdot \log n}-e^{-\frac{\delta_{k}^{2}}{\left(1+\delta_{k}\right)\left(2+\delta_{k}\right)} k}
$$

Now suppose $k \geq\left(r+2 \sqrt{\frac{1-r}{a}}\right) n$ (we know this lower bound is less than $n$ since $a>\frac{4}{1-r}$ ). Let $\delta_{k}=\frac{k}{n}\left(r+2 \sqrt{\frac{1-r}{a}}\right)^{-1}-1$, which is at least 0 by the bound on $k$. Then $p_{k}=\frac{1}{1+\delta_{k}} \frac{k}{n}=r+2 \sqrt{\frac{1-r}{a}}$; in particular, $p_{k}>r$. This implies $\left(p_{k}-r\right)^{2}=4 \frac{1-r}{a}=\frac{2}{a}(2-r-r) \geq \frac{2}{a}\left(2-p_{k}-r\right)$, so that $b_{k}=a \frac{\left(p_{k}-r\right)^{2}}{2-p_{k}-r}-1 \geq 1$. This shows that

$$
\frac{1}{a \cdot n^{b} \log n} \leq \frac{1}{a \cdot n \cdot \log n}
$$

Now write $d=r+2 \sqrt{\frac{1-r}{a}}$ and $f=d^{-1}\left(1+d^{-1}\right)$. Then $0 \leq \delta_{k} \leq d^{-1}-1$, so $\left(1+\delta_{k}\right)\left(2+\delta_{k}\right) \leq f$. For any $\epsilon \geq 0$, if $k \geq(1+\epsilon)\left(r+2 \sqrt{\frac{1-r}{a}}\right) n=(1+\epsilon) d n$, then $\delta_{k} \geq \epsilon$; for all such $k$, we have

$$
e^{-\frac{\delta_{k}^{2}}{\left(1+\delta_{k}\right)\left(2+\delta_{k}\right)} k} \leq e^{-\frac{\epsilon^{2}}{f}(1+\epsilon) d n} \leq e^{-\frac{d}{f} \epsilon^{2} n}
$$

Putting all of this together, and bound each $\mathbf{E} X_{k} \geq 0$ for all $k<(1+\epsilon) d n$, we obtain

$$
\begin{aligned}
\sum_{k=1}^{n-1} \mathbf{E} X_{k} & \geq \sum_{k=(1+\epsilon) d n}^{n-1}\left(1-\frac{1}{a \cdot n^{b} \cdot \log n}-e^{-\frac{\delta_{k}^{2}}{\left(1+\delta_{k}\right)\left(2+\delta_{k}\right)}} k\right) \\
& \geq n-(1+\epsilon) d n-\frac{n-(1+\epsilon) d n}{a \cdot n \cdot \log n}-(n-(1+\epsilon) d n) e^{-\frac{d}{f} \epsilon^{2} n} \\
& =(1-(1+\epsilon) d) n-\frac{1-(1+\epsilon) d}{a \log n}-(1-(1+\epsilon) d) n e^{-\frac{d}{f} \epsilon^{2} n}
\end{aligned}
$$

In choosing $\epsilon=\frac{1}{\log n}$, we know that for sufficiently large $n, 1-(1+\epsilon) d>0$ since $a>\frac{4}{1-r}$; we also have $e^{-\frac{f}{d} \epsilon^{2} n}=o(n)=o((1-(1+\epsilon) d) n)$. Hence, with this choice of $\epsilon$, we obtain

$$
\lim _{n \rightarrow \infty} \frac{1}{n} \sum_{k=1}^{n-1} \mathbf{E} X_{k} \geq 1-d
$$

Hence

$$
\lim _{n \rightarrow \infty} \frac{T(\mathcal{Q})}{n}=\lim _{n \rightarrow \infty} 1-\frac{1}{n} \sum_{k=1}^{n-1} \mathbf{E} X_{k} \leq d=r+2 \sqrt{\frac{1-r}{a}}
$$

We have the following immediate corollary.

Corollary 6.3. If $c=\omega(\log n)$, then

$$
\lim _{n \rightarrow \infty} \frac{T(\mathcal{Q})}{n} \leq r
$$

Proof. Since $c=\omega(\log n)$, we know $\lim _{n \rightarrow \infty} \frac{c}{\log n}=\infty$. Then for all $a>\frac{4}{1-r}$, for all sufficiently large $n$, we have $\frac{c}{\log n} \geq a$, so $c \geq a \log n$. Then, for all such $a$, Theorem 6.2 implies

$$
\lim _{n \rightarrow \infty} \frac{T(\mathcal{Q})}{n} \leq r+2 \sqrt{\frac{1-r}{a}}
$$

Since this inequality holds for arbitrarily large $a$, we must have

$$
\lim _{n \rightarrow \infty} \frac{T(\mathcal{Q})}{n} \leq r
$$

## 7 Related Work

Quorum systems have been studied extensively in the literature, much in connection with the finite-state-machine replication model [26] and its related problems and applications: database synchronization [1], mutual exclusion [16], consensus [18], and others. Crucial metrics of quorums systems, such as server load and system availability are studied, for example in [19, 23]. Naturally, the design of quorums is highly impacted by its target applications. For abstract-data-type replication, ADT-specific information can play a role [12, 13. Another interesting application showing
high impact on quorum design is federated Byzantine consensus: in this case, non-uniform quorum systems, where each participant has its own notion of membership, are studied in [11, with ideas originating from practical systems such as the Stellar consensus protocol 18]. An additional important considerations for quorum design are whether the system allows dynamic participation [20, 55].

Block designs are well-studied structures in combinatorics [8] which provide a rich family of parameterized quorum systems [9. A well-known family of block designs corresponds to finite projective planes and their respective quorum systems. One of its earliest applications in distributed systems is an algorithm that uses $O(\sqrt{n})$ messages to create mutual exclusion in a network, where $n$ is the number or nodes [16]. Although finite projective planes that yield small quorums are desirable due to reduction in communication complexity, asymptotically their availability goes to zero [24, 14]. However, a construction with finite projective planes where points are disjoint subsets that cover the ground set and quorums are achieved on an $r$ fraction of elements in the subsets yields asymptotic high availability [24]. A novel way of leveraging projective spaces in quorum systems for the in-network data storage paradigm is introduced and explored in [25, 15, where a $2 \mathrm{D}$ network is "lifted" onto a sphere using a projective map to enable more flexible quorums.

## 8 Conclusion

In this work, we propose an application of combinatorial designs using projective spaces over finite fields to provide gradual levels of consensus - that is, getting gradual assurance that a certain value is bound to be decided in a global consensus procedure. We combine our design with a committeebased approach, in order to provide high availability. In fact, we prove not only that our construction is subject to high availability, but we show that any approach that uses our "sliding window" of obtaining attestations in the range strictly between $\frac{1}{2}$ and the individual process availability also forms a highly available quorum system. In addition, we demonstrate that our construction has optimal slashability - the extent we penalize an adversary's assets upon protocol non-compliance - compared to other systems that operate under similar load and message complexity.

We consider the potential applicability of our system very exciting, as we envision that highlyconnected participant nodes can even buy and sell "trust certificates" associated with assurances that a value is bound to be decided. That is, nodes obtain collections of individual and threshold signatures that form multiple quorums, and then offer these trust certificates as insurance to applications (potentially in a blockchain). In fact, these insurance providers could offer their services in zero-knowledge - that is, without revealing the identity of the quorums used to substantiate the trust, in a direct application of techniques like 10].

Having a more gradual consensus - a "sliding window" of probabilistic trust - can bring large improvements in blockchain usability, providing services such as early (probabilistic) finalization, reorg tolerance, and even supporting transaction insurance to reorgs. We are excited to spearhead initial theoretical work in this direction.

Acknowledgement. This work has been partially supported by an academic grant (FY220668) from the Ethereum Foundation.

## References

[1] A. El Abbadi and S. Toueg. Maintaining availability in partitioned replicated databases. ACM Trans. Database Syst., 14(2):264-290, jun 1989.

[2] G. Bracha. Asynchronous Byzantine agreement protocols. Information and Computation, $75(2): 130-143$, November 1987.

[3] Vitalik Buterin and Virgil Griffith. Casper the friendly finality gadget. CoRR, abs/1710.09437, 2017.

[4] Christian Cachin, Rachid Guerraoui, and Lus Rodrigues. Introduction to Reliable and Secure Distributed Programming. Springer, 2 edition, February 2011.

[5] Christian Cachin, Giuliano Losa, and Luca Zanolini. Quorum Systems in Permissionless Networks. In Eshcar Hillel, Roberto Palmieri, and Etienne Rivire, editors, 26th International Conference on Principles of Distributed Systems (OPODIS 2022), volume 253 of Leibniz International Proceedings in Informatics (LIPIcs), pages 17:1-17:22, Dagstuhl, Germany, 2023. Schloss Dagstuhl - Leibniz-Zentrum fr Informatik.

[6] Miguel Castro and Barbara Liskov. Practical byzantine fault tolerance. In Proceedings of the Third Symposium on Operating Systems Design and Implementation, OSDI '99, page 173-186, USA, 1999. USENIX Association.

[7] David C Clark. Applications of finite geometries to designs and codes. Michigan Technological University, 2012.

[8] Charles J Colbourn. CRC handbook of combinatorial designs. CRC press, 2010.

[9] Charles J Colbourn, Jeffrey H Dinitz, and Douglas R Stinson. Quorum systems constructed from combinatorial designs. Information and Computation, 169(2):160-173, 2001.

[10] Ariel Gabizon, Zachary J. Williamson, and Oana Ciobotaru. Plonk: Permutations over lagrange-bases for oecumenical noninteractive arguments of knowledge. Cryptology ePrint Archive, Paper 2019/953, 2019. https://eprint.iacr.org/2019/953.

[11] lvaro Garca-Prez and Alexey Gotsman. Federated Byzantine Quorum Systems. In Jiannong Cao, Faith Ellen, Luis Rodrigues, and Bernardo Ferreira, editors, 22nd International Conference on Principles of Distributed Systems (OPODIS 2018), volume 125 of Leibniz International Proceedings in Informatics (LIPIcs), pages 17:1-17:16, Dagstuhl, Germany, 2019. Schloss Dagstuhl - Leibniz-Zentrum fr Informatik.

[12] Maurice Herlihy. A quorum-consensus replication method for abstract data types. ACM Trans. Comput. Syst., 4(1):32-53, feb 1986.

[13] Maurice Herlihy. Dynamic quorum adjustment for partitioned data. ACM Trans. Database Syst., 12(2):170-194, jun 1987.

[14] Akhil Kumar and Shun Yan Cheung. A high availability $\sqrt{N}$ hierarchical grid algorithm for replicated data. Information Processing Letters, 40(6):311-316, 1991.

[15] Jun Luo and Ying He. Geoquorum: Load balancing and energy efficient data access in wireless sensor networks. In 2011 Proceedings IEEE INFOCOM, pages 616-620. IEEE, 2011.

[16] Mamoru Maekawa. A $\sqrt{N}$ algorithm for mutual exclusion in decentralized systems. ACM Transactions on Computer Systems (TOCS), 3(2):145-159, 1985.

[17] Dahlia Malkhi, Michael Reiter, and Rebecca Wright. Probabilistic quorum systems. In Proceedings of the Sixteenth Annual ACM Symposium on Principles of Distributed Computing, PODC '97, page 267-273, New York, NY, USA, 1997. Association for Computing Machinery.

[18] David Mazires. The stellar consensus protocol: A federated model for internet-level consensus. Technical report, StellarDevelopmentFoundation, 2016.

[19] M. Naor and A. Wool. The load, capacity and availability of quorum systems. In Proceedings 35th Annual Symposium on Foundations of Computer Science, pages 214-225, 1994.

[20] Moni Naor and Udi Wieder. Scalable and dynamic quorum systems. Distributed Computing, $17(4): 311-322,2005$.

[21] Joachim Neu, Ertem Nusret Tas, and David Tse. Ebb-and-flow protocols: A resolution of the availability-finality dilemma. In 2021 IEEE Symposium on Security and Privacy (SP), pages 446-465, 2021.

[22] Joachim Neu, Ertem Nusret Tas, and David Tse. Two more attacks on proof-of-stake ghost/ethereum. In Proceedings of the 2022 ACM Workshop on Developments in Consensus, pages 43-52, 2022.

[23] David Peleg and Avishai Wool. The availability of quorum systems. Information and Computation, 123(2):210-223, 1995.

[24] Sampath Rangarajan, Sanjeev Setia, and Satish K Tripathi. A fault-tolerant algorithm for replicated data management. IEEE Transactions on parallel and distributed systems, $6(12): 1271-1282,1995$.

[25] Rik Sarkar, Xianjin Zhu, and Jie Gao. Double rulings for information brokerage in sensor networks. In Proceedings of the 12th annual international conference on mobile computing and networking, pages 286-297, 2006.

[26] Fred B. Schneider. Implementing fault-tolerant services using the state machine approach: a tutorial. ACM Comput. Surv., 22(4):299-319, dec 1990.

[27] Caspar Schwarz-Schilling, Joachim Neu, Barnab Monnot, Aditya Asgaonkar, Ertem Nusret Tas, and David Tse. Three attacks on proof-of-stake ethereum. In International Conference on Financial Cryptography and Data Security, pages 560-576. Springer, 2022.

[28] T. Srikanth and S. Toueg. Simulating authenticated broadcasts to derive simple fault-tolerant algorithms. Distributed Computing, 2(2):80-94, June 1987.

[29] Alistair Stewart and Eleftherios Kokoris-Kogia. GRANDPA: a byzantine finality gadget. CoRR, abs/2007.01560, 2020.

[30] Dimitris Vyzovitis, Yusef Napora, Dirk McCormick, David Dias, and Yiannis Psaras. Gossipsub: Attack-resilient message propagation in the filecoin and eth2.0 networks, 2020.

[31] Maofan Yin, Dahlia Malkhi, Michael K. Reiter, Guy Golan Gueta, and Ittai Abraham. Hotstuff: Bft consensus with linearity and responsiveness. In Proceedings of the 2019 ACM Symposium on Principles of Distributed Computing, PODC '19, page 347-356, New York, NY, USA, 2019. Association for Computing Machinery.


[^0]:    ${ }^{1}$ An equitable partition of a finite set $S$ is a partition of $S$ such that the sizes of the sets in the partition differ by at most 1 .

[^1]:    ${ }^{2}$ Two subsets of $60 \%$ of a ground set $S$ must intersect in $20 \%$ of the nodes in $S$.

    ${ }^{3}$ Given a set $S, 2^{S}$ denotes the power set of $S$.

[^2]:    ${ }^{4}$ Note that the $r$ 's presented in this section are not related to the $\ell$ different $r$-values used to define our multilevel quorum system in Sec. 3 .

