# TAKE A STEP BACK: EVOKING REASONING VIA ABSTRACTION IN LARGE LANGUAGE MODELS 

Huaixiu Steven Zheng* Swaroop Mishra* Xinyun Chen Heng-Tze Cheng<br>Ed H. Chi Quoc V Le Denny Zhou

Google DeepMind


#### Abstract

We present StEP-BACK PROMPTING, a simple prompting technique that enables LLMs to do abstractions to derive high-level concepts and first principles from instances containing specific details. Using the concepts and principles to guide reasoning, LLMs significantly improve their abilities in following a correct reasoning path towards the solution. We conduct experiments of StEP-BACK Prompting with PaLM-2L, GPT-4 and Llama2-70B models, and observe substantial performance gains on various challenging reasoning-intensive tasks including STEM, Knowledge QA, and Multi-Hop Reasoning. For instance, STEP-BACK PromptING improves PaLM-2L performance on MMLU (Physics and Chemistry) by $7 \%$ and $11 \%$ respectively, TimeQA by $27 \%$, and MuSiQue by $7 \%$.


The purpose of abstraction is not to be vague, but to create a new semantic level in which one can be absolutely precise. - Edsger W. Dijkstra

## 1 INTRODUCTION

The field of natural language processing (NLP) is witnessing a ground-breaking revolution because of the Transformer-based (Vaswani et al., 2017) large language models (LLMs) (Devlin et al. 2018, Raffel et al., 2020; Brown et al., 2020, Anil et al., 2023). Scaling up the model size and pre-training corpus (Hoffmann et al.| 2022; Chowdhery et al. | 2022) has brought remarkable improvement in model capabilities and sample efficiency with insights from the scaling law (Kaplan et al., 2020, Hoffmann et al. 2022), as well as emergent abilities (Wei et al. 2022a) such as multi-step reasoning (Wei et al., 2022b; Zhou et al., 2022) and instruction following (Mishra et al., 2022b; Wei et al., 2021).

![](https://cdn.mathpix.com/cropped/2024_06_04_72336a81bccecc836a79g-01.jpg?height=486&width=1353&top_left_y=1817&top_left_x=386)

Figure 1: Strong Performance of StEP-BACK Prompting: our proposed Abstraction-and-Reasoning scheme leads to a substantial improvement in a wide range of challenging tasks in STEM, Knowledge QA and Multi-Hop Reasoning requiring complex (often multi-hop) reasoning.[^0]

Despite the great advancements, complex multi-step reasoning remains challenging for even the stateof-the-art LLMs. Lightman et al. (2023) show that process-supervision with step-by-step verification is a promising remedy to improve the correctness of intermediate reasoning steps. Techniques such as Chain-of-Thought (Wei et al. 2022b) were introduced to produce a coherent series of intermediate reasoning steps to increase the success rate of following the right decoding path. Inspired by the fact that when faced with challenging tasks humans often step back and do abstractions to arrive at high-level principles to guide the process, we propose StEP-BACK PROMPTING to ground reasoning on abstractions to reduce the chance of making errors in the intermediate reasoning steps.

![](https://cdn.mathpix.com/cropped/2024_06_04_72336a81bccecc836a79g-02.jpg?height=970&width=1391&top_left_y=626&top_left_x=367)

Figure 2: Illustration of StEP-BACK Prompting with two steps of Abstraction and Reasoning guided by concepts and principles. Top: an example of MMLU high-school physics (Hendrycks et al. 2020) where the first principle of Ideal Gas Law is retrieved via abstraction. Bottom: an example from TimeQA (Chen et al. 2021) where the high-level concept of education history is a result of the abstraction. Left: PaLM-2L (Anil et al., 2023) fails to answer the original question. Chain-of-Thought prompting (Wei et al. 2022b; Kojima et al., 2022) ran into errors during intermediate reasoning steps (highlighted as red). Right: PaLM-2L (Anil et al., 2023) successfully answers the question via STEP-BACK PROMPTING.

Among many of the cognitive skills, abstraction (Lachmy et al. 2022) is ubiquitous to humans' ability to process vast amounts of information and derive general principles. For example, Kepler compressed thousands of measurements into Kepler's three laws of planetary motion, which precisely describe the orbits of planets around the Sun (Russell, 1964). In critical decision-making, humans find abstraction to be helpful since it provides a broader view of the environment. This work explores how LLMs can tackle complex tasks involving many low-level details through a two-step process of abstraction-and-reasoning. The first step is to show LLMs how to step back through in-context learning - prompting them to derive high-level abstractions such as concepts and principles for a specific example. The second step is to leverage the reasoning ability to reason on top of the high-level concepts and principles. We use few-shot exemplar demonstrations to execute STEP-BACK PROMPTING on LLMs.

We experiment across a range of tasks involving domain specific reasoning such as Physics and Chemistry, knowledge-intensive question answering requiring factual knowledge, multi-hop commonsense reasoning. We observe significant performance improvements (up to 27\%) in PaLM-2L (Anil et al.

2023) demonstrating the efficacy of STEP-BACK PROMPTING in tackling complex tasks, which are otherwise challenging due to the amount of details needed for reasoning. Figure 1 shows a summary of all the key results presented in this paper. Some the tasks are very challenging: both PaLM-2L and GPT-4 achieve only $\sim 40 \%$ accuracy on TimeQA and MuSiQue. Chain-of-Thought prompting leads to a minor improvement on a few tasks, while STEP-BACK PROMPTING improves the performance of PaLM-2L across the board: $7 \%$ and $11 \%$ on MMLU Physics and Chemistry, $27 \%$ on TimeQA, and $7 \%$ on MuSiQue.

We conduct a variety of analyses and find that STEP-BACK PROMPTING leads to strong performance improvements (up to $36 \%$ ) over chain-of-thought (CoT) prompting (Wei et al., 2022b) and "take-adeep-breath" (TDB) prompting (Yang et al., 2023). We perform a qualitative evaluation where we find that Step-Back fixes a large portion of errors of the base model (up to $\sim 40 \%$ ) while introducing a small portion of new errors (max $\sim 12 \%$ ). We also conduct an error analysis and find that majority of the errors made by STEP-BACK PROMPTING is attributed to the intrinsic limitations of reasoning capabilities of LLMs while abstraction skills are relatively easy to demonstrate to LLMs, pointing out the direction for future improvements of methods alike STEP-BACK PROMPTING.

## 2 STEP-BACK PROMPTING

StEP-BACK Prompting is motivated by the observation that many tasks contain a lot of details, and it is hard for LLMs to retrieve relevant facts to tackle the task. As shown in the first example (top) in Figure 2, for a Physics question of "What happens to the pressure, P, of an ideal gas if the temperature is increased by a factor of 2 and the volume is increased by a factor of 8 ?", the LLM can deviate from the first principle of Ideal Gas Law when reasoning directly on the question. Similarly, a question of "Estella Leopold went to which school between Aug 1954 and Nov 1954?" is very hard to address directly given the detailed time range constraint. In both cases, asking a step-back question helps the model to solve the problem effectively.

We define a step-back question as a derived question from the original question at a higher level of abstraction. For instance, instead of directly asking "which school Estella Leopold went to during a specific period", a step-back question (Figure 2 bottom) would ask about the "education history", which is a high-level concept encompasses the original question. Answering the step-back question of "Estella Leopold's education history" in this case will provide all the necessary information to reason about "which school Estella Leopold went to during a specific period". The premise is that the step-back question is typically much easier. Grounding the reasoning on top of such abstractions helps to avoid reasoning errors in the intermediate steps such as the example shown in Figure 2(left) from Chain-of-Thought. In short, STEP-BACK PROMPTING consists two simple steps:

- Abstraction: Instead of addressing the question directly, we first prompt the LLM to ask a generic step-back question about a higher-level concept or principle, and retrieve relevant facts about the high-level concept or principle. The step-back question is unique for each task in order to retrieve the most relevant facts.
- Reasoning: Grounded on the facts regarding the high-level concept or principle, the LLM can reason about the solution to the original question. We term this as Abstraction-grounded Reasoning.

In the following sections, we present an empirical study of STEP-BACK PROMPTING on a range of challenging tasks covering STEM, Knowledge QA, and Multi-Hop Reasoning involving complex reasoning.

## 3 EXPERIMENTAL SETUP

Here we define the tasks and models we experiment with. We also describe our evaluation metric and the baselines we consider.

### 3.1 TASKS

We experiment with the following diverse tasks: (a) STEM, (b) Knowledge QA, and (c) Multi-Hop Reasoning. We describe below the datasets we consider (see Appendix B for more details).

- STEM: We evaluate MMLU and GSM8K for STEM tasks. MMLU (Hendrycks et al. 2020) contains a series of benchmarks across diverse domains to evaluate the model's language understanding. We consider the high school physics and chemistry portions of MMLU because of the deep reasoning involved.
- Knowledge QA: We consider TimeQA (Chen et al., 2021) since it contains complex queries that require challenging time-sensitive knowledge. We also experiment with SituatedQA (Zhang \& Choi, 2021), another challenging open-retrieval QA dataset requiring the model to answer questions given temporal or geographical contexts.
- Multi-Hop Reasoning: We experiment with MuSiQue (Trivedi et al. 2022), a hard multihop reasoning dataset created via composable pairs of single-hop questions, and StrategyQA (Geva et al. 2021) with open-domain questions that demand some strategy to solve.


### 3.2 MODELS

We use the following state-of-the-art LLMs: instruction-tuned PaLM-2L (Anil et al., 2023), GPT4 (OpenAI, 2023), and Llama2-70B (Touvron et al., 2023).

### 3.3 EVALUATION

Conventional evaluation metrics such as accuracy, F1 score have limitations specifically for evaluating the generations of state-of-the-art LLMs since these models often generate long-form answers which are hard to capture. We instead conduct an evaluation using the PaLM-2L model where we few-shot prompt the model to identify equivalence between target answers and the model predictions. Few-shot examples, prompts and other details used for this evaluation are in Appendix C.

### 3.4 BASELINE METHODS

- PaLM-2L, PaLM-2L 1-shot: PaLM-2L is either queried directly with the question or has a single demonstration exemplar of question-answer included in the prompt.
- PaLM-2L + CoT, PaLM-2L + CoT 1-shot: PaLM-2L model is queried with zero-shot CoT prompting (Kojima et al. 2022): "Let's think step by step" is appended to the question. For 1-shot, One demonstration example of a question and answer pair is provided in the prompt, where the answer is in the style of CoT (Wei et al. 2022b).
- PaLM-2L + TDB: Zero-shot prompting with "Take a deep breath and work on this problem step-by-step." Yang et al. 2023) prepended to the question.
- PaLM-2L + RAG: For Sections 5 and 6, we use retrieval-augmented generation (RAG) where the retrieved passage is used as context by the LLM.
- GPT-4 and Llama2-70B: we run GPT-4 and Llama2-70B on MMLU tasks for all methods. In addition, we also run GPT-4 on all baselines for all tasks.

We do not use RAG for STEM tasks, because of the inherent reasoning nature of the tasks contrary to the other fact-seeking datasets. All inferences are done using greedy decoding.

## 4 STEM

We evaluate STEP-BACK PromptiNG on STEM tasks (Hendrycks et al. 2020) to gauge the efficacy of our method on reasoning in highly specialized domains. We explain below our experimental setup, result, and analysis of applying STEP-BACK PRompTING on the MMLU high-school Physics and Chemistry, and GSM8K benchmarks.

### 4.1 StEP-BACK PROMPTING

Questions in the MMLU benchmarks require deeper reasoning. Furthermore, they also require understanding and application of formulae which are often physics and chemistry principles and concepts. In this case, we first demonstrate to the model abstraction skills in the form of concepts and first principles such as Newton's first law of motion, Doppler effect, and Gibbs free energy etc.

Table 1: Strong performance of StEP-BACK Prompting on MMLU tasks across three model families. CoT: zero-shot Chain of Thought prompting (Kojima et al., 2022), TDB: Take a Deep Breath prompting (Yang et al. 2023).

| Method | MMLU Physics | MMLU Chemistry |
| :---: | :---: | :---: |
| PaLM-2L | $66.4 \%(0.8 \%)$ | $70.9 \%(0.9 \%)$ |
| PaLM-2L 1-shot | $64 \%(1.6 \%)$ | $75.6 \%(0.4 \%)$ |
| PaLM-2L + CoT | $65 \%(2 \%)$ | $75.3 \%(1.5 \%)$ |
| PaLM-2L + CoT 1-shot | $61.5 \%(1.8 \%)$ | $76.6 \%(1 \%)$ |
| PaLM-2L + TDB | $65.7 \%(0.7 \%)$ | $73.8 \%(1.1 \%)$ |
| PaLM-2L + Step-Back (ours) | $73.2 \%(1.9 \%)$ | $\mathbf{8 1 . 8} \%(1.4 \%)$ |
| GPT-4 | $69.4 \%(2.0 \%)$ | $80.9 \%(0.7 \%)$ |
| GPT-4 1-shot | $78.4 \%(2.4 \%)$ | $80.5 \%(1.6 \%)$ |
| GPT-4 + CoT | $82.9 \%(0.5 \%)$ | $85.3 \%(1.0 \%)$ |
| GPT-4 + CoT 1-shot | $79.3 \%(1.0 \%)$ | $82.8 \%(0.5 \%)$ |
| GPT-4 + TDB | $74.4 \%(4.0 \%)$ | $81.5 \%(1.3 \%)$ |
| GPT-4 + Step-Back (ours) | $84.5 \%(1.2 \%)$ | $\mathbf{8 5 . 6} \%(1.4 \%)$ |
| Llama2-70B | $51.9 \%(3.6 \%)$ | $55.7 \%(2.1 \%)$ |
| Llama2-70B 1-shot | $57.3 \%(1.6 \%)$ | $58.5 \%(2.5 \%)$ |
| Llama2-70B + CoT | $59.3 \%(2.0 \%)$ | $64.1 \%(1.2 \%)$ |
| Llama2-70B + CoT 1-shot | $59.6 \%(2.0 \%)$ | $\mathbf{6 8 . 1 \%}(1.4 \%)$ |
| Llama2-70B + TDB | $60.4 \%(2.1 \%)$ | $63.6 \%(1.9 \%)$ |
| Llama2-70B + Step-Back (ours) | $\mathbf{6 4 . 8 \%}(1.5 \%)$ | $66.7 \%(1.6 \%)$ |

The implicit step-back question here is "what are the physics or chemistry principles and concepts involved in solving this task?". We provide demonstrations to the model to recite the relevant principles for solving the task from its own knowledge (see Appendix D. 1 for few-shot exemplars).

### 4.2 RESULTS

Table 1 illustrates model performance across various setups across three model families: PaLM-2L, GPT-4, and Llama2-70B. Average accuracy over 5 evaluation runs is reported along with standard deviations (in the parentheses). PaLM-2L baseline performance is $66.4 \%$ and $70.9 \%$ on Physics and Chemistry, respectively. We find that CoT and TDB zero-shot prompting do not significantly increase model performance, which could be due to the inherent difficulty and deep reasoning associated with these tasks. PaLM-2L 1-shot and PaLM-2L + CoT 1 -shot do not improve against the baseline much either, highlighting the challenge of demonstrating the reasoning steps to the model. In contrast, STEP-BACK PROMPTING significantly improves model performance: $+7 \%$ and $+11 \%$

![](https://cdn.mathpix.com/cropped/2024_06_04_72336a81bccecc836a79g-05.jpg?height=394&width=663&top_left_y=1554&top_left_x=1075)

Figure 3: Ablation study of STEP-BACK PROMPTING accuracy using PaLM-2L on MMLU highschool Physics against the number of few shot exemplars: robust performance with respect to a varying number of shots. compared to PaLM-2L. Similarly, with GPT4 and Llama2-70B models, StEP-BACK PROMPTING is very competitive among all the baseline methods we tested, showing that STEP-BACK PrompTING is model-agnostic. We present the results of GSM8K in Appendix A. 1 .

### 4.3 ABLATION AND ANALYSIS

Few-shot Ablation: First, in Figure 3, we observe that StEP-BACK PRompting is robust to the number of few-shot exemplars of (question, principles) pairs used as demonstrations. Adding more

Table 2: Strong performance of StEP-BACK PRompting on Knowledge QA tasks. CoT: Chain of Thought prompting, TDB: Take a Deep Breath prompting, RAG: retrieval-augmented generation. STEP-BACK PROMPTING results in significant performance improvements.

| Method | TimeQA | TQA Easy | TQA Hard | SituatedQA |
| :--- | :---: | :---: | :---: | :---: |
| PaLM-2L | $41.5 \%$ | $42.6 \%$ | $40.4 \%$ | $54.3 \%(0.3 \%)$ |
| PaLM-2L 1-shot | $40.7 \%$ | $41.7 \%$ | $39.1 \%$ | $51.8 \%(0.6 \%)$ |
| PaLM-2L + CoT | $40.8 \%$ | $41.8 \%$ | $39.8 \%$ | $56.4 \%(0.2 \%)$ |
| PaLM-2L + CoT 1-shot | $38.1 \%$ | $39.3 \%$ | $36.8 \%$ | $54 \%(0.8 \%)$ |
| PaLM-2L + TDB | $40.9 \%$ | $42.6 \%$ | $39.1 \%$ | $54 \%(0.5 \%)$ |
| PaLM-2L + RAG | $57.4 \%$ | $67.8 \%$ | $46.8 \%$ | $59.3 \%(0.4 \%)$ |
| PaLM-2L + Step-Back (ours) | $66 \%$ | $70.4 \%$ | $61.6 \%$ | $57.5 \%(0.3 \%)$ |
| PaLM-2L + Step-Back + RAG (ours) | $\mathbf{6 8 . 7 \%}$ | $\mathbf{7 5 . 2 \%}$ | $\mathbf{6 2 . 3 \%}$ | $61 \%(0.4 \%)$ |
| GPT-4 | $45.6 \%$ | $48.9 \%$ | $42.6 \%$ | $\mathbf{6 3 . 2 \% ( 0 . 4 \% )}$ |

demonstration examples beyond a single example does not lead to further improvements. This indicates that the task of retrieving the relevant principles and concepts is relatively easy through in-context learning and a single demonstration suffices. Therefore, we use a single exemplar for few-shot prompting throughout the paper except the ablation studies.

Error Analysis: Comparing the predictions of StEP-BACK Prompting to the baseline PaLM-2L model for MMLU high-school Physics: we find that StEP-BACK Prompting corrects $20.5 \%$ errors from the baseline while introducing $11.9 \%$ errors.

To further understand where the errors come from in StEp-BACK PRompting, we annotate all the wrong predictions of STEP-BACK PromptING in the test set, and categorize them into 5 classes (see Appendix E. 1 for examples in each class):

- Principle Error: The error happens at the step of Abstraction, where the first principles generated by models are wrong or incomplete.
- Factual Error: There is at least one factual error when the model recites its own factual knowledge
- Math Error: There is at least one math error in the intermediate steps when math calculations are involved in deriving the final answer.
- Context Loss: There is at least one error where the model response loses context from the question, and deviates from addressing the original question
- Reasoning Error: We define Reasoning Error as when the model makes at least one error in the intermediate Reasoning steps before arriving at the final answer.

All five types of errors are happening during the Reasoning step except Principle Error which points to the failure of the Abstraction step. As shown in Figure 4 (right), Principle Error comprises only a small fraction of the errors the model makes: more than $90 \%$ of the errors happen at the Reasoning step. Among the four error types during Reasoning, Reasoning Error and Math Error are the major error categories. This corroborates with the finding in the ablation study above that very few exemplars are needed to demonstrate to LLMs the Abstraction skill. Reasoning step is still the bottleneck of how well STEP-BACK PROMPTING can perform tasks such as MMLU requiring complex reasoning. For MMLU Physics specifically, the Reasoning and Math skills are critical for solving the problems successfully: even if the first principles are retrieved correctly, deep reasoning and math are involved to derive a correct final answer through a typical multi-step reasoning process.

![](https://cdn.mathpix.com/cropped/2024_06_04_72336a81bccecc836a79g-06.jpg?height=412&width=677&top_left_y=1819&top_left_x=1079)

Figure 4: Error Analysis of StEP-BACK PROMPTING on MMLU high-school Physics: five classes of errors Step-Back makes with Reasoning being the dominating class.

## 5 KNOwLEDGE QA

We evaluate STEP-BACK PROMPTING on question-answering benchmarks requiring intensive factual knowledge. Knowledge QA has been challenging for LLMs. In this section, we first describe the experimental setup, followed by results and analysis on STEP-BACK PROMPTING.

### 5.1 STEP-BACK PROMPTING

We evaluate StEP-BAck Prompting on TimeQA (Chen et al., 2021) and SituatedQA (Zhang \& Choi, 2021) in the Knowledge QA category. We first show the LLMs how to do Abstraction through in-context demonstrations. The step-back question "What was Estella Leopold's education history" in Figure 2 is generated by the LLM through few-shot demonstrations (see Appendix D. 2 for details). Given the knowledge-intensive nature of these queries, we use retrieval augmentation (RAG) in combination with STEP-BACK PRompTING. The step-back question is used to retrieve relevant facts, which work as additional context (see Table 14 for the prompt) to ground the final reasoning step.

### 5.2 RESULTS

We evaluate the models on the test set of TimeQA. As shown in Table 2, the baseline models of GPT-4 and PaLM-2L achieved $45.6 \%$ and $41.5 \%$, highlighting the difficulty of the task. Applying either CoT or TDB zero-shot (and one-shot) prompting to the baseline model shows no improvement. In contrast, augmenting the baseline model by regular retrieval augmentation (RAG) improves the accuracy to $57.4 \%$, highlighting the fact-intensive nature of the task. The result of Step-Back + RAG shows the effectiveness of going back to a high-level concept, which enables much more reliable retrieval augmentation: the accuracy on TimeQA achieves a remarkable $68.7 \%$.

Next, we segment TimeQA into the Easy and Hard difficulty levels provided in the original dataset. As expected, all methods perform worse on the Hard subset. While RAG can improve the Easy accuracy from $42.6 \%$ to $67.8 \%$, the improvement is much smaller on the Hard accuracy: $40.4 \%$ to $46.8 \%$. This is where StEP-BACK PROMPTING shines by retrieving facts regarding high-level concepts to ground the final reasoning: Step-Back + RAG further improves the Hard accuracy to $62.3 \%$, outperforming GPT-4's $42.6 \%$ from GPT-4. We hypothesize that facts regarding the high-level concepts (such as education history) are much more accessible than the low-level details.

On the SituatedQA benchmark, we observe a moderate quality gain from $54.3 \%$ to our best method of Step-Back + RAG ( $61 \%$ ) with a small gap to GPT-4's $63.2 \%$. Similar to TimeQA, prompting techniques such as CoT and TDB don't help significantly for SituatedQA.
![](https://cdn.mathpix.com/cropped/2024_06_04_72336a81bccecc836a79g-07.jpg?height=368&width=1264&top_left_y=1746&top_left_x=430)

Figure 5: Ablation and error analysis of StEP-BAck Prompting on TimeQA. Left: ablation against the number of few-shot exemplars. Right: four classes of errors Step-Back makes with Reasoning and RAG being the dominant error sources.

### 5.3 ABLATION AND ANALYSIS

Few-shot Ablation: We observe in Figure 5 (left) that the performance of StEP-BAck Prompting on TimeQA is robust to the number of exemplars used in demonstration, highlighting again the sample efficiency of in-context learning Abstraction skills for models like PaLM-2L.

Table 3: Results of StEP-Back Prompting on Multi-Hop Reasoning. CoT: Chain of Thought prompting, TDB: Take a Deep Breath prompting, RAG: retrieval augmentation generation. The average accuracy is over 5 evaluation runs with the standard deviations included in the parentheses.

| Method | MuSiQue | StrategyQA |
| :--- | :---: | :---: |
| PaLM-2L | $35.5 \%(3 \%)$ | $82.8 \%(0.7 \%)$ |
| PaLM-2L 1-shot | $29.0 \%(0.5 \%)$ | $76.6 \%(0.5 \%)$ |
| PaLM-2L + CoT | $38.7 \%(3.2 \%)$ | $83.6 \%(0.4 \%)$ |
| PaLM-2L + CoT 1-shot | $38.5 \%(2.2 \%)$ | $76.8 \%(1.4 \%)$ |
| PaLM-2L + TDB | $39.0 \%(2.3 \%)$ | $82.7 \%(0.9 \%)$ |
| PaLM-2L + RAG | $39.6 \%(2.8 \%)$ | $84.2 \%(0.5 \%)$ |
| PaLM-2L + Step-Back (ours) | $42.6 \%(3.1 \%)$ | $82.7 \%(0.4 \%)$ |
| PaLM-2L + Step-Back + RAG (ours) | $\mathbf{4 2 . 8} \%(2.0 \%)$ | $\mathbf{8 6 . 4 \% ( 1 \% )}$ |
| GPT-4 | $38.5 \%(0.2 \%)$ | $78.3 \%(1.1 \%)$ |

Error Analysis: Figure 5 (right) shows the breakdown of all the remaining errors made by STEPBack Prompting on TimeQA. Similar to Section 4.3, we categorize the errors into

- StepBack: The step-back question generated is not helpful in solving the task.
- RAG: RAG fails to retrieve relevant information despite that the step-back question is on target.
- Scoring Error: The evaluation by the judge model made a mistake.
- Reasoning Error: The retrieved context is relevant, but the model still fails to reason through the context to arrive at the right answer.

We find that the StepBack rarely fails. In contrast, we find more than half of the errors are due to reasoning errors. Additionally, $45 \%$ of errors are due to failure in retrieving the right information despite that Abstraction provided by step-back makes it a much easier task. This reflects the difficulty level of the TimeQA task. Additional error analysis of TimeQA is in Appendix A.

## 6 MULTI-HOP REASONING

We evaluate STEP-BAcK Prompting on challenging Multi-Hop reasoning benchmark MuSiQue (Trivedi et al. 2022) and StrategyQA (Geva et al. 2021). We follow the same protocol as Section 5 to implement STEP-BACK PROMPTING.

Table 3 shows performance of various baselines on the dev set of MuSiQue and StrategyQA. Baseline performance of PaLM-2L and GPT-4 are low ( $35.5 \%$ and $38.5 \%$ for PaLM-2L and GPT-4 respectively) in MuSiQue since it is a hard multihop reasoning benchmark. In contrast, StrategyQA has stronger baselines ( $82.8 \%$ and $78.3 \%$ for PaLM-2L and GPT-4 respectively) probably because it is a binary classification task. CoT and TDB improve model performance a bit in the case of MuSiQue ( $\sim 3 \%$ and $3.5 \%$ respectively) which can be attributed to the inherent reasoning nature of this task where these methods are shown to be helpful. In the case of StrategyQA, there is no significant performance gain with CoT and TDB which could be due to the high baseline performance in this task, with limited scope for these prompting methods to improve performance. Often, 1 -shot performance is significantly lower than their zero-shot methods, which could be attributed to potential example bias (Zhao et al., 2021, Parmar et al., 2023). RAG improves model performance ( $\sim 4 \%$ and $2 \%$ for MuSiQue and StrategyQA respectively.) StEP-BACK PRompting with the power of abstraction produces the best performance of all methods: $42.8 \%$ in MuSiQue and $86.4 \%$ in StrategyQA, significantly outperforming GPT-4 on both tasks. We present a detailed error analysis on StrategyQA in Appendix A. 3 .

## 7 DISCUSSION

Abstraction helps humans to solve complex tasks by removing irrelevant details and distilling highlevel concepts and principles to guide the problem-solving process. StEP-BACK Prompting breaks
complex tasks such as knowledge-intensive QA, multi-hop reasoning, and science questions into two separate steps of Abstraction and Reasoning. We demonstrate through empirical experiments that Abstraction is an easy skill for the LLMs such as PaLM-2L via sample-efficient in-context learning. Grounding on the high-level concepts and principles, LLMs can leverage their intrinsic Reasoning capabilities to derive the solution. This reduces the chance of reasoning failures in the intermediate steps and is shown to improve the performance on a wide range of complex reasoning tasks. Despite the success, through error analysis, we find that Reasoning is still one of the hardest skills for LLMs to acquire: it is still the dominant failure mode even after the large reduction of task complexity by STEP-BACK PROMPTING.

Nevertheless, Abstraction is neither necessary nor possible in all scenarios. For instance, the task can be as simple as who was the president of the United States in 2000?, in which case there is no such need to step back and ask a high-level question as the answer to such questions is readily available. Questions such as what is the speed of light? point to the first principles themselves. Doing Abstraction in this case would not make a difference either.

## 8 RELATED WORK

### 8.1 PROMPTING

Few-shot prompting (Brown et al., 2020; Liu et al., 2023; Mishra et al., 2022a; Wei et al., 2022b) has significantly improved model performance across a range of tasks without requiring updating any model parameters. Our work STEP-BACK PrompTING is in the same category as the chain-ofthought prompting (Wei et al. 2022b) and scratchpad (Nye et al., 2021) owing to its simplicity and generic nature. But our approach is focused on the key idea of abstraction which is inspired from the fact that taking a step back often helps humans in performing complex tasks. Our work is also related to the recitation-augmented language models (Sun et al. 2022); however in contrast to their work, we explicitly perform step-back and abstraction, with optional use of retrieval augmentation depending on the nature of the task at hand.

### 8.2 DECOMPOSITION

Decomposing a task into simpler tasks and solving these tasks to complete the original task has been an effective way (Zhou et al., 2022; Patel et al., 2022; Khot et al., 2022; Press et al. 2022) to improve model performance on complex tasks. Several prompting methods have been successful in this regard. Our work STEP-BACK PROMPTING, in contrast, is on making the question more abstract and high-level, which is different from decomposition that is often a low-level breakdowns of the original question. For instance, a generic question for which employer did Steve Jobs work for in 1990? could be what is the employment history of Steve Jobs? While decomposition would lead to sub-questions such as What was Steve Jobs doing in 1990?, Was Steve Jobs employed in 1990? and If Steve Jobs was employed, who was his employer? Furthermore, abstract questions such as what is the employment history of Steve Jobs? are often generic in nature to have a many-to-one mapping since many questions (e.g. which employer did Steve Jobs work for in 1990? and which employer did Steve Jobs work for in 2000?) can have the same abstract question. This is in contrast to decomposition where there is often a one-to-many mapping since there are multiple decomposed sub-problems necessary to solve a given question.

## 9 CONCLUSION

We introduce StEP-BACK PROMPTING as a simple yet generic method to elicit deep reasoning via abstraction in large language models. Experimentation on LLMs across fact-seeking, commonsense reasoning and domain-specific reasoning benchmarks shows that STEP-BACK PROMPTING significantly improves model performance. We hypothesize that abstraction helps models to hallucinate less and reason better, probably reflecting the true nature of the model which are often hidden while responding to the original question without abstraction. We hope our work will inspire more human-inspired approaches to elicit the hidden potential of large language models.

## ACKNOWLEDGEMENT

We thank Andrew Dai, Adams Yu and Hannah Rashkin of Google DeepMind for their insightful feedback on this paper.

## REFERENCES

Rohan Anil, Andrew M Dai, Orhan Firat, Melvin Johnson, Dmitry Lepikhin, Alexandre Passos, Siamak Shakeri, Emanuel Taropa, Paige Bailey, Zhifeng Chen, et al. Palm 2 technical report. arXiv preprint arXiv:2305.10403, 2023.

Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared D Kaplan, Prafulla Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell, et al. Language models are few-shot learners. Advances in neural information processing systems, 33:1877-1901, 2020.

Wenhu Chen, Xinyi Wang, and William Yang Wang. A dataset for answering time-sensitive questions. arXiv preprint arXiv:2108.06314, 2021.

Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra, Adam Roberts, Paul Barham, Hyung Won Chung, Charles Sutton, Sebastian Gehrmann, et al. Palm: Scaling language modeling with pathways. arXiv preprint arXiv:2204.02311, 2022.

Jacob Devlin, Ming-Wei Chang, Kenton Lee, and Kristina Toutanova. Bert: Pre-training of deep bidirectional transformers for language understanding. arXiv preprint arXiv:1810.04805, 2018.

Mor Geva, Daniel Khashabi, Elad Segal, Tushar Khot, Dan Roth, and Jonathan Berant. Did aristotle use a laptop? a question answering benchmark with implicit reasoning strategies. Transactions of the Association for Computational Linguistics, 9:346-361, 2021.

Dan Hendrycks, Collin Burns, Steven Basart, Andy Zou, Mantas Mazeika, Dawn Song, and Jacob Steinhardt. Measuring massive multitask language understanding. arXiv preprint arXiv:2009.03300, 2020.

Jordan Hoffmann, Sebastian Borgeaud, Arthur Mensch, Elena Buchatskaya, Trevor Cai, Eliza Rutherford, Diego de Las Casas, Lisa Anne Hendricks, Johannes Welbl, Aidan Clark, et al. Training compute-optimal large language models. arXiv preprint arXiv:2203.15556, 2022.

Jared Kaplan, Sam McCandlish, Tom Henighan, Tom B Brown, Benjamin Chess, Rewon Child, Scott Gray, Alec Radford, Jeffrey Wu, and Dario Amodei. Scaling laws for neural language models. arXiv preprint arXiv:2001.08361, 2020.

Tushar Khot, Harsh Trivedi, Matthew Finlayson, Yao Fu, Kyle Richardson, Peter Clark, and Ashish Sabharwal. Decomposed prompting: A modular approach for solving complex tasks. arXiv preprint arXiv:2210.02406, 2022.

Takeshi Kojima, Shixiang Shane Gu, Machel Reid, Yutaka Matsuo, and Yusuke Iwasawa. Large language models are zero-shot reasoners. Advances in neural information processing systems, 35: 22199-22213, 2022.

Royi Lachmy, Valentina Pyatkin, Avshalom Manevich, and Reut Tsarfaty. Draw me a flower: Processing and grounding abstraction in natural language. Transactions of the Association for Computational Linguistics, 2022.

Hunter Lightman, Vineet Kosaraju, Yura Burda, Harri Edwards, Bowen Baker, Teddy Lee, Jan Leike, John Schulman, Ilya Sutskever, and Karl Cobbe. Let's verify step by step. arXiv preprint arXiv:2305.20050, 2023.

Pengfei Liu, Weizhe Yuan, Jinlan Fu, Zhengbao Jiang, Hiroaki Hayashi, and Graham Neubig. Pre-train, prompt, and predict: A systematic survey of prompting methods in natural language processing. ACM Computing Surveys, 55(9):1-35, 2023.

Swaroop Mishra, Daniel Khashabi, Chitta Baral, Yejin Choi, and Hannaneh Hajishirzi. Reframing instructional prompts to gptk's language. In Findings of the Association for Computational Linguistics: ACL 2022, pp. 589-612, 2022a.

Swaroop Mishra, Daniel Khashabi, Chitta Baral, and Hannaneh Hajishirzi. Cross-task generalization via natural language crowdsourcing instructions. In Proceedings of the 60th Annual Meeting of the Association for Computational Linguistics (Volume 1: Long Papers), pp. 3470-3487, 2022b.

Maxwell Nye, Anders Johan Andreassen, Guy Gur-Ari, Henryk Michalewski, Jacob Austin, David Bieber, David Dohan, Aitor Lewkowycz, Maarten Bosma, David Luan, et al. Show your work: Scratchpads for intermediate computation with language models. arXiv preprint arXiv:2112.00114, 2021.

OpenAI. Gpt-4 technical report. arXiv preprint arXiv:2303.08774, 2023.

Mihir Parmar, Swaroop Mishra, Mor Geva, and Chitta Baral. Don't blame the annotator: Bias already starts in the annotation instructions. In Proceedings of the 17th Conference of the European Chapter of the Association for Computational Linguistics, pp. 1771-1781, 2023.

Pruthvi Patel, Swaroop Mishra, Mihir Parmar, and Chitta Baral. Is a question decomposition unit all we need? In Proceedings of the 2022 Conference on Empirical Methods in Natural Language Processing, pp. 4553-4569, 2022.

Ofir Press, Muru Zhang, Sewon Min, Ludwig Schmidt, Noah A Smith, and Mike Lewis. Measuring and narrowing the compositionality gap in language models. arXiv preprint arXiv:2210.03350, 2022.

Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J Liu. Exploring the limits of transfer learning with a unified text-to-text transformer. The Journal of Machine Learning Research, 21(1):5485-5551, 2020.

John L Russell. Kepler's laws of planetary motion: 1609-1666. The British journal for the history of science, 2(1):1-24, 1964.

Zhiqing Sun, Xuezhi Wang, Yi Tay, Yiming Yang, and Denny Zhou. Recitation-augmented language models. arXiv preprint arXiv:2210.01296, 2022.

Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, Dan Bikel, Lukas Blecher, Cristian Canton Ferrer, Moya Chen, Guillem Cucurull, David Esiobu, Jude Fernandes, Jeremy Fu, Wenyin Fu, Brian Fuller, Cynthia Gao, Vedanuj Goswami, Naman Goyal, Anthony Hartshorn, Saghar Hosseini, Rui Hou, Hakan Inan, Marcin Kardas, Viktor Kerkez, Madian Khabsa, Isabel Kloumann, Artem Korenev, Punit Singh Koura, Marie-Anne Lachaux, Thibaut Lavril, Jenya Lee, Diana Liskovich, Yinghai Lu, Yuning Mao, Xavier Martinet, Todor Mihaylov, Pushkar Mishra, Igor Molybog, Yixin Nie, Andrew Poulton, Jeremy Reizenstein, Rashi Rungta, Kalyan Saladi, Alan Schelten, Ruan Silva, Eric Michael Smith, Ranjan Subramanian, Xiaoqing Ellen Tan, Binh Tang, Ross Taylor, Adina Williams, Jian Xiang Kuan, Puxin Xu, Zheng Yan, Iliyan Zarov, Yuchen Zhang, Angela Fan, Melanie Kambadur, Sharan Narang, Aurelien Rodriguez, Robert Stojnic, Sergey Edunov, and Thomas Scialom. Llama 2: Open foundation and fine-tuned chat models, 2023.

Harsh Trivedi, Niranjan Balasubramanian, Tushar Khot, and Ashish Sabharwal. Musique: Multihop questions via single-hop question composition. Transactions of the Association for Computational Linguistics, 10:539-554, 2022.

Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin. Attention is all you need. Advances in neural information processing systems, 30, 2017.

Jason Wei, Maarten Bosma, Vincent Y Zhao, Kelvin Guu, Adams Wei Yu, Brian Lester, Nan Du, Andrew M Dai, and Quoc V Le. Finetuned language models are zero-shot learners. arXiv preprint arXiv:2109.01652, 2021.

Jason Wei, Yi Tay, Rishi Bommasani, Colin Raffel, Barret Zoph, Sebastian Borgeaud, Dani Yogatama, Maarten Bosma, Denny Zhou, Donald Metzler, et al. Emergent abilities of large language models. arXiv preprint arXiv:2206.07682, 2022a.

Jason Wei, Xuezhi Wang, Dale Schuurmans, Maarten Bosma, Fei Xia, Ed Chi, Quoc V Le, Denny Zhou, et al. Chain-of-thought prompting elicits reasoning in large language models. Advances in Neural Information Processing Systems, 35:24824-24837, 2022b.

Chengrun Yang, Xuezhi Wang, Yifeng Lu, Hanxiao Liu, Quoc V. Le, Denny Zhou, and Xinyun Chen. Large language models as optimizers. arXiv preprint arXiv:2309.03409, 2023.

Michael Zhang and Eunsol Choi. Situatedqa: Incorporating extra-linguistic contexts into qa. In Proceedings of the 2021 Conference on Empirical Methods in Natural Language Processing, pp. $7371-7387,2021$.

Zihao Zhao, Eric Wallace, Shi Feng, Dan Klein, and Sameer Singh. Calibrate before use: Improving few-shot performance of language models. In International Conference on Machine Learning, pp. 12697-12706. PMLR, 2021.

Denny Zhou, Nathanael Schärli, Le Hou, Jason Wei, Nathan Scales, Xuezhi Wang, Dale Schuurmans, Claire Cui, Olivier Bousquet, Quoc Le, et al. Least-to-most prompting enables complex reasoning in large language models. arXiv preprint arXiv:2205.10625, 2022.

Table 4: Step-Back Prompting on GSM8K. CoT: zero-shot Chain of Thought prompting (Kojima et al., 2022), TDB: Take a Deep Breath prompting (Yang et al., 2023), DP: Decomposed Prompting (Khot et al. 2022). The Table reports the average accuracy over 5 evaluation runs, with standard deviations in the parentheses.

| Method | GSM8K |
| :--- | :---: |
| PaLM-2L | $75.8 \%(0.2 \%)$ |
| PaLM-2L 1-shot | $\mathbf{8 4 . 5 \% ( 0 . 4 \% )}$ |
| PaLM-2L + CoT | $\mathbf{8 4 . 4 \% ( 0 . 2 \% )}$ |
| PaLM-2L + CoT 1-shot | $81 \%(0.2 \%)$ |
| PaLM-2L + TDB | $82.2 \%(0.2 \%)$ |
| PaLM-2L + DP | $82.2 \%(0.08 \%)$ |
| PaLM-2L + Step-Back (ours) | $\mathbf{8 4 . 3 \% ( 0 . 2 \% )}$ |
