# Complex-valued 3D atomic spectroscopy with Gaussian-assisted inline holography 

Xing Huang ${ }^{1,}{ }^{1}$ Yuzhuo Wang ${ }^{1,2},{ }^{1}$ Jian Zhao ${ }^{1,}{ }^{1}$ and Saijun Wu ${ }^{11}$<br>${ }^{11}$ Department of Physics, State Key Laboratory of Surface Physics and Key Laboratory of Micro<br>and Nano Photonic Structures (Ministry of Education), Fudan University, Shanghai 200433, China.<br>${ }^{2}$ State Key Laboratory of Quantum Optics and Quantum Optics Devices,<br>Institute of Laser Spectroscopy, Shanxi University, Taiyuan 030006, China.


#### Abstract

When a laser-cooled atomic sample is optically excited, the envelope of coherent forward scattering can often be decomposed into a few complex Gaussian profiles. The convenience of Gaussian propagation helps addressing key challenges in digital holography. In this work, we theoretically develop and experimentally demonstrate a Gaussian-decomposition-assisted approach to inline holography, for single-shot, simultaneous measurements of absorption and phase shift of small atomic samples sparsely distributed in 3D. Experimentally, we image a sparse lattice of ${ }^{87} \mathrm{Rb}$ samples on the D2 line, to resolve their axial positions with micrometer precision, and to retrieve their complex-valued spectroscopic images. With the phase-angle readouts that are highly insensitive to atom-number and interaction-strength uncertainties, we achieve hundred-kHz-level single-shot-resolution to the transition frequency with merely hundreds of atoms. We further demonstrate 3D sensing of local light shift with micrometer spatial resolution.


## I. INTRODUCTION

Atoms are ideal quantum sensors. By measuring the optical response of free atoms, the centers and linewidths of atomic levels can be accurately inferred for unveiling unknown interactions and to calibrate external potentials [1-4]. The optical transition properties are affected by the center-of-mass motion. The laser-cooling techniques, which are able to effectively freeze the atomic motion, was expected to greatly enhance the precision of atomic spectroscopy [5]. Nowadays, however, while laser cooling and trapping are often essential in spectroscopic measurements on narrow transitions [6-10], precision spectroscopy on strong transitions tends to rely more on traditional sources such as saturated vapors [11] and atomic beams [12]. Compared to the thermal sources, the fluxes from cold-atom sources are moderate and easily fluctuate. Furthermore, during a prolonged probe period, the light-atom interaction strength, characterized by the atomic polarizability $\alpha$, can be modified by optical pumping even at extremely low light levels [13]. Efficient suppression of the systematic errors associated with such fluctuations are important for atomic precision spectroscopy to fully benefit from the long-time Dopplerfree interaction offered by laser cooling, and to enable novel applications of ultra-cold atoms such as for wideband quantum sensing of $3 \mathrm{D}$ potentials [14-16].

The impacts of atom number and interaction-strength fluctuations can be substantially suppressed in atomic spectroscopy, if one is able to extend the spectroscopic data from real to complex numbers. In particular, for a dilute atomic sample subjected to a near-resonant probe [17], both the optical depth OD and phase shift $\phi$ are proportional to the atom number $N$ and the modulus of the atomic polarizability $|\alpha|$. But the phase angle $\beta=\arg (\phi+i \mathrm{OD} / 2)$ is largely decided by the atomic phase angle, $\arg (\alpha)$, highly insensitive to the $N|\alpha|$ fluctuations $[18,19]$. Unfortunately, it is not possible to simultaneously measure OD and $\phi$ distributions without precisely knowing the complex $E_{r}^{\prime}$ and $E_{r}$, the transmitted probe wavefronts in presence and absence of the atomic sample respectively. In standard transmission imaging techniques where the light intensities are recorded only $[17,20]$, the optical phase information are completely lost. While single-mode coherent transmission spectroscopy [21-24] is able to retrieve the $E_{r}$-modeaveraged OD and $\phi$, the single-mode readouts cannot support spatial resolution in general. Furthermore, since details of atomic distribution are disregarded, it becomes difficult to correct for any density-dependent shifts in the collective responses [25-27].

In this work, we develop a systematic procedure for complex-valued spectroscopic imaging of laser-cooled atoms. The technique is based on inline holography [18, 19, 28-30]. To fix the optical phase ambiguity [31] by exploiting the prior knowledge about the atoms in a numerically efficient manner, we introduce a Gaussian-decomposition [32-34] method to digital holographic microscopy. For arrays of samples with known phase angle $\beta$, our method is able to retrieve the transmitted $E_{r}^{\prime}$ (and $E_{r}$ ) from single-shot hologram data while spectroscopically locating the centers of each sample in $3 \mathrm{D}$ with a super-resolution close to the photon-shotnoise limit (Cramer-Rao bound [35]). The absorption OD and phase-shift $\phi$ images can be numerically reconstructed to form the complex $\varphi_{A}=\phi+i \mathrm{OD} / 2$ images, with diffraction-limited spatial resolution and photonshot-noise limited sensitivity. Experimentally, we simultaneously reconstruct complex-valued spectroscopic images of sparsely distributed ${ }^{87} \mathrm{Rb}$ samples on the $\mathrm{D} 2$ line, from single-shot holograms which are recorded within tens of microseconds. By retrieving the phase angles, we demonstrate $100 \mathrm{kHz}$-level resolution to the transition frequency and its shift using merely hundreds of atoms, with micrometer-level 3D spatial resolution, in presence of substantial shot-to-shot atom-number uncertainties.

In what follows, we first review the basic principles of the quantitative holographic imaging [36-38] for atomic

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-02.jpg?height=607&width=876&top_left_y=171&top_left_x=169)

FIG. 1. Complex spectroscopic imaging with Gaussiandecomposition-assisted inline holography. (a): The basic setup. (b): Pre-characterization of the reference field $E_{r}=$ $\sqrt{I_{r}} e^{i \phi_{r}}$ through multi-plane intensity $I_{r}=\left|E_{r}\right|^{2}$ measurements [18]. The low-spatial-frequency part of the forward scattering $E_{s}=E_{r}^{\prime}-E_{r}$ is decomposed into multiple Gaussian profiles according to Eq. (7). The Gaussian propagation supports efficient minimization of $\mathcal{L}_{H}$ associated with the $\delta I=I^{\prime}-I$ data in the camera plane $z=z_{H}$, and $\mathcal{L}_{A}$ associated with the sample knowledge around $z=z_{A}$, according to Eq. (10). (c): The full $E_{s}$, approximated by $\tilde{E}_{s}$ in Eq. (13), is propagated together with $E_{r}$ to $z=z_{A}$ to retrieve the complex phase shift $\varphi\left(z_{A}\right)$ as the complex-valued imaging data. The scale bars are according to typical experimental condition in this work. The (colored ) black symbols refer to quantities that are (not) precisely known at the represented stages of measurements.

spectroscopy [18]. We then introduce our new method where Gaussian decomposition [32-34] is applied into holography, to facilitate the phase retrieval and 3D localization of atomic samples.

## A. Complex-valued imaging with inline holography

We consider the inline holography setup [29, 31] illustrated in Fig. 1a where a nearly spherical atomic sample at $z=z_{A}$, with a characteristic width $\sigma$, is resonantly excited by a spherical probe beam $E_{r}$ with optical frequency $\omega$, wavelength $\lambda$ and wavenumber $k_{0}=2 \pi / \lambda$. The attenuation and phase shift to $E_{r}$ is encode in $E_{s}$, the coherent forward scattering from the sample. We therefore rewrite $E_{r}^{\prime}=E_{r}+E_{s}$. Defining [39]

$$
\begin{equation*}
\varphi(z)=-i \log \left(1+E_{s}(z) / E_{r}(z)\right) \tag{1}
\end{equation*}
$$

then, according to Beer-Lambert law, we have the complex phase shift by the sample [18]

$$
\begin{align*}
\varphi_{A}(x, y) & =\varphi\left(x, y, z_{A}\right) \\
& =\phi(x, y)+i \operatorname{OD}(x, y) / 2  \tag{2}\\
& \approx \frac{1}{2} k_{0} \rho_{c}(x, y) \alpha(\omega)
\end{align*}
$$

Here $\rho_{c}=\int \rho(z) \mathrm{d} z$ is the column density. The $\alpha(\omega)$ is the atomic polarizability. The third line in Eq. (2) becomes accurate for small ensemble of dilute atoms with $k_{0}^{3} \rho \ll 1$.

The transmitted $E_{r}, E_{r}^{\prime}$ propagate further for a distance $z_{H}-z_{A}$ where the intensity is recorded by a digital camera. The intensities in presence and absence of the atomic sample are modeled as

$$
\begin{align*}
I^{\prime} & =\left|E_{r}\left(z_{H}\right)+E_{s}\left(z_{H}\right)\right|^{2} \\
I & =\left|E_{r}\left(z_{H}\right)\right|^{2} \tag{3}
\end{align*}
$$

respectively. The reduced hologram is defined as

$$
\begin{equation*}
\delta I=I^{\prime}-I \tag{4}
\end{equation*}
$$

Assuming the probe profile $E_{r}$ as known, the goal of holographic imaging is to infer through the $I^{\prime}, I$ measurements the axial central location $z_{A}$ and to retrieve the 2D complex phase shift image $\varphi_{A}(x, y)$ (Eq. (2)) there.

## B. Challenges

The quantitative holographic imaging technique [3638] faces at least three categories of challenges, which are all amplified in cold atom setups [18, 19, 30, 40-43]:

C1: To retrieve $E_{s}$ from the $I^{\prime}, I$ data with Eq. (3) is an ill-defined problem, requiring additional constraints to fix the $E_{s}$ solution not to be perturbed by its twin [31],

$$
\begin{equation*}
E_{s, \text { twin }}=\frac{E_{r}}{E_{r}^{*}} E_{s}^{*} \tag{5}
\end{equation*}
$$

at $z=z_{H}$, which focuses approximately at

$$
\begin{equation*}
z_{\mathrm{twin}}=\frac{z_{A} z_{H}}{2 z_{A}-z_{H}} \tag{6}
\end{equation*}
$$

Due to the fragile nature of cold atomic samples and typical complexity of the setup that produce them, traditional solutions to the twin-image problem associated with phase-shifting [44] and multiple phase-diversity measurements [45-47] can not be easily implemented. While off-axes holography $[40,42,48]$ is powerful for resolving the optical phase, the technique necessarily sacrifices some of the imaging bandwidth while adding more complexity to the setup. Finally, while structured illumination [49] may help solving the phase problem, the associated $E_{r}$ structure could complicate the light-atom interaction through Doppler shifts and transition saturation [13].

Without resorting to additional measurements, the constraints available for cold atom holography typically only include those associated with finite spatial support $[18,30,40,42]$ and optical response characteristics [41, 43]. Previous applications of these prior knowledge, while leading to notable successes, may still not guarantee an accuracy for precision spectroscopy in presence of imaging noises.

C2: The sample plane location $z_{A}$ is not known a prior for the numerical back-propagation of the reconstructed $E_{r}, E_{s}[19,42]$. Retrieving OD and $\phi$ with the Eqs. (1)(2) relation in an out-of-focus plane mixes the absorption with phase shift $[50,51]$, leading to erroneous phase angle $\beta$.

Cold atoms in a dilute enough gas typically follow a normal density distribution. The lack of distinct spatial features invalidates a class of traditional methods for sample-plane localization in digital holography [52-56]. While the sample plane can be precisely located by observing the atomic shot noise [43], the method is slow since many images are required for the statistical analysis.

C3: While the $E_{r}$ wavefront is assumed known, any deviation of the actual $E_{r}$ induces distortion to the retrieved $E_{s}$, leading to erroneous $\varphi_{A}$. In particular, the speckle noises [57] in $E_{r}$ can hardly be avoided in atomic spectroscopy where the laser probe is necessarily monochromatic $[18,30]$.

## C. This work

We develop a method for complex-valued spectroscopic imaging of sparsely distributed atomic samples in 3D. As outlined in Fig. 1, the method is based on inline holography [28]. The phase ambiguity associated with the twin image (Eq. (5)) is addressed by systematically exploiting our prior knowledge about the measurement. Apart from the hologram data (Eq. (3)), the pre-characterized $E_{r}$ wavefront [18], our prior knowledge is mostly about the bulk optical properties of the samples in focus, i.e., aspects of the complex phase shift profile $\varphi_{A}(x, y)$ at $z=z_{A}$. The key insight is that when the probe beam $E_{r}$ seen by the sample is locally smooth, then these properties can be efficiently parametrized by decomposing $E_{s}$ into a few Gaussian beams (see Eq. (B7)) [32-34],

$$
\begin{equation*}
E_{G}\left(\mathbf{r} ;\left\{c_{j}, \mathbf{P}_{j}\right\}\right)=\sum_{j=1}^{n_{A}} c_{j} G_{j}\left(\mathbf{r} ; \mathbf{P}_{j}\right) \tag{7}
\end{equation*}
$$

We denote the optimal decomposition as $\left\langle E_{s}\right\rangle_{G}=$ $E_{G}\left(\mathbf{r} ;\left\{c_{j}, \mathbf{P}_{j}\right\}_{\mathrm{opt}}\right)$. The Gaussian propagation facilitates simultaneous minimization of cost functions, $\mathcal{L}_{H}$ at $z=$ $z_{H}$ (Eq. (11)) associated with the $I^{\prime}, I$-data, and $\mathcal{L}_{A}$ at $z=z_{A}$ (Eq. (12)) associated with the expected $\varphi_{A}$.

Our method works especially well in a "defocused twin regime" (Appendix C 1) for small atomic samples, with $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$, so that there are sufficient interference fringes in the $I^{\prime}$-data (Eq. (4)). Here $z_{\sigma}=\pi \sigma^{2} / \lambda$ is the characteristic Rayleigh length of the sample. Key advantages of our method is summarized as follows:

A1: Our method generalizes traditional single-shot twin-removal strategies such as those associated with finite spatial supports $[30,58,59]$ and spectral phase angles [41, 60]. Here, bulk properties of the samples such as the approximate 3D locations, shapes, and spatial-(in)dependent spectral responses, can all be encoded into the $\varphi_{A}$-imageexpectations to constrain the $\left\{c_{j}, \mathbf{P}_{j}\right\}$ parameters. The enhanced application of prior knowledge improves the accuracy of the optical phase determination in presence of imaging noises.

A2: With the phase angle $\beta=\arg \left(\varphi_{A}\right)$ constrained by knowledge of light-atom interaction [19, 41, 43], the atomic sample plane location $z_{A}$ can be conveniently inferred during Gaussian decomposition. For nearly spherical samples with $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$, the typical axial resolution is [19] (Appendix A)

$$
\begin{equation*}
\Delta z_{A} \approx z_{\sigma} / \sqrt{N_{s}} \tag{8}
\end{equation*}
$$

decided by the Rayleigh length $z_{\sigma}=\pi \sigma^{2} / \lambda$ associated with the sample size $\sigma$ (Fig. 1a). This resolution can be enhanced by introducing finer sample features, or simply by repeating the in situ measurements with standard samples to effectively increase the total number of coherently scattered photons $N_{s}=\sum_{x, y}\left|E_{s}\right|^{2}$ received by the camera.

A3: With $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$, diffraction-limited $E_{r}$ and $E_{s}$ can be retrieved from single-shot $I^{\prime}, I$ data, using the pre-characterized $E_{r}$ knowledge through multi-plane intensity measurements [18]. Impacts of mild speckle noises and moderate aberrations can be corrected, for achieving complex $\varphi_{A}(x, y)$ imaging with diffraction-limited resolution and photonshot-noise limited sensitivity. The phase-angle resolution is given by [18] (Appendix A)

$$
\begin{equation*}
\Delta \beta(\mathcal{A}) \approx 1 / \sqrt{2 N_{s}(\mathcal{A})} \tag{9}
\end{equation*}
$$

Here $N_{s}(\mathcal{A})=\sum_{\mathcal{A}}\left|E_{s}\right|^{2}$ integrates the elastically scattered photons over area $\mathcal{A}$ of interest in the infocus $\varphi_{A}(x, y)$ image.

## 1. Application to atomic spectroscopic imaging

With the inclusion of both phase-angle $\beta$ and modulus $\left|\varphi_{A}\right|$ readouts into the spectroscopy data, the previously mentioned challenges in cold atom spectroscopy-stemming from fluctuations in atom number and interaction strength-become significantly more manageable. When combined with 3D imaging capabilities, our complex spectroscopy technique substantially improves the potential for imaging and sensing on strong optical transitions with laser-cooled atomic arrays.

It is important to note that compared to absorption [17] or phase contrast [20] techniques, holographic imaging incurs a $50 \%$ loss of information [30, 40] (see Appendix A). In the following, we argue that such a loss hardly disadvantages our single-shot complex spectroscopic approach in precision measurements.

To start with, our method avoids measurement noises associated with atom-number and interaction-strength normalization, which, except for special kind of samples with known atom number and fixed interaction strength [61], is typically required in precision spectroscopy [62]. To see the potential of holographic complex imaging at the fundamental level, we compare a special case of resonant absorption and holographic imaging, i.e., with the probe beam frequency $\omega$ tuned close to the transition frequency $\omega_{e g}$ so that the sample is absorptive. It is easy to show that compared to a double-shot absorption measurement, including one for atom-number and interaction-strength normalization (assuming as being performed perfectly), the holographic signals from two independent measurements support just the same, photon-shot-noise-limited absorption sensitivity.

Furthermore, the holographic measurement obtains the absorption and phase-shift image at the same time. The complex-valued spectroscopy is $\Delta$-sensitive at any detuning $\Delta=\omega-\omega_{e g}$. Near resonance, the absorption or fluorescence profiles are peaked and therefore lose the detuning-sensitivity to the first order. In contrast, on-resonance our complex spectroscopy achieves the best sensitivity, capable of resolving $\omega_{e g}$ within single shot through the phase-angle $\beta$ measurement. In the limit of low density [25] and/or high probe intensity [63], the phase angle $\beta$ is purely decided by the single-atom response [19], ideal for precision spectroscopy. Furthermore, with diffraction and shot-noise limited OD, $\phi$ image data, minimal modeling of atomic distributions supports correction to density-dependent shifts [25].

Finally, it is worth noting that phase-angle spectroscopy can be substantially more robust against power broadening and optical pumping effects (Sec. IID) [19] than those in regular spectroscopy. This, combined with the fact that the complex-valued spectroscopy does not require the sample to be nearly intact for the normalization later, suggesting that more efficient precision measurements are possible without requiring extremely low light-level operations $[13,62]$.

## 2. Major limitations in this work

Practically, our holographic imaging method [18] can be conveniently adapted to standard imaging setups, simply by translating the camera away from the atomic imaging plane for recording the inline interference patterns (Fig. 1a). Numerically, a key step is based on matching $E_{r}, E_{s}$ with free-propagating Gaussian beams through the nonlinear minimization of Eq. (10). The method helps to overcome several major obstacles in quantitative holography, but also introduces substantial limitations. In the following we discuss major limitations and possible improvements.

First, the nonlinear optimization is quite slow. As we find in this work, while the analytical form of the Gaussian beam (Eq. (B7)) [32-34] helps to avoid the resource-demanding, numerical propagation of full wavefronts $[18,30,42,43]$, to resolve single hologram still requires about 2 minutes even with a A100 GPU card (NVIDIA). Notably, for repeated measurements such as during a probe-frequency scan $[1,62]$, the processing time can be substantially reduced, down to tens of seconds, by seeding the optimization process with nearly optimal initial $\left\{c_{j}, \mathbf{P}_{j}\right\}$-parameters. With more advanced software and hardware supports, we expect further improved imaging processing speed in future work.

Second, as detailed in Appendix C1, diffractionlimited $\varphi\left(z_{A}\right)$-image is most easily achieved for small samples satisfying $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$ (Fig. 1a) only. Beyond this "defocused-twin regime", accurate $\varphi_{A}-$ retrieval relies on improving the decomposition of $E_{s}$ using more Gaussian profiles (larger $n_{A}$ ), i.e., to capture fine details of $E_{s}$ so that the defocused twin-image noise (Eq. (13)) around $z=z_{A}$ is more efficiently removed. While the principle of such improvement as outlined in Sec. II B appears straightforward, its practicality in presence of imaging noise requires systematic study in future work. Nevertheless, we note that depending on the spatial resolution requirements, the $z_{A}$ and $z_{H}-z_{A}$ limited by the camera sensor size can typically be at a centimeter level. This in term supports sparse arrays with individual sample size of up to $100 \mu \mathrm{m}$ (Fig. 6), large enough for various applications. At moderate $z_{\sigma}$, the Gaussian-decomposition method can also be assisted by Gerchberg-Saxton-type iterations [18, 29, 30, 58] to improve the $E_{s}$ estimation.

Finally, the Gaussian-assisted holography method in this work assumes free-propagation between the sample plane at $z=z_{A}$ and camera plane at $z=z_{H}$. Practically, the atomic samples are often imaged to the camera plane through a lens array [17, 43, 64]. In this experimental work, the moderate, aplanatic aberrations in $E_{s}$ are corrected by a pre-characterized point-spread-function near the atomic sample location (Appendix D 3). Obviously, the method becomes insufficient in presence of strong astigmatism during, e.g., wide-field imaging [65-67]. In future work and with sufficient knowledge of the imaging system, full suppression of strong, astigmatic aberrations can be achieved by exploiting the Gaussian propagation across the lens array numerically [33, 34]. This may potentially enable diffraction-limited 3D complex-valued spectroscopic imaging across unprecedented imaging volumes, only limited by the pixel-size of the camera [68].

## D. Structure of the rest of the paper

In the following the main text is structured into three sections. With technical details presented in Appendix B, we first outline the principles of the Gaussiandecomposition-assisted holographic imaging method in Sec. II. Next, in Sec. III we present experimental demonstration of diffraction and shot-noise limited complexvalued imaging. We summarize this work in Sec. IV.

## II. PRINCIPLES

The schematic setup of our Gaussian-decompositionassisted complex-valued spectroscopic imaging method is illustrated in Fig. 1(a-c). The Fig. 1a setup is already outlined in Sec. IA. We regard the $\left(I^{\prime}, I\right)$ measurement as a single-shot measurement. With in mind no atomnumber or interaction-strength normalization measurement is required later, the $I^{\prime}$-exposure can be strong and elongated to substantially alter the atomic velocity and/or the internal atomic state population. The $I$-exposure is taken immediately after the atomic sample is dispersed from the $E_{r}$ illumination.

We assume the holographic imaging setup to be effectively lensless [30] so that the accurate propagation of wavefronts between $z_{A}$ and $z_{H}$ is modeled by Eq. (D1), $E\left(z^{\prime}\right)=\hat{U}\left(z^{\prime}-z\right) E(z)$, through angular spectrum method numerically. On the other hand, for repetitive short-distance propagation during numerical optimization, the Gaussian-decomposed $E_{r}, E_{s}$ wavefronts are sampled according to the analytical Eq. (B7) under paraxial approximation (also see Appendix D 3.).

The reconstruction of $\varphi_{A}(x, y)$ at $z=z_{A}$ is divided into Sec. II A,II B,II C steps.

## A. Obtaining $E_{r}$

A prerequisite to recover $E_{s}$ through the holographic measurement with Eq. (3) is to characterize the $E_{r}$ wavefront precisely. The steps for the $E_{r}$ measurements are illustrated in Fig. 1(a,b), detailed in ref. [18]. Briefly, using the single-shot $I$-data, the probe wavefront $E_{r}=\sqrt{I} e^{i \phi_{r}}$ is obtained by intensity-matching $I$ to $I_{0}=\left|E_{r}^{(0)}\left(z_{H}\right)\right|^{2}$. Here $\phi_{r}=\arg \left(E_{r}^{(0)}\right) . E_{r}^{(0)}$ is the pre-characterized probe wavefront, obtained with multi-plane intensity measurements of $E_{r}$, followed by Gerchberg-Saxton iteration [69] (Fig. 1b). Notice the $E_{r}$ wavefront measurement is designed to share the same optical path with the holographic measurement.

## B. Minimal Gaussian-decomposition of $E_{s}$

We parametrize $E_{s}$ with $n_{A}$ Gaussian beams according to Eq. (7), and minimize the cost function

$$
\begin{equation*}
\mathcal{L}_{\text {tot }}\left(z_{A},\left\{c_{j}, \mathbf{P}_{j}\right\}\right)=\mathcal{L}_{H}+\mathcal{L}_{A} \tag{10}
\end{equation*}
$$

with

$$
\begin{equation*}
\mathcal{L}_{H}\left(\left\{c_{j}, \mathbf{P}_{j}\right\}\right)=\left.\left.\sum_{x, y}\left|\delta I-E_{r}^{*} E_{G}-E_{r} E_{G}^{*}-\right| E_{G}\right|^{2}\right|^{2} \tag{11}
\end{equation*}
$$

and

$$
\begin{equation*}
\mathcal{L}_{A}\left(z_{A},\left\{c_{j}, \mathbf{P}_{j}\right\}\right)=\sum_{\mu} m_{\mu} C_{\mu}\left(\varphi_{G}\left(z_{A},\left\{c_{j}, \mathbf{P}_{j}\right\}\right)\right) \tag{12}
\end{equation*}
$$

Here $\mathcal{L}_{A}$ is formulated into a list of $C_{\mu}$-constraints (Appendix B 2) weighted by $m_{\mu}$, which can be adjusted during the optimization. The $\varphi_{G}\left(z_{A} ;\left\{c_{j}, \mathbf{P}_{j}\right\}\right)=$ $-i \log \left(1+E_{G} /\left\langle E_{r}\right\rangle_{G}\right)_{z=z_{A}}$ evaluates the complex-valued phase shift by Eq. (1), with $E_{r}$ replaced by the known Gaussian envelope $E_{r} \approx\left\langle E_{r}\right\rangle_{G}$. Simultaneous evaluation of Eq. (11) at $z=z_{H}$ and (12) with varying $z_{A}$ is assisted by the analytical Gaussian propagation (Eq. (B7)).

We assume the envelope $\left\langle E_{s}\right\rangle_{G}$ to be sparse in the Gaussian beam basis. To ensure a minimal $n_{A}$ for the $E_{s}$ decomposition, we start with $n_{A}=1$ in Eq. (7) for each atomic sample and progressively increase $n_{A}$ by splitting one of the optimal Gaussian beams for additional optimization. During the process, the quality of the decomposition is checked by analyzing the difference between $\left\langle E_{s}\left(z_{A}\right)\right\rangle_{G}$ with the $\tilde{E}_{s}\left(z_{A}\right)$ approximation,

$$
\begin{align*}
& \tilde{E}_{s}\left(z_{A}\right)=\hat{U}\left(z_{A}-z_{H}\right) \tilde{E}_{s}\left(z_{H}\right), \text { with } \\
& \tilde{E}_{s}\left(z_{H}\right)=\left(\frac{\delta I-E_{r}\left\langle E_{s}\right\rangle_{G}^{*}-\left|\left\langle E_{s}\right\rangle_{G}\right|^{2}}{E_{r}^{*}}\right)_{z=z_{H}} \tag{13}
\end{align*}
$$

as

$$
\begin{equation*}
\delta E_{G}\left(z_{A}\right)=\tilde{E}_{s}\left(z_{A}\right)-\left\langle E_{s}\left(z_{A}\right)\right\rangle_{G} \tag{14}
\end{equation*}
$$

Here the Gaussian approximation $\left\langle E_{s}\left(z_{A}\right)\right\rangle_{G}$ only contains low-spatial-frequency part of $E_{s}\left(z_{A}\right)$. Instead, $\tilde{E}_{s}\left(z_{A}\right)$ has the full imaging bandwidth, except that with the twin (Eq. (5)) and a typically weaker "dc" $\left|E_{s}\right|^{2} / E_{r}^{*}$ approximately removed, $\tilde{E}_{s}\left(z_{A}\right)$ is subjected to disturbance by high-frequency residual of $E_{s, \text { twin }}$ not captured by the Gaussian approximation. In principle, the optimization should continue until sufficient $n_{A}$ Gaussians ensures fine enough decomposition, so that the $\delta E_{G}\left(z_{A}\right)$ in Eq. (14) becomes featureless, i.e., the two approximations agree at low-spatial-frequency of interest. In this work, the decomposition process is terminated emphatically (Sec. III) at $n_{A}=3$ for small spherical samples (See Appendix E for larger $n_{A}$ examples). We expect more systematic study in future work on the refinement of $\left\langle E_{s}\right\rangle_{G}$ decomposition, particularly for large samples.

Finally, the above analysis is easily generated to multiple samples, indexed by $A$, which are centered at $\mathbf{r}_{A}=$ $\left\{x_{A}, y_{A}, z_{A}\right\}$ to be sparse enough (Appendix C 2) not to interfere with each other during the Gaussian decomposition. We refer the coherent forward scattering by each sample as $E_{s, A}$ so that $E_{s}=\sum_{A} E_{s, A}$.

## C. Retrieving diffraction-limited $\varphi_{A}$

When the constrained Gaussian-decomposition to $E_{s}$ is successful, an estimation of the Gaussian envelop $\left\langle E_{s}\right\rangle_{G}$ is obtained. Depending on the prior knowledge of the phase angle $\beta$, the sample plane location $z=z_{A}$ is determined with an accuracy close to the photon-shot-noise limit (Eq. (8)) (Appendix A). We therefore obtain the low-resolution envelop of the complex-valued phase-shift,

$$
\begin{equation*}
\left\langle\varphi_{A}\right\rangle_{G}=-i \log \left(1+\left\langle E_{s, A}\right\rangle_{G} /\left\langle E_{r}\right\rangle_{G}\right)_{z=z_{A}} \tag{15}
\end{equation*}
$$

When $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$, the low-resolution reconstruction of $\left\langle\varphi_{A}\right\rangle_{G}$ can be refined into diffraction-limited $\varphi_{A}$ image according to Eq. (1), simply by replacing the $E_{s}$ there with

$$
\begin{equation*}
E_{s, A}\left(z_{A}\right) \approx \hat{P}_{A}\left(\tilde{E}_{s}\left(z_{A}\right)\right) \tag{16}
\end{equation*}
$$

where

$$
\begin{equation*}
E_{r}\left(z_{A}\right)=\hat{U}\left(z_{A}-z_{H}\right) E_{r}\left(z_{H}\right) \tag{17}
\end{equation*}
$$

The $z_{A}$ localization can be accordingly refined. The aperture operator $\hat{P}_{A}$ encloses a minimal area at $z=z_{A}$, according to our prior knowledge about the sample location (Fig. 1c), to select the $E_{s, A}$ wavefront.

As to be explained in Appendix C $1, \tilde{E}_{s}\left(z_{A}\right)$ contains all $E_{s}$ features within the full imaging bandwidth, except that it is subjected to disturbance by the out-offocus, high-frequency-part of $E_{s, \text { twin }}$ not captured by the Gaussian approximation. By operating the Fig. 1a setup in the "defocused-twin regime" with $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$, the residuals spread out sufficiently not to affect the $\varphi_{A}$ retrieval. In addition, Eq. (16) assumes that the multiple samples are only weakly displaced along $z$, as in this experimental work, with coherent forward scattering not overlapping in the sample planes. To retrieve $\varphi_{A}$ for multiple samples with substantial $E_{s, A}$ overlap requires separation of each $E_{s, A}$ in a self-consistent manner, a scenario that will be discussed in Appendix C 2.

## D. Complex phase shift near an isolated transition

The $\varphi_{A}$ measurement as outlined above needs to be compared with theory to extract useful information. With Eq. (2) and for small and dilute ensemble of atoms in the Beer-Lambert regime, the transmission of probe light is purely decided by the complex phase shift $\varphi_{A}(x, y) \propto \rho_{c}(x, y) \alpha$ associated with moderate absorption OD and phase shift $\phi$. For weak and short enough probe, the linear response $\alpha$ can be evaluated by firstorder perturbation theory [70]. However, when applying the formula to real experiments, the accuracy of the estimation is often prone to optical saturation [13] and multi-scattering [25] effects. A closer look into the transient atomic response suggests that even for fairly strong probe, e.g., either for suppressing multi-scattering effects $[63,71]$ or for enhancing the signal, the complex phase $\varphi_{A}$ can often still be approximated by [19]

$$
\begin{equation*}
\varphi_{A}(x, y) \approx \xi\left(s_{0}, \Delta\right) \frac{3}{8 \pi} \rho_{c}(x, y) \lambda^{2} \frac{-\Gamma / 2}{\Delta+i \Gamma / 2} \tag{18}
\end{equation*}
$$

Here $s_{0}$ is the probe saturation parameter. The $\Delta=$ $\omega-\omega_{e g}$ is the probe detuning from the isolated $\omega_{e g}$ atomic resonance under study. $\Gamma$ is the linewidth. The real number $\xi\left(s_{0}, \Delta\right)$ is a saturation factor associated with internal state dynamics. For example, for long enough probe to a closed transition so that the atomic response is able to reach its steady state, we have the standard $\xi\left(s_{0}, \Delta\right) \approx C^{2} /(1+s)$ associated with the coherent dipolar excitation, with $C^{2} \leq 1$ decided by the probe polarization and optical-pumping induced atomic population re-distribution, and $s=s_{0} \Gamma^{2} /\left(4 \Delta^{2}+\Gamma^{2}\right)$ [72].

As detailed in ref. [19], the Eq. (18) approximation is valid for smooth and long probe pulse with duration $\tau_{p} \gg$ $1 / \Gamma$ so that transient effects can be averaged out, and for spectrally isolated $g-e$ transition so that virtual mixing to distant levels is ineffective [19]. Clearly, in Eq. (18) the $\xi\left(s_{0}, \Delta\right)$ factor dictates the power-broadening in $\mathrm{OD}=$ $2 \operatorname{Im}\left[\varphi_{A}\right]$ and $\phi=\operatorname{Re}\left[\varphi_{A}\right]$. But the phase angle $\beta=$ $\arg \left[\varphi_{A}\right]$ is intact even for $s \gg 1$. The robust phaseangle relation is exploited to axially locate the $z_{A}$ plane (Appendix B 2 b, B 2 c) [19]. Nevertheless, one should be cautious that apart from transition shifts and broadening associated with mixing distant levels [19], the $\Delta^{\prime}=\Delta-$ $k_{0} \overline{\Delta v}$ is also shifted from $\Delta$ by atomic motion along the probe wavevector $\mathbf{k}_{0}$, which can be induced by radiation pressure during prolonged excitation of free atoms.

## III. EXPERIMENTAL DEMONSTRATION

In this section, we demonstrate 3D complex-valued spectroscopic imaging of laser-cooled ${ }^{87} \mathrm{Rb}$ samples on the D2 line. The energy diagram is given in Fig. 2a. The D2 linewidth is $\Gamma=2 \pi \times 6 \mathrm{MHz}[72]$.

## A. Experimental setup

The schematic setup is illustrated in Fig. 2a. The probe beam is generated by an $\mathrm{NA}=0.3$ objective [73] to create a diffraction-limited focus at $z=0$ in vacuum. A sparse array of ${ }^{87} \mathrm{Rb}$ atoms is created around $z_{A} \approx 1.5 \mathrm{~mm}$, as to be detailed in the following. During holographic imaging, the $E_{r}, E_{s}$ wavefronts are relayed by an aberration-compensated $D=50.8 \mathrm{~mm}$-diameter lens-array [74], not shown in the figure, to the camera (PICO Pixelfly-USB) sensor outside the vacuum. The imaging system has a reduced numerical aperture of $\mathrm{NA}=0.26$, limited by additional optics following the objective, and a lateral magnification of $M=3.5$. To perform inline holography, the camera is translated along $z$, defocused by $\Delta z_{H}^{(0)}=17.5 \mathrm{~mm}$, to record the magnified $I^{\prime}, I$ holograms. In the following and for the convenience of presentation, we describe the imaging process in-situ, as in Fig. 2a, where the camera plane is effectively at $z_{H}$ that is displaced from $z_{A}$ by $\Delta z_{H}^{(0)} / M^{2} \approx 1.4 \mathrm{~mm}$. We refer readers to Sec. IV A and Appendix D 3 where steps for aberration corrections are discussed.

We construct a 3D optical lattice, as in Fig. 2a, to confine a sparse atomic sample array. The lattice geometry is adapted to the limited optical access in our setup. Two of the five lattice beams, propagating along $\tilde{\mathbf{e}}_{x}=\frac{1}{\sqrt{2}}\left(\mathbf{e}_{x}+\mathbf{e}_{y}\right)$ with a $3^{\circ}$ intersecting angle, creates

1D lattice along the $\tilde{\mathbf{e}}_{y}=\frac{1}{\sqrt{2}}\left(\mathbf{e}_{x}-\mathbf{e}_{y}\right)$ direction. Three other beams propagate along $\tilde{\mathbf{e}}_{y}$ to form a square lattice in the $\left\{\tilde{\mathbf{e}}_{x}, \mathbf{e}_{z}\right\}$ plane. The primitive lattice vectors are oriented along the $\frac{1}{\sqrt{2}}\left(\tilde{\mathbf{e}}_{x} \pm \mathbf{e}_{z}\right)$ directions. A relative frequency shift of $20 \mathrm{MHz}$ between the two $\tilde{\mathbf{e}}_{x}$-beams and the three $\tilde{\mathbf{e}}_{y}$-beams removes the interference between the two lattice confinement dimensions.

We choose the lattice laser wavelength to be $\lambda_{l}=$ $779.5 \mathrm{~nm}$, blue-detuned from the rubidium D2 line. With $\sim 100 \mathrm{~mW}$ per beam, $10 \mathrm{mK}$-level trapping potentials are formed for the ground-state rubidium atoms around the dark centers of lattices. The lattice constants along $\tilde{\mathbf{e}}_{y}$ and in the $\tilde{\mathbf{e}}_{x}-\mathbf{e}_{z}$ plane are $15 \mu \mathrm{m}, 18 \mu \mathrm{m}$ and $22 \mu \mathrm{m}$, respectively. Following a gray molasses cooling stage [75], ${ }^{87} \mathrm{Rb}$ from a magneto-optical trap is loaded directly into the lattices, resulting in samples with a characteristic width of $\sigma \approx 2.5 \mu \mathrm{m}$ and typical atom number of $10^{2} \sim 10^{3}$ per site with $\rho=10^{12} \sim 10^{13} / \mathrm{cm}^{3}$ in density. Observing these samples along $z$, the transverse displacements between adjacent samples are about $10 \mu \mathrm{m}$, well resolvable with our coherent imaging resolution of $\delta x=$ $\lambda / \mathrm{NA}=3 \mu \mathrm{m}$. Here $\lambda=780 \mathrm{~nm}$. On the other hand, the axial displacement of $\delta z=10 \mu \mathrm{m}$ is below the diffractionlimited resolution of $(\delta z)_{\text {res }}=2 \lambda / \mathrm{NA}^{2}=23 \mu \mathrm{m}$.

To perform atomic spectroscopy, we release the atomic samples from the optical lattices and then immediately fire a $\tau_{\mathrm{p}}=20 \mu \mathrm{s}$ probe pulse. The probe polarization is along $\mathbf{e}_{x}$. The local intensity of $3 \mathrm{~mW} / \mathrm{cm}^{2}$ leads to $s_{0} \approx$ 1 saturation parameter in this work for the $\pi$-excitation of unpolarized atoms. In repeated experiments we scan the probe detuning $\Delta=\omega-\omega_{e g}$ across the D2 hyperfine $F=2-F^{\prime}=3$ transition. Up to 9 holograms are taken at each detuning. A typical reduced hologram, $\delta I=I^{\prime}-I$, is given in Fig. 2c, taken on resonance with $\Delta \approx 0$.

## B. Results

With the $\left\{I^{\prime}, I\right\}$-hologram set and the precharacterized $E_{r}$, We follow the procedure outlined in Sec. II to reconstruct $E_{s}$ using the Gaussiandecomposition method. To initiate the nonlinear optimization (Eq. (10)), we first directly propagate $E_{s}^{(0)}=\delta I / E_{r}^{*}$ to an estimated atomic sample plane $\bar{z}_{A}$. As evident from Eq. (3), with this step $E_{s}\left(\bar{z}_{A}\right)$ can be focused, albeit being contaminated by a weak, defocused background associated with the "twin" term $E_{s, \text { twin }}$ (Eq. (5)), as well as a typically even weaker "dc" $\left|E_{s}\right|^{2} / E_{r}^{*}$ term. Nevertheless, the preliminary $E_{s}^{(0)}\left(\bar{z}_{A}\right)$ image in Fig. 2b helps us to initialize the $\left\{c_{j}, \mathbf{P}_{j}\right\}$-parameter and compute $E_{G}^{(0)}$, as in Fig. 2d, with which we evaluate the expected (reduced) hologram $\delta I_{e}^{(0)}=E_{r}^{*} E_{G}^{(0)}+E_{r} E_{G}^{(0) *}+\left|E_{G}^{(0)}\right|^{2}$ in Fig. 2e.

As by Eq. (10), the minimization of $\mathcal{L}_{\text {total }}$ involves simultaneous minimization of $\mathcal{L}_{H}=\sum\left|\delta I_{e}-\delta I\right|^{2}$ and a set of $\mathcal{C}_{\mu}\left(\varphi\left(z_{A}\right)\right)$ in $\mathcal{L}_{A}$ associated with the expected $\varphi_{A}$ distribution. In this step, we exploit spatial (Ap-
![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-07.jpg?height=962&width=832&top_left_y=170&top_left_x=1080)

(e)
![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-07.jpg?height=830&width=862&top_left_y=858&top_left_x=1094)

FIG. 2. (a): Sketch of the experimental setup, typical hologram $\delta I$ at $\Delta \approx 0$, and the atomic level diagram. (b)-(c): Reduced hologram $\delta I$ (averaged over 9 exposures to enhance the display) and the modulus of $E_{s}^{(0)}\left(\bar{z}_{A}\right)=\hat{U}\left(\bar{z}_{A}-z_{H}\right)\left(\frac{\delta I}{E_{r}^{*}}\right)$ in $\bar{z}_{A}$ plane. (d)-(e): Initial Gaussian beams profile in the $z=\bar{z}_{A}$ plane (plotted as $\left|E_{G}^{(0)}\right|$ ) and expected (reduced) hologram $\delta I_{e}$ in $z=z_{H}$. The sub-figure on (e) is the residual $\delta I_{e}-\delta I$. (f)-(g): Modulus of the optimal Gaussian profiles $E_{G}=\left\langle E_{s}\left(\bar{z}_{A}\right)\right\rangle_{G}$ and the corresponding hologram. (h): Modulus of $\tilde{E}_{s}\left(\bar{z}_{A}\right)$ with Gaussian-approximated twin image removed. Eleven samples are labeled from left to right, from top to bottom. (i): Reconstructed OD, $\phi$ distributions. At $z=\bar{z}_{A}$, only the samples in dash-lined boxes are with the phase-shift $\phi$ rightly suppressed in-focus for $\Delta \ll \Gamma$.

pendix B 2 a) and phase-uniformity (Appendix B 2 c) constraints. With $n_{A}=3$ Gaussians for each samples, the final Gaussian approximation $\left\langle E_{s}\right\rangle_{G}$ is displayed at $z=\bar{z}_{A}$ in Fig. 2f. The optimal $\delta I_{e}$ is shown in Fig. 2g. Finally,
following Eq. (13), we obtain $\tilde{E}_{s}$ which is displayed in Fig. 2h at $z=\bar{z}_{A}$.

With $\tilde{E}_{s} \approx E_{s}$ and $E_{r}$ at hand, in Fig. 2i we evaluate $\varphi_{A}$ for all the samples at the fixed, "common" $z=\bar{z}_{A}$, and plot the OD and $\phi$ images. The array of samples are axially displaced by tens of micrometers. Here, with $\Delta \ll \Gamma$ we expect $\phi \ll$ OD according to Eq. (18), which is satisfied for arrays of samples enclosed by dash-lined boxes only. For these samples, their $z_{A}$ are close enough to $\bar{z}_{A}$ in the display. For other samples, the out-of-focus images mixes OD with $\phi$, as expected.

## 1. Sample position localization

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-08.jpg?height=266&width=304&top_left_y=824&top_left_x=173)

(d)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-08.jpg?height=254&width=323&top_left_y=1117&top_left_x=207)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-08.jpg?height=258&width=296&top_left_y=825&top_left_x=470)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-08.jpg?height=265&width=293&top_left_y=827&top_left_x=751)

(e)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-08.jpg?height=269&width=336&top_left_y=1107&top_left_x=580)

FIG. 3. (a)(b)(c): Relative displacement between two samples marked in (d)(e) (and Fig. 2h) estimated with singleshot $\delta I$ using Eq. (B10) criterion. The single-shot estimation at different probe detunings are plotted with red dots. Black triangles indicate the photon-shot-noise limits according to Eq. (A10). The standard deviations $\Delta x_{A}, \Delta y_{A}, \Delta z_{A}$ in the figures are averaged over all data at detunings between $-12 \mathrm{MHz} \leq \Delta / 2 \pi \leq 12 \mathrm{MHz}$. (d)(e): Visualization of the sample locations in the 3D lattice. Here the locations are collectively decided by the phase angles [19] using Eq. (18) with the $4 \mathrm{MHz} \leq|\Delta| / 2 \pi \leq 12 \mathrm{MHz}$ data. The atom number $N_{a}$ is estimated by Eq. (18) with $\xi(s) \propto 1 /(1+s)$ [72]. The circles represent the atomic samples with radius representing the sample sizes. The sizes are larger than $\Delta x_{A}, \Delta y_{A}$, as well as the collectively-improved $\Delta z_{A} \leq 1.5 \mu \mathrm{m}$.

With the $E_{s}$ decomposition based on single-shot $\left(I^{\prime}, I\right)$ data, we obtain a list of $z_{A}$ and the low-resolution $\left\langle\varphi_{A}\right\rangle_{G}$ for each samples. Using $\left|\left\langle\varphi_{A}\right\rangle_{G}\right|$ in the $x-y$ plane, the center-of-mass locations $\mathbf{r}_{A}=\left\{x_{A}, y_{A}, z_{A}\right\}$ are retrieved. As being outlined in Sec. II, for the $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$ samples here, we refine the $z_{A}$ estimation simply by reconstructing $\tilde{E}_{s}$ with Eq. (13), and then re-applying the phase-angle uniformity criterion (Eq. (B10)). Depending on the $E_{s}$ complexity and the $n_{A}$ exploited for the decomposition ( $n_{A}=3$ here), the $\tilde{E}_{s}$-refinement generally leads to slightly improved $z_{A}$-estimation. Here, for samples with substantial OD and $\phi$, such as the (4), (5) sam- ples for Fig. 2(a-c) data, this refinement corrects small $\Delta$-dependent errors in $z_{A}$ by $2 \sim 5 \mu \mathrm{m}$.

To estimate the accuracy of the atomic sample localization, ideally we would like to analyze the fluctuation of the individual position values retrieved from repeated measurements. However, our sparse lattice is not stable enough. The lattice centers translate together by $1 \sim 2 \mu \mathrm{m}$ from shot-to-shot, likely caused by pointinginstability of the lattice beams (Fig. 2a). While the fluctuation hardly impacts our axial, $z_{A}$-localization analysis, its suppression is required for analyzing the statistics on the more precisely located $x_{A}, y_{A}$ values. To suppress the position fluctuation, in Fig. 3a-c we instead analyze the relative displacement between two samples. For the single-shot analysis we choose samples with largest atom numbers, marked as "(4), (5)" according to Fig. 2h. In Appendix A we evaluate the shot-noiselimited precision to $\Delta \mathbf{r}_{A}$ as the classical Cramer-Rao bounds with $N_{s}=\sum_{x, y}\left|E_{s, A}\right|^{2}$ photons (Eq. (A10)). We find the transverse $\Delta x_{A}, \Delta y_{A}$ are about a factor of 5 6 larger than the $100 \mathrm{~nm}$-level photon shot-noise limit (Eq. (A10)), which are likely due to shot-to-shot relative motion between the pair of samples. On the other hand, the $4 \mu \mathrm{m}$ axial $\Delta z_{A}$ is a factor of 4 larger than the photon shot-noise limit (Eq. (A10)). That the single-shot $\Delta z_{A}$ is quite far from the shot-noise-limit is likely related to non-optimal data analysis in presence of imaging noises. Nevertheless, both the transverse $\Delta x_{A}, \Delta y_{A}$, and the axial $\Delta z_{A}$, are already all well-below the diffraction limits set by $\lambda / \mathrm{NA}=3 \mu \mathrm{m}$ and $2 \lambda / \mathrm{NA}^{2}=23 \mu \mathrm{m}$, respectively.

Therefore, as in Fig. 3c, we are able to "super-resolve" $z_{A}$ for each sample with $\sim 10^{2}$ atoms even using a singleshot $\left(I^{\prime}, I\right)-$ data with $\tau_{p}=20 \mu \mathrm{s}$ exposure. The accuracy can be improved further by exploiting the spectroscopic constraint with the full $\left\{I^{\prime}, I\right\}$ data set [19] collectively. In particular, by enforcing the $\tan \beta \propto \Delta$ relation required by Eq. (18) for all the data (except for $|\Delta| / 2 \pi<4 \mathrm{MHz}$ data, where the radiation pressure effect is most predominant, as following), our $z_{A}$ estimation is substantially improved. For the (4), (5) samples, the $\Delta z_{A}$ are reduced to below one micrometer. Comparing with single-shot $z_{A}$ localization as in Fig. 3c, the refined $z_{A}$ typically involves $2-3 \mu \mathrm{m}$ additional corrections. These corrections helps to ensure that the samples are more consistently located within dark centers of the 3D lattice, as illustrated in Figs. 3(d)(e).

## 2. Complex-valued spectroscopic imaging

With the list of $z_{A}$ and $\left\langle\varphi_{A}\right\rangle_{G}$ for each sample, we can proceed to evaluate $\tilde{E}_{s, A}$ with Eqs. (13)(16) and to approximately obtain $\varphi_{A}$ with diffraction-limited resolution, according to Eq. (2). However, as discussed in Appendix A, the Eq. (9) shot-noise-limit to the phaseangle $\beta$ is reached with fixed $z_{A}$. Without the knowledge, the phase-angle uncertainty $\Delta \beta$ is compromised by a factor of $1 / \sqrt{2}$, at least. Therefore, we re-optimize
(a)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-09.jpg?height=390&width=816&top_left_y=171&top_left_x=232)

(b)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-09.jpg?height=334&width=436&top_left_y=592&top_left_x=191)

(d)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-09.jpg?height=336&width=393&top_left_y=916&top_left_x=191)

(f)
![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-09.jpg?height=658&width=458&top_left_y=1240&top_left_x=172)

(h)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-09.jpg?height=344&width=396&top_left_y=587&top_left_x=645)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-09.jpg?height=344&width=404&top_left_y=907&top_left_x=638)
(g)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-09.jpg?height=320&width=331&top_left_y=1255&top_left_x=710)

FIG. 4. Complex-valued spectroscopic imaging. (a): Color domain plot of $\varphi_{A}$ with all the samples projected to the $z=\bar{z}_{A}$ plane. (b)(f): Average $\overline{\mathrm{OD}}, \bar{\phi}$, within $\hat{P}_{A}$ marked in (a), for "1,4" samples respectively. Solid (transparent) dots are average (individual) values of nine measurements. Solid lines are fitted according to Eq. (18). (d)(h): The phase-angle spectroscopy. Notice in (h) the 9 sets of data overlap closely. (c)(g): $\overline{\mathrm{OD}} / 2-\bar{\phi}$ phasor plot at $\Delta / 2 \pi=$ $-6 \mathrm{MHz},-2 \mathrm{MHz}, 0 \mathrm{MHz}, 2 \mathrm{MHz}$ and $6 \mathrm{MHz}$, in red, orange, yellow, green, and blue respectively. The black lines are according to the (b)(f) fits. (e)(i): Residuals of $\bar{\beta}$ from the (d,h) fits. Black triangles and dashed lines give photon-shot-noise limit [18] (Eq. (9)). The phase-angle uncertainty $\Delta \bar{\beta}$ of 0.11 and 0.031 are averaged over $4 \mathrm{MHz} \leq|\Delta| / 2 \pi \leq 12 \mathrm{MHz}$ single shot data. The values are about a factor of two larger than the corresponding photon-shot-noise limit (Eq. (9)) [76].

the Gaussian decomposition, using the $\left\{I, I^{\prime}\right\}$-set, collectively improved $z_{A}$ as prior knowledge. The phase-angle spectroscopy to be discussed in the following is based on such re-optimized single-shot Gaussian decomposition (Fig. 3(d,e)).

We now evaluate $\varphi_{A}=\varphi\left(z_{A}\right)$ using Eqs. (2)(16). The color-domain plots in Fig. 4a show $\varphi_{A}$, with phase angle $\beta$ indicated by color and modulus $\left|\varphi_{A}\right|$ by brightness. In contrast to Fig. 2(i), $\varphi\left(z_{A}\right)$ s from various samples are "projected" to $z=\bar{z}_{A}$ from different $z_{A}$ planes. In the plots we observe consistent phase-angle $\beta$ at the same detunings $\Delta$, as anticipated. It is also observed that the same sample may appear slightly different at various detunings. This slight distortion in shape is primarily attributed to the lensing effect as the probe passes through the microscopic samples.

To further demonstrate aspects of the complex-valued spectroscopy, in Figs. 4(b)(f) we choose (1), (4) samples and plot $\overline{\mathrm{OD}}=2 \operatorname{Im}\left[\bar{\varphi}_{A}\right], \bar{\phi}=\operatorname{Re}\left[\bar{\varphi}_{A}\right]$ as a function of the probe detuning $\Delta$. Here $\bar{\varphi}_{A}$ is averaged over the sample area $\hat{P}_{A}$ as suggested in Fig. 4a. The same data is further presented in Figs. 4(c)(g) as 2D phasor plots, and in Figs. 4(d)(h) in terms of phase-angle spectroscopy.

In Figs. 4(b)(f) we see data from the repeated singleshot measurements fluctuate substantially. A closer look suggests there are strong correlations between the $\overline{\mathrm{OD}}$ and $\bar{\phi}$ fluctuations, which are more clearly seen in Figs. $4(\mathrm{c}, \mathrm{g})$ : The repeated measurements mostly spread the data points along the radial $\left|\varphi_{A}\right|$ direction instead of along $\beta$. These fluctuations are associated with the quiteexpected atom number fluctuations in repeated measurements, which strongly affect the modulus $\left|\varphi_{A}\right|$ but hardly affect $\beta$, according to Eq. (18).

The $\beta$-stability is directly seen in the Fig. $4(\mathrm{~d})(\mathrm{h})$ phase-angle plot. Here we use Eq. (18), with $\xi(s) \propto$ $1 /(1+s)$, to fit the data. By excluding the $-4 \mathrm{MHz}<$ $\Delta / 2 \pi<4 \mathrm{MHz}$ data points from the fit, $s_{0} \approx 1$ and $\Gamma \approx 6 \mathrm{MHz}$ can be extracted, agreeing excellently with expectation. The residuals are shown in Figs. 4(e)(i). Notably, for all the samples, we consistently see deviation of the $\bar{\beta}$-data from the 2 -level model within $\Delta<\Gamma / 2$. As in Sec. IID, this deviation is caused by Doppler shifts associated with atomic motion. In particular, for the $\tau_{p}=20 \mu \mathrm{s}$ probe with $s_{0}=1$ on resonance, the atomic sample is expected to be accelerated to a final $v \approx 1 \mathrm{~m} / \mathrm{s}$ along $\mathbf{e}_{z}$. The average $k \overline{\Delta v} \sim 2 \pi \times 640 \mathrm{kHz}$ Doppler shift is sensed by our complex spectroscopy, leading to $\delta \bar{\beta}=2 k \overline{\Delta v} / \Gamma \approx 0.2$ shift to the phase angle, according to Eq. (18). Remarkably, the shift is almost halved for the (4) sample, as in Fig. 4i, which is likely related to reduced radiation pressure [77] due to attenuation of the probe by the larger sample.

We note that on resonance the radiation pressure is also expected to displace the samples by up to $10 \mu \mathrm{m}$ along $z$. The average $z_{A}$ displacement is $2 \sim 3 \mu \mathrm{m}$-level at most. The differential displacement between (4), (5) samples caused by the radiation pressure is below the axial resolution in Fig. 3(c).

We estimate the phase-angle resolution $\Delta \bar{\beta}(\Delta)$ using the data statistics from Fig. 4(e)(i). Theoretically, for optically thin samples, the resolution $\Delta \bar{\beta}(\Delta)$ is constrained by $N_{s}(\Delta)$, which represents the number of coherently scattered photons $E_{s}$ received by the camera, through the Eq. (9) relation (Appendix A). After applying a moderate correction for finite $\left|\varphi_{A}\right|$ as discussed in ref. [18], the shot-noise-limited $\Delta \bar{\beta}$ values are evaluated according to Eq. (9) and marked with triangle symbols in Fig. 4(e)(i). We observe that the values of $\Delta \bar{\beta}$ closely follow the photon-shot-noise limit for both the (1) and (4) samples. By averaging the standard deviations of $\Delta \beta(\Delta)$ across all data in Fig. 4, excluding the range $-4 \mathrm{MHz}<\Delta / 2 \pi<4 \mathrm{MHz}$, we estimate statistically the single-shot resolution to be $\Delta \bar{\beta} \approx 0.11$ and 0.031 for the (1) and (4) samples, respectively [76]. For the (4) sample, the $30 \mathrm{mrad}$ resolution in $\beta$ suggests a frequency resolution of $\Delta \omega=2 \pi \times 100 \mathrm{kHz}$, according to Fig. $4 \mathrm{~h}$ and Eq. (18) near $\Delta=0$, where $\Delta \omega=\Delta \beta \times \Gamma / 2$ and $\Gamma=2 \pi \times 6 \mathrm{MHz}$.

## 3. Field sensing

With the spectroscopic images of atomic arrays, it is possible to detect local perturbation to the $|g\rangle-|e\rangle$ transition frequency $\omega_{e g}$ in $3 \mathrm{D}$ with high spatial resolution. In this section, we demonstrate this field-sensing capacity by measuring the transition light shift induced by a "dressing" laser. The schematic setup is displayed in Fig. 5a. Right before the imaging exposure, a dressing laser $E_{m}$ with a Gaussian radius of $w_{m} \approx 10 \mu \mathrm{m}$, at $\lambda_{m}=1064 \mathrm{~nm}$ and with power $P_{m} \approx 1 \mathrm{~W}$, is turned on. This leads to Stark shift $\delta \omega_{e g} \propto\left|E_{m}\right|^{2}$ of about $6 \mathrm{MHz}$. The shift is clearly seen in Fig. $5 \mathrm{~b}$ with the $\varphi_{A}$ images.

Taking a closer look at Fig. 5b, since the dressing beam is not uniform, the 3D-distributed samples experience slightly different $\delta \omega_{e g}$ shifts. In Fig. $5 \mathrm{c}$ we plot $\bar{\beta}=\arg \left(\bar{\varphi}_{A}\right)$ for three samples, labeled as (2), (4), (7) in Fig. 5b. For the convenience of display, we encode the sample index with the degree of transparency for the $\bar{\beta}$ curves. We clearly see that while in absence of dressing the $\bar{\beta}$ curves closely overlap (the red curves), the three $\bar{\beta}$ curves disperse apart when $E_{m}$ is on (blue curves). The difference is most pronounced near the shifted $\omega_{e g}$ center, with $\Delta / 2 \pi \approx 6 \mathrm{MHz}$, where $\bar{\beta}$ regains the highest $\Delta$-sensitivity of $\partial_{\Delta} \beta \sim 2 / \Gamma$ according to Eq. (18). By analyzing the spectra for all samples, we are able to resolve $\delta \omega_{e g}$ in 3D with micro-meter resolution. The spatialdependent light shift is most conveniently displayed in the $x-z$ plane where the dressing beam is in focus. For the purpose, the vertical view of $\Delta \omega_{e g}$ is plotted in Fig. 5 d for our eleven samples with significant $\left|\varphi_{A}\right|$.

The field-sensing capacity demonstrated in this section shares the same frequency resolution with that is discussed in the last section. In particular, according to Eq. (18) near the shifted $\omega_{e g}$ resonance, we again have $\Delta\left(\delta \omega_{e g}\right) / 2 \pi \approx 100 \mathrm{kHz}$. We emphasize this resolution is achieved by $\sim 10^{2}$ atoms within $\tau_{p}=20 \mu \mathrm{s}$, with micronsized $3 \mathrm{D}$ resolution.
![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-10.jpg?height=298&width=858&top_left_y=282&top_left_x=1099)

(c)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-10.jpg?height=271&width=333&top_left_y=594&top_left_x=1140)

(d)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-10.jpg?height=271&width=377&top_left_y=583&top_left_x=1557)

FIG. 5. Sensing light shifts with a sparse array of laser-cooled atoms. (a): Experimental setup and the level diagram. (b): $\bar{z}_{A}$-projected $\varphi_{A}$-images of the axially displaced samples, with and without $E_{m}$. The data are processed from $\delta I$ averaged over 9 exposures to enhance the display. The probe detuning is $\Delta / 2 \pi=0 \mathrm{MHz}$. (c): $\hat{P}_{A}$-averaged phase angle spectra of "2,4,7" samples marked in (b). The red (blue) curves are for $E_{m}$ off (on). The transparency levels are according to the markers in (b). (d): $x-z$ "top" view of the light shift distribution. The 11 largest- $|\varphi|$ samples are represented by blue disks. The dash-lined circle suggests the estimated $E_{m}$ full-width-half-maximum focal spot in the $x-z$ plane.

## IV. DISCUSSIONS

## A. Aberrations

So far, our holographic imaging scheme assumes aberration-free propagation of $E_{r}, E_{s}$ between the sample plane $z_{A}$ and hologram plane $z_{H}$. Practically, the $E_{r, s}$ wavefronts need to be optically relayed from the ultrahigh vacuum to the place where the digital camera sensor conveniently locates. For high-NA imaging, aberration becomes unavoidable when the required volumeof-view is large.

To describe the imperfect imaging, we consider both $E_{r}$ and $E_{s}$ as in Fig. 1a to be relayed from inside the ultrahigh vacuum where the actual light-atom interaction takes place. We use a wavefront propagator $U_{\mathrm{img}}$ to generally represent the linear transformation of wavefronts from the in-situ $z=z_{V, A}$ to $z=z_{A}$,

$$
\begin{align*}
& E_{r}\left(x, y, z_{A}\right)=U_{\mathrm{img}} E_{r}\left(x_{V}, y_{V}, z_{V, A}\right)  \tag{19}\\
& E_{s}\left(x, y, z_{A}\right)=U_{\mathrm{img}} E_{s}\left(x_{V}, y_{V}, z_{V, A}\right)
\end{align*}
$$

For imperfect imaging, the fundamental way to eliminate the associated imaging errors is to fully characterize the propagator $U_{\text {img }}$. Then, by resolving $E_{r, s}\left(z_{V, A}\right)$ through Eq. (19) to apply our prior knowledge about the
samples in situ. Practically, even with advanced computing power, the modeling of diffraction-limited $E_{r}, E_{s}$ propagation across the large-diameter lens-array can still be prohibitively resource-demanding. On the other hand, the wavefront propagation is greatly simplified by Gaussian decomposition [32-34]. The well-developed technique is naturally adapted to the Gaussian-assisted holography scheme in this work to potentially enable aberration-free imaging of sparse samples over unprecedentedly large imaging volumes, only limited by the finest hologram fringes that can be captured by the camera [68].

To fully characterize $U_{\text {img }}$ for the large-diameter lensarrays [73, 74], and to invert Eq. (19) with Gaussiandecomposition, are all beyond the scope of this work. Instead, we take advantage of the small volume-of-view (Fig. 2) to address minor, aplanatic aberrations. This is achieved by employing a point-spread function [43] $O(x, y)$ through in situ optical measurements. The procedure is detailed in Appendix D 3.

## B. Speckles

In addition to aberrations, the imaging optics may introduce speckle noise into the wavefronts through multiple reflections and even by small dusk particles on the optical surfaces. Since the probe beam for atomic spectroscopy is highly monochromatic, the speckle noises are difficult to avoid.

We denote $\delta E_{r}$ and $\delta E_{s}$ to be speckle fields generated by unwanted reflections and scatterings across the imaging optical path. We assume that the perturbations are static enough for their precise characterization through multiple measurements. With GerchbergSaxton iterations [18], $\delta E_{r}$ is fully characterized in this work (Fig. 1b). When speckle noises in $E_{r, s}$ are moderate, as in this work, their presence hardly affect our prior knowledge about $\varphi_{A}$ for the $E_{s}$ retrieval (Sec. II). But the presence of $\delta E_{r}$ does affect the $\varphi_{A}$ retrieval with Eqs. (2), particularly since substantial amount of the speckle noises $\delta E_{r}$ may be generated by imaging optics after the light-atom interaction, not "seen" by atoms at $z=z_{A}$. To minimize the $\delta E_{r}$ impact, one should locate the sources of $\delta E_{r}$ with digital propagation of $E_{r}$, and by removing the speckles to recover the actual $E_{r}$ attending the light-atom interaction. The process of characterizing the speckle sources across the imaging path is therefore similar to characterizing $U_{\text {img }}$ discussed above. If all the speckle scatterings in $\delta E_{r, s}$ are static enough, the procedure would help to fully suppress the associated noises in the $\varphi_{A}$ retrieval.

In this work, we take a simpler approach to approximately suppress the speckle noise to the complex-valued spectroscopic imaging. In particular, during the Eq. (2) evaluation of $\varphi_{A}$, we simply filter away the apparent speckles from $E_{r}$. This is achieved by digitally focusing $E_{r}$ back to $z=0$ and only choose a small region around the diffraction-limited component, before propa- gating forward to $z=z_{A}$ for the $\varphi_{A}$ evaluation. In other words, we assumes $E_{r}$ "seen" by atoms is speckle-less, which is a good approximation in our setup, considering that comparing to the multiple-stage-relayed largediameter imaging optics, the $E_{r}$ is focused to atomic samples with simpler, smaller-diameter optics [73].

## C. Summary

From precision spectroscopy $[61,62,78]$ to quantum simulation [79], precise optical imaging [80-82] is crucially important for advancing ultracold atomic physics research at frontiers. The prevailing imaging method in these researches is to directly record fluorescence $[80,81$, 83, 84], absorption [17, 85], and phase shift [20]. While holographic imaging techniques are rapidly developing for applications in other fields [59, 67, 86, 87], their utilities in atomic physics are rare [18, 30, 40-43]. In Sec. IB we highlighted major challenges of quantitative holographic imaging for precision spectroscopic measurements of cold atoms. In Sec. I C 1 we provided arguments that the $3 \mathrm{~dB}$ information loss in holographic measurements hardly make them disadvantageous when comparing to direct imaging. If the challenges can be addressed, then, by extending the spectroscopy data to complex numbers and by enabling 3D resolution, the holographic method would help to unlock highly exciting opportunities associated with precise spectroscopic imaging and sensing on strong optical transitions.

In this work, motivated by the exciting prospect of complex-valued 3D spectroscopic imaging, we develop a systematic approach to address key challenges in holographic imaging of cold atoms (Sec. IB). Comparing with e.g. biological applications [46, 88], our choices of schemes and diversities in holographic measurements are severely constrained by aspects of cold-atom setups. Our philosophy is to fully characterize the imaging setup and to efficiently utilize all the available knowledge from single-shot inline holography. The efficient application of prior knowledge is numerically assisted by Gaussian beam propagation, a simple application of the well-established Gaussian-decomposition technique [3234, 89, 90]. With the method, we have demonstrated complex-valued spectroscopic imaging of axially displaced microscopic ${ }^{87} \mathrm{Rb}$ samples in a sparse lattice, with micrometer 3D resolution. We achieve hundred-kHz-level single-shot frequency resolution out of the $\Gamma / 2 \pi=6 \mathrm{MHz}$ natural linewidth, with merely hundreds of atoms, a result that appears extremely difficult to realize with traditional spectroscopy $[1,62]$, in presence of atom number and interaction strength uncertainties.

Not discussed in this paper is the observation of atomic shot noise [17, 43], which is barely supported by but nevertheless observed with our NA $\approx 0.26$ setup. In addition, the imaging volume-of-view in this work is limited by the sample distribution itself to be within $\mathrm{a} \sim 100 \mu \mathrm{m}$ distance (Also see Appendix E). We clar-
ified in Sec. IV A that the technique can be extended to fully suppress wavefront aberrations for wide-field $3 \mathrm{D}$ imaging [91] of sparse atomic samples. The development may enable wideband, spectroscopic sensing of $3 \mathrm{D}$ potentials $[15,92]$ with unprecedented volume-of-view. Other than probing single-atom spectroscopic responses, our method also supports the study of resonant dipole interactions by simultaneously measuring the strength, direction and phase angle of the collective emission [25, 93]. As such, we also expect the complex-valued spectroscopic imaging method to facilitate efficient characterization and quantum engineering of advanced light-atom interfaces $[78,94-97]$.

## ACKNOWLEDGEMENTS

We thank Professor Haidong Yuan for helpful discussions and suggestions. We acknowledge support from National Key Research Program of China under Grant No. 2022YFA1404204, from NSFC under Grant No. 12074083, and from the Original Research Initiative at Fudan University.

## Appendix A: Cramer-Rao bounds to position and phase localization by inline holography

In this section, we consider the estimation of bulk properties of the atomic sample from the hologram $I, I^{\prime}$ specified in Eq. (3). The basic setup is illustrated in Fig. 1a. The bulk properties of interest include the $3 \mathrm{D}$ atomic central locations $\mathbf{r}_{A}=\left\{x_{A}, y_{A}, z_{A}\right\}$ and the total amplitude of the forward scattering $E_{s}$. To facilitate the derivations, we introduce five $\left\{\theta_{j}\right\}=\left\{x_{A}, y_{A}, z_{A}, \beta_{r, \text { off }}, \beta_{i, \text { off }}\right\}$ parameters. The last two parameters are the real and imaginary parts of an auxiliary complex phase offset in

$$
\begin{equation*}
\tilde{E}_{s}=e^{i \beta_{\text {off }}} \hat{U}\left(z_{H}-z_{A}\right)\left(E_{r}\left(z_{A}\right)\left(e^{i \varphi_{A}}-1\right)\right) \tag{A1}
\end{equation*}
$$

For example, with $\left|\varphi_{A}\right| \ll 1$, then $\beta_{r, \text { off }}$ offsets our estimation to phase-angle $\beta=\arg \left[\varphi_{A}\right]$, and $\beta_{i, \text { off }}$ offsets $\left|\varphi_{A}\right|$.

The hologram $I$ is accordingly re-modeled as

$$
\begin{equation*}
\tilde{I}=\left|E_{r}\left(z_{H}\right)+\tilde{E}_{s}\right|^{2} \tag{A2}
\end{equation*}
$$

so that $I^{\prime}=\left.\tilde{I}\right|_{\beta_{\text {off }} \rightarrow 0}$. We regard $p(x, y)=$ $\tilde{I}(x, y) / \sum_{x, y} \tilde{I}(x, y)$ as a $2 \mathrm{D}$ probability distribution of a single photon received by the camera. The Fisher information matrix is accordingly expressed as

$$
\begin{align*}
F_{j k}^{(0)} & \equiv\left(\sum_{x, y} \frac{1}{p(x, y)} \partial_{\theta_{j}} p(x, y) \partial_{\theta_{k}} p(x, y)\right)_{\beta_{\mathrm{off} \rightarrow 0}} \\
& \approx\left(\frac{\sum_{x, y} \frac{1}{\tilde{I}(x, y)} \partial_{\theta_{j}} \tilde{I}(x, y) \partial_{\theta_{k}} \tilde{I}(x, y)}{\sum_{x, y} \tilde{I}(x, y)}\right)_{\beta_{\mathrm{off}} \rightarrow 0} \tag{A3}
\end{align*}
$$

In the second line of Eq. (A3) we assumed the total flux $\sum_{x, y} \tilde{I}(x, y)$ received by the camera to be $\theta_{j}$-independent, which is sufficiently satisfied for moderately-dense atomic samples in the defocused-twin regime (Appendix C 1) with $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$ (Fig. 1a), so that $\left|E_{s}\right| \ll\left|E_{r}\right|$ on the camera plane as to be assumed in the following. With $\partial_{\theta_{j}} \tilde{I} \partial_{\theta_{k}} \tilde{I} \approx\left|E_{r}\right|^{2}\left(\partial_{\theta_{j}} \tilde{E}_{s}^{*} \partial_{\theta_{k}} \tilde{E}_{s}+\right.$ c.c) $+\left(E_{r}^{* 2} \partial_{\theta_{j}} \tilde{E}_{s} \partial_{\theta_{k}} \tilde{E}_{s}+\right.$ c.c. $)$, the second term also vanishes upon the 2D integration, due to the substantial wavefront mismatch between $E_{r}$ and $E_{s}$. Equation (A3) is accordingly simplified into

$$
\begin{equation*}
F_{j k}^{(0)} \approx \frac{\sum_{x, y}\left(\partial_{\theta_{j}} \tilde{E}_{s}^{*} \partial_{\theta_{k}} \tilde{E}_{s}+\text { c.c. }\right)_{\beta_{\mathrm{off}} \rightarrow 0}}{\sum_{x, y}\left|E_{r}\right|^{2}} \tag{A4}
\end{equation*}
$$

The Fisher information matrix by Eq. (A4) is associated with single-photon detection on the camera. For imaging cold atoms, we are more interested in Fisher information associated with photons scattered by the samples [98]. A change of normalization leads to

$$
\begin{equation*}
F_{j k}=\left(\frac{\sum_{x, y} \partial_{\theta_{j}} \tilde{E}_{s}^{*} \partial_{\theta_{k}} \tilde{E}_{s}+c . c .}{\sum_{x, y}\left|\tilde{E}_{s}\right|^{2}}\right)_{\beta_{\mathrm{off} \rightarrow 0}} \tag{A5}
\end{equation*}
$$

Interestingly, Eq. (A5) suggests Fisher information for holographic measurements upon a single $E_{s}$-photon detection is equal to half of the quantum Fisher information [35] for the $E_{s}$-photon wavepacket. This $50 \%$ loss of information is generally associated with heterodying measurements $[30]$.

From a single photon wavepacket to $N_{s}=\sum_{x, y}\left|E_{s}\right|^{2}$ photons detected by the camera in an uncorrelated manner, we have $F_{j k}\left(N_{s}\right)=N_{s} F_{j k}$ according to Eq. (A5) to limit the resolutions of $\left\{\theta_{j}\right\}$ measurements with the associated Cramer-Rao bounds. With Eq. (A1), evaluation of Eq. (A5) for the $\beta_{r, \text { off }}, \beta_{i, \text { off }}$ differentiation is straightforward. With the free-space propagator $\hat{U}\left(z_{H}-z_{A}\right)$ by Eq. (D1) to be $x_{A}, y_{A}$ independent, the translational invariance suggests

$$
\begin{align*}
& \partial_{x_{A}} \tilde{E}_{s}=-\partial_{x} \tilde{E}_{s} \\
& \partial_{y_{A}} \tilde{E}_{s}=-\partial_{y} \tilde{E}_{s} \tag{A6}
\end{align*}
$$

For the differentiation of the $z_{A}$-parameter in Eq. (A5), we rewrite

$$
\begin{equation*}
\tilde{E}_{s}=e^{i \beta_{\mathrm{off}}} \hat{U}\left(z_{H}-z_{A}\right)\left(\left(\hat{U}\left(z_{A}\right) E_{r}(0)\right)\left(e^{i \varphi_{A}}-1\right)\right) \tag{A7}
\end{equation*}
$$

Here the first propagator $\hat{U}\left(z_{H}-z_{A}\right)$ acts on $E_{s}\left(z_{A}\right)=$ $E_{r}\left(z_{A}\right)\left(e^{i \varphi_{A}}-1\right)$. The second $\hat{U}\left(z_{A}\right)$ acts on $E_{r}(0)$ only. In the $z_{\sigma} \ll z_{A}$ (Fig. 1a) limit, the $E_{r}\left(z_{A}\right)$ "seen" by the $\sigma$-sized atomic sample can be approximated by plane wave. For on-axis samples we therefore find

$$
\begin{equation*}
\partial_{z_{A}} \tilde{E}_{s} \approx i\left(-\sqrt{k_{0}^{2}+\partial_{x}^{2}+\partial_{y}^{2}}+k_{0}\right) \tilde{E}_{s} \tag{A8}
\end{equation*}
$$

With Eqs. (A1)(A6)(A8), evaluation of Eq. (A5) becomes straightforward for specific imaging setup, $E_{r}$-illumination, and atomic samples. To provide the Cramer-Rao bounds with a simple example, in the following we consider $E_{r}$ to propagate along the $z$-axis, $E_{s}\left(z_{A}\right)$ to be the forward scattering by a Gaussian shaped sample located on the $z$-axis with a density distribution of $\rho_{c}=\rho_{0} e^{-\left(x^{2}+y^{2}\right) / \sigma^{2}}$. We assume $\varphi_{A}=k_{0} \rho_{c} \alpha(\omega) \ll 1$ so that the $E_{s}$ amplitude simply follows the $\rho_{c}$ profile, while $\sigma>\lambda / \mathrm{NA}$ so that $E_{s}$ is almost fully captured by the camera. By normalizing $x_{A}, y_{A}$ with $\sigma$, and $z_{A}$ with $z_{\sigma}$, the rescaled Fisher information matrix with $N_{s}$ scattered-photon detection is

$$
F\left(N_{s}\right)=N_{s}\left[\begin{array}{lllll}
2 & 0 & 0 & 0 & 0  \tag{A9}\\
0 & 2 & 0 & 0 & 0 \\
0 & 0 & 1 & 1 & 0 \\
0 & 0 & 1 & 2 & 0 \\
0 & 0 & 0 & 0 & 2
\end{array}\right]
$$

Clearly, while $x_{A}, y_{A}$ and $\beta_{i \text {,off }}$ measurements are independent, the axial position $z_{A}$ is correlated with the phase angle $\beta_{r, \text { off }}$. By diagonalizing Eq. (A9) and evaluate the Cramer-Rao bounds indirectly using the eigenvector observables, one finds that in the $\varphi_{A} \ll 1$ opticallythin-sample limit,

$$
\begin{align*}
\Delta x_{A} & =\sigma / \sqrt{2 N_{s}} \\
\Delta y_{A} & =\sigma / \sqrt{2 N_{s}} \\
\Delta z_{A} & =z_{\sigma} / \sqrt{N_{s} / 2}  \tag{A10}\\
\Delta \beta & =1 / \sqrt{N_{s}} \\
\Delta\left|\varphi_{A}\right| & =1 / \sqrt{2 N_{s}}
\end{align*}
$$

The axial resolution $\Delta z_{A}$ can be enhanced to $\Delta z_{A}=$ $z_{\sigma} / \sqrt{N_{s}}$ limit (Eq. (8)) [19] by taking multiple spectroscopic measurements to fix $\beta$ first. On the other hand, with the axial position $z_{A}$ fixed, the phase angle resolution for the sample is enhanced to $\Delta \beta=1 / \sqrt{2 N_{s}}$ (Eq. (9)) $[18]$.

## Appendix B: Details of Gaussian decomposition

## 1. Gaussian beam

Gaussian decomposition is associated with a class of powerful semi-classical wave-propagation techniques [3234, 89, 90]. We focus on the free Gaussian-propagation to support evaluation of $E_{r}, E_{s}$ across $z$-planes during the minimization of $\mathcal{L}_{\text {tot }}$ in Eq. (10).

The standard form of a Gaussian beam is expressed as

$$
\begin{equation*}
G_{z}\left(\mathbf{r} ; \mathbf{P}^{\prime}\right)=e^{i\left(\mathbf{r}_{\perp}-\mathbf{r}_{\perp}^{0}\right)^{T} \frac{k_{0}}{2 \mathbf{q}(z)}\left(\mathbf{r}_{\perp}-\mathbf{r}_{\perp}^{0}\right)+i k_{0} z+i \varphi_{G}(z)} \tag{B1}
\end{equation*}
$$

Here $\mathbf{r}_{\perp}=(x, y)^{T}$. The complex $\mathbf{q}(z)$-parameter is defined by

$$
\frac{1}{\mathbf{q}(z)}=\left[\begin{array}{cc}
\frac{1}{R_{x}}+i \frac{2}{k_{0} w_{x}^{2}} & 0  \tag{B2}\\
0 & \frac{1}{R_{y}}+i \frac{2}{k_{0} w_{y}^{2}}
\end{array}\right]
$$

with

$$
\begin{align*}
& w_{c}(z)=w_{c}^{0} \sqrt{1+\frac{\left(z-z_{c}^{0}\right)^{2}}{\left(z_{c}^{R}\right)^{2}}}  \tag{B3}\\
& R_{c}(z)=z-z_{c}^{0}+\frac{\left(z_{c}^{\mathrm{R}}\right)^{2}}{z-z_{c}^{0}}
\end{align*}
$$

all decided by the Gaussian waists $w_{c}^{0}$ for $c=x, y$. The Gouy phase $\varphi_{G}(z)$ is given by

$$
\begin{equation*}
\varphi_{G}(z)=\frac{1}{2} \sum_{c=x, y} \arctan \left(\left(z-z_{c}^{0}\right) / z_{c}^{R}\right) \tag{B4}
\end{equation*}
$$

The Rayleigh lengths are defined as

$$
\begin{equation*}
z_{c}^{\mathrm{R}}=\pi\left(w_{c}^{0}\right)^{2} / \lambda \tag{B5}
\end{equation*}
$$

for $c=x, y$.

Next, we introduce a rotation matrix $\mathcal{R}(\gamma)$ with Euler angles $\gamma=\left(\theta_{1}, \theta_{2}, \theta_{3}\right)$, so that $\mathbf{k}=\left(0,0, k_{0}\right) \mathcal{R}(\gamma)$ is expressed as

$$
\begin{equation*}
\mathbf{k}=\left(-\sin \theta_{2}, \sin \theta_{1} \cos \theta_{2}, \cos \theta_{1} \cos \theta_{2}\right) k_{0} \tag{B6}
\end{equation*}
$$

The rotation angle $\theta_{3}$ orients the principal axis of the $2 \mathrm{D}$ Gaussian profile. With $\mathbf{r}=(x, y, z)^{T}$, we have

$$
\begin{equation*}
G(\mathbf{r} ; \mathbf{P})=G_{z}\left(\mathcal{R}^{T}(\gamma) \mathbf{r} ; \mathbf{P}^{\prime}\right) \tag{B7}
\end{equation*}
$$

Overall, with $\mathbf{P}=\left\{\gamma, \mathbf{P}^{\prime}\right\}$, there are a total number of nine parameters $\mathbf{P}=\left\{\theta_{1}, \theta_{2}, \theta_{3}, x^{0}, y^{0}, z_{x}^{0}, z_{y}^{0}, w_{x}^{0}, w_{y}^{0}\right\}$ for a 2D Gaussian beam. To decompose a wavefront into $n_{A}$ beams as in Eq. (7) involves a total number of $11 \times n_{A}$ real parameters $\left\{c_{j}, \mathbf{P}_{j}\right\}$.

## 2. Implementing the sample constraints

For a single sample as in Fig. 1 as well as multiple samples, our prior knowledge about the sample can often be formulated into a list of cost-functions $C_{\mu}$ to constrain the expected 2D complex-valued phase shift distribution, $\varphi\left(z_{A}\right)=\varphi_{A}$. The constraints help to fix the phase-ambiguity associated with $E_{s, \text { twin }}$ while locating the sample planes at $z=z_{A}$. In the following we provide examples of such $C_{\mu}$-constraints, generalized for multiple samples.

## a. Finite spatial support

The prior knowledge on the regime of interest where the atomic samples should be constrained within, as schematically illustrated in Fig. 1c with $\hat{P}_{A}$, is a condition commonly applied for coherent imaging [29, 30, 58, 99]. Here, for multiple atomic samples, the constraint can be formulated as a request to minimize the cost function,

$$
\begin{equation*}
C_{\mu}=\sum_{A} \frac{1}{\mathcal{N}_{A}} \sum_{x, y}\left|\varphi\left(z_{A}\right)-\hat{P}_{A}\left(\varphi\left(z_{A}\right)\right)\right|^{2} \tag{B8}
\end{equation*}
$$

Here $\mathcal{N}_{A}=\sum_{x, y}\left|\hat{P}_{A}\left(\varphi\left(z_{A}\right)\right)\right|^{2}$ normalizes the error signal from each sample at the respective $z=z_{A}$.

## b. Known phase angle

As being outlined in Sec. I and discussed in Sec. II D, for complex-valued atomic spectroscopy of a dilute gas, the phase angle $\beta=\arg \left(\varphi_{A}\right)$ is often decided by the polarizability of single constituent atoms, $\beta_{0}=\arg (\alpha)$, and is therefore precisely known. The knowledge can be applied to constrain the $\left\langle E_{s}\right\rangle_{G}$-search by minimizing

$$
\begin{equation*}
C_{\mu}=\sum_{A} \frac{1}{\mathcal{N}_{A}} \hat{P}_{A} \sum_{x, y}\left|\operatorname{Im}\left[\varphi\left(z_{A}\right) e^{-i \beta_{0}}\right]\right|^{2} \tag{B9}
\end{equation*}
$$

That is, by unwrapping the known phase angle $\beta_{0}$ from the complex-valued phase shift, $\varphi_{A} e^{-i \beta_{0}}$ should be real, with vanishing imaginary component across each sample.

The Eq. (B9)-minimization is a generalization to previous phase angle constraints in holographic microscopy, such as positive attenuation criterion [60] and phase object criterion [42]. Application of Eq. (B9) requires the phase angle $\beta=\beta_{0}$ as precise prior knowledge. Practically, $\beta_{0}$ can be obtained by pre-characterization of standard samples first [19]. In particular, for free atoms, $\beta_{0}(\Delta)$ can be fixed by exploiting the Eq. (18) relation across the atomic resonance under study first (during which the axial location $z_{A}$ for the standard samples are fixed too, as in Sec. III B 1).

## c. Phase-angle uniformity

Without the precise $\beta_{0}$ knowledge, one still can exploit prior knowledge on $\beta$ in holography. A common situation is that the atomic sample is monomorphous [41], with a uniform albeit not-precisely-known $\beta=\arg \left(\varphi_{A}\right)$ across the sample. The condition can be formulated as to minimize

$$
\begin{equation*}
C_{\mu}=\sum_{A} \frac{1}{\mathcal{N}_{A}} \hat{P}_{A}\left(\left|\sum_{x, y} \varphi\left(z_{A}\right)\right|-\sum_{x, y}\left|\varphi\left(z_{A}\right)\right|\right)^{2} \tag{B10}
\end{equation*}
$$

## d. Other types of constraints

Beyond the simple examples by Eqs. (B8)(B9)(B10), more sophisticated form of prior knowledge about the samples can be applied to tailor the cost functions $C_{\mu}(\varphi)$. For example, the finite support in Eq. (B8) can be replaced by a continuously varying $\hat{P}_{A}$ according to our expectation of the sample shape. Similar strategies can be applied to soften the $\beta_{0}$ bounds in Eq. (B9) [60]. Other cost functions may be tailored to encourage the $\varphi\left(z_{A}\right)$ distribution meeting our expectation of a mixed spatialspectral characteristics, such as for atomic samples confined by a dipole trap [100].

## 3. Direct constraints

## a. Direct constraints to Gaussian parameters

Instead of formulating $C_{\mu}$ cost functions, simple knowledge about the sample can also be applied as direct constraints to the Gaussian parameters. For example, the finite spatial support in Eq. (B8) can be effectively enforced by limiting the range of $\mathbf{r}_{A}$ and $w_{x}\left(z_{A}\right), w_{y}\left(z_{A}\right)$ parameters (Eq. (B7)). As another example, in the $\left|\varphi\left(z_{A}\right)\right| \ll 1$ weak scattering limit the phase-angle relation by Eq. (B10) effectively enforce the wavefront radii of curvature $R_{x}\left(z_{A}\right), R_{y}\left(z_{A}\right)$ to follow the $\left\langle E_{r}\right\rangle_{G}$ values.

## b. Wavefront templates

Direct constraints to groups of Gaussian parameters become particularly useful when the $E_{s}$ is expected to be characterized by certain wavefront template. Examples include synthesizing the point-spread-functions of highNA microscopes [101], or for finely matching the expected shape of an interacting degenerate gas [102]. To form the template, the Gaussian-decomposition of the wavefront template is generally expressed as

$$
\begin{equation*}
\tilde{G}_{\text {template }}(\mathbf{r})=\sum_{g} c_{g} G\left(\mathbf{r} ; \mathbf{P}_{g}\right) \tag{B11}
\end{equation*}
$$

The $\tilde{G}_{\text {template }}$ with correlated Gaussian parameters $\left\{c_{g}, \mathbf{P}_{g}\right\}$ then enters the $\mathcal{L}_{\text {tot }}$-minimization, together with other individual Gaussian beams if necessary.

## c. Beyond paraxial

Finally, the Gaussian propagation by Eq. (B2) is based on paraxial approximation which limits the propagation distance $L$ to $L \ll\left(z_{c}^{R}\right)^{2} / \lambda$. To enhance the distance of faithful propagation, any Gaussian beam that is tightly focused around $z=z_{A}$ can be expanded into a superposition of weakly focused Gaussians according to Eqs. (B7)(B11).

## Appendix C: Out-of-focus effects

## 1. Defocused-twin regime

In the Fig. 1a inline setup with the spherical $E_{r}$ illumination, the twin-image $E_{s, \text { twin }}$ (Eq. (5)) is paraxially focused to $z=z_{\text {twin }}$. With $z_{\sigma} \ll z_{A}, z_{H}-z_{A}$, the $E_{s, \text { twin }}$ is sufficiently defocused at $z=z_{A}$. In absence of imaging noise, isolation of $E_{s}$ from $E_{s, \text { twin }}$ becomes possible by limiting the $E_{s}$ location $\hat{P}_{A}$ with tight enough size of order $\sigma$ [58]. We refer this inline holography regime that supports simple twin-image removal as "defocused-twin
(a)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-15.jpg?height=326&width=442&top_left_y=192&top_left_x=188)

(c) $S_{\left\langle E_{s}\right\rangle_{G}}=\left|\left\langle E_{s} \mid\left\langle E_{s}\right\rangle_{G}\right\rangle\right| \log _{10}(1-S)$

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-15.jpg?height=298&width=387&top_left_y=550&top_left_x=186)

(b)
![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-15.jpg?height=650&width=402&top_left_y=198&top_left_x=644)

FIG. 6. (a): Schematic diagram of the geometric relation between image and twin image when $z_{A}<z_{H} / 2$. The $\Delta E_{s}{ }^{*}$ is a mirror-image of $\Delta E_{s}$ at the other side of the holographic plane $z_{H}$. For spherical $E_{r}$, the $E_{r} / E_{r}{ }^{*}$ term acts as a numerical lens with a focal length $f=z_{H} / 2$. (b): The critical Gaussian beam size $w_{t}$ as a function of $z_{A}$ and $z_{H}-z_{A}$. (c): Fidelity of reconstructing $E_{s}$ using the Gaussian $E_{G}$ (Eq. (7)) approximations (Eq. (C5)). Here the simulated $E_{s}$ follows a Gaussian profile with pixel-wise, Poissoinian atomic shot noise. The atom number is set to be 3500 in the simulation. The plot is averaged over $16 E_{s}$ simulations. The red line sets the critical Gaussian $w_{t}$. A typical numerically generated $E_{s}$ from such a sample is given in the inset. (d): Fidelity plot similar to (c) but with $\left\langle E_{s}\right\rangle_{G}$ replaced by $\tilde{E}_{s}$ (Eq. (16)) to substantially improve the accuracy.

regime". In the following we exploit Gaussian optics to derive a characteristic Gaussian width $w_{t}$, as a function of $z_{A}$ and $z_{H}-z_{A}$, that sets the boundary of this regime for imaging small samples.

We consider that in the Fig. 1a setup the numerical reconstruction of certain $E_{s}$ is contaminated by an error term $\Delta E_{s}$, which is itself a Gaussian beam with complex radius of curvature $q=\frac{1}{a+i b}$ at $z=z_{A}$. Within the paraxial approximation, the twin image, expressed as $\Delta E_{s, \text { twin }}=\Delta E_{s}^{*} E_{r} / E_{r}^{*}$ at the camera plane $z=z_{H}$, is also a Gaussian. We evaluate the twin profile $\Delta E_{s, \text { twin }}$ at $z=z_{A}$ in four steps: propagation $\Delta E_{s}$ to $z_{H}$ plane; taking the complex conjugation; passing through an ideal thin lens with a focal length of $z_{H} / 2$; and propagating to $z=z_{A}$ plane. The complex curvature of the $\Delta E_{s, \text { twin }}$ at $z=z_{A}$ is given by:

$$
\begin{equation*}
q_{\text {twin }}=\frac{q\left(2 z_{A}-z_{H}\right)+2 z_{A}\left(z_{H}-z_{A}\right)}{2 z_{A}-z_{H}-2 q} \tag{C1}
\end{equation*}
$$

Now, if $\left|\Delta E_{s}\right| \ll\left|E_{r}\right|$, then it is easy to show that the artifact field $E_{\text {arti }}=\left(\Delta E_{s}-\Delta E_{s}^{*} E_{r} / E_{r}^{*}\right)$ can be added freely to $E_{s}$ without affecting the expected hologram $I_{e}=\left|E_{r}+E_{s}\right|^{2}$. In other words, if the hologram data $\left(I, I^{\prime}\right)$ and $E_{r}$ are all the prior knowledge we have, then the $E_{\text {arti }}$ term is free to contaminate $E_{s}$ during its recon-

struction. However, if $\hat{P}_{A}$ has a width that is smaller than the smallest possible $E_{\text {arti }}\left(z_{A}\right)$, then all the artifacts $E_{\text {arti }}$ can be excluded. Here, the minimal width of $E_{\text {arti }}\left(z_{A}\right)$ associated with the Gaussian $\Delta E_{s}$ and $\Delta E_{s, \text { twin }}$ is set by equating their widths at $z=z_{A}$, that is, by equating the imaginary parts of $1 / q$ and $1 / q_{\text {twin }}$. We obtain

$$
\begin{equation*}
b^{2}=-a^{2}-\frac{2 z_{A}-z_{H}}{z_{A}\left(z_{H}-z_{A}\right)} a+\frac{1}{z_{A}\left(z_{H}-z_{A}\right)} \tag{C2}
\end{equation*}
$$

Next, by maximizing $b^{2}$ (see Eq. (B2)), we obtain the minimal $E_{\text {arti }}$ width

$$
\begin{equation*}
w_{t}=\sqrt{\frac{2 \lambda z_{A}\left(z_{H}-z_{A}\right)}{\pi z_{H}}} \tag{C3}
\end{equation*}
$$

Typical $w_{t}$ according to Eq. (C3) is given in Fig. 6b. With Eq. (C3), the defocused-twin condition $z_{\sigma} \ll$ $z_{A}, z_{H}-z_{A}$ is also expressed as $\sigma \ll w_{t}$. With $\sigma=\eta w_{t}$ and $\eta \ll 1$, the hologram $\delta I$ contains sufficient information to recover the Gaussian shaped $E_{s}$ without requiring additional prior knowledge. Furthermore, by converting $\left\langle E_{s}\right\rangle_{G}$ into its twin, $\left\langle E_{s, \text { twin }}\right\rangle_{G}=\left(\frac{E_{r}}{E_{r}^{*}}\left\langle E_{s}\right\rangle_{G}^{*}\right)_{z=z_{H}}$, its contribution to $\delta I$ is subtracted away as in Eq. (13). The high-spatial-frequency twin-image residual spreads out at $z=z_{A}$ with a width that is at least $w_{t} / \eta$. Its impact to $E_{s}$ is therefore limited by $R \eta^{2}$ at least. Here $R \ll 1$ is the fractional residual of the Gaussian fit to $E_{s}$. As in the Fig. 6d example, for small enough samples (e.g., $\eta \sim 0.3$ ) with good Gaussian-fits (e.g., $R<0.1$ ), the Eq. (16) approximation to $E_{s}$ can be highly accurate.

From Eq. (C3), it is also clear that for a fixed $z_{H}$ distance between the point source and the camera plane, $w_{t}$ reaches its maximum $\sqrt{\frac{\lambda z_{H}}{2 \pi}}$ at $z_{A}=z_{H} / 2$. In other words, for inline-holographic imaging of large samples under spherical wave illumination, one prefers to set $z_{A} \approx z_{H} / 2$ to maximize the recordable $E_{r}, E_{s}$ wavefront mismatch for the efficient twin-removal.

## 2. Overlapping samples

In Sec. II, our discussions of Gaussian-assisted holographic imaging exploit a single-sample example as illustrated in Fig. 1a. The procedure is then generalized in a straightforward manner to non-overlapping samples weakly displaced along $z$. Here, we more generally consider 3D distribution of samples. A necessary condition to separate $E_{s, A}$ from each sample is that the wavefronts from any two samples are orthogonal to each other,

$$
\begin{equation*}
\left\langle E_{s, A} \mid E_{s, A^{\prime}}\right\rangle=0 \tag{C4}
\end{equation*}
$$

Here the wavefront inner product is defined as

$$
\begin{equation*}
\left\langle E_{a} \mid E_{b}\right\rangle \equiv \frac{\int \mathrm{d} x \mathrm{~d} y E_{a}^{*} E_{b}}{\sqrt{\left(\int \mathrm{d} x \mathrm{~d} y\left|E_{a}\right|^{2}\right)\left(\int \mathrm{d} x \mathrm{~d} y\left|E_{b}\right|^{2}\right)}} \tag{C5}
\end{equation*}
$$

It is easy to show that the inner product is invariant along $z$, and can therefore be evaluated at any $z$-plane. For the weakly displaced samples considered in Sec. II with $\Delta z_{A, A^{\prime}} \ll z_{\sigma}, z_{\sigma^{\prime}}$, the Eq. (C4) orthogonality is guaranteed by non-overlapping samples within $z=z_{A}$, i.e., $\sqrt{\Delta x_{A, A^{\prime}}^{2}+\Delta y_{A, A^{\prime}}^{2}} \gg \sigma+\sigma^{\prime}$. Here $\sigma, \sigma^{\prime}$ are the characteristic widths of the samples at $z=z_{A}, z_{A^{\prime}}$ respectively.

On the other hand, when $E_{s, A}, E_{s, A^{\prime}}$ have substantial overlap at either $z=z_{A}$ or $z=z_{A^{\prime}}$, then the relative axial displacement must be large enough, $\Delta z_{A, A^{\prime}} \gg z_{\sigma}+z_{\sigma^{\prime}}$, to guarantee the wavefront orthogonality.

With Eq. (C4) and given sufficient additional prior knowledge about the samples, the Gaussiandecomposition of $E_{s}$ prescribed in Sec. II can be proceeded to obtain $\left\langle E_{s}\right\rangle_{G}=\sum_{A}\left\langle E_{s, A}\right\rangle_{G}$. Then, to approximately retrieve diffraction-limited $E_{s, A}$ using $\tilde{E}_{s}$ from Eq. (13), Eq. (16) is modified as

$$
\begin{align*}
\tilde{E}_{s, A} & =\tilde{E}_{s}-\sum_{A^{\prime} \neq A}\left\langle E_{s, A^{\prime}}\right\rangle_{G}  \tag{C6}\\
E_{s, A}\left(z_{A}\right) & \approx \hat{P}_{A}\left(\tilde{E}_{s, A}\left(z_{A}\right)\right)
\end{align*}
$$

Finally, Eq. (C6) can be iteratively refined, with the $\hat{P}_{A^{-}}$ support, by replacing the $\sum_{A^{\prime} \neq A}\left\langle E_{s, A^{\prime}}\right\rangle_{G}$ term in the first line with the resulting second line.

## Appendix D: Details of numerical implementation

## 1. Free propagation

In the Fig. 1a setup, we assume the wavefronts propagate freely for $z>0$. The propagation operator $\hat{U}(\Delta z)$ is conveniently written in the angular spectrum basis as

$$
\begin{equation*}
\hat{U}(\Delta z)=\mathcal{F}^{-1} e^{i \sqrt{k_{0}^{2}-k_{x}^{2}-k_{y}^{2}} \Delta z} \mathcal{F} \tag{D1}
\end{equation*}
$$

Here $\mathcal{F}=\mathcal{F}_{x, y}^{k_{x}, k_{y}}$ represents 2D Fourier transformation such that $E\left(k_{x}, k_{y}, z\right)=\mathcal{F}_{x, y}^{k_{x}, k_{y}}(E(x, y, z))$.

The free-space propagator is applied to retrieve $E_{r}^{(0)}[18]$, as well as to obtain $E_{s}\left(z_{A}\right)$ with Eq. (13) during the final step of $\varphi\left(z_{A}\right)$ reconstruction.

## 2. Nonlinear optimization

We follow an adaptive moment estimation algorithm [103] to minimize Eq. (10) in small steps. Taking advantage of the analytical Gaussian expression by Eq. (B7), we randomly sample a small fraction of $x, y$ pixels in $\delta I$ during the evaluation of $\mathcal{L}_{H}$. We find in most cases, the sparse sampling of about $1 \%$ of full data is sufficient to ensure the convergence of the nonlinear optimization. Similarly, during the evaluation of $\mathcal{L}_{A}$ associated with e.g. Eqs. (B8)(B9)(B10), we find that by evaluating $5 \%$ of pixels within $\hat{P}_{A}$ is sufficient to ensure the convergence.
To analyze a set of holograms from similar experimental measurements, the very initial guess of Gaussian parameters are obtained by fitting the Eq. (13) approximation to $E_{s}\left(z_{A}\right)$ but with $\left\langle E_{s}\right\rangle_{G}$ set to zero (the $E_{s}^{(0)}\left(\bar{z}_{A}\right)$ in Fig. 2b). Following the optimization for the first measurement, the optimal $z_{A},\left\{c_{j}, \mathbf{P}_{j}\right\}$ parameters are transferred to initialize the optimization in similar measurements. Here, it is worth noting that while the parameter transfer greatly speed up the nonlinear optimization, the method is prone to cumulative numerical errors if the nonlinear optimization does not fully converge. To verify that the results are free from the accumulative errors, we often deliberately reset a set of parameters to far-fromoptimal values during the parameter transfer.

## 3. Aberration corrections

Following Eq. (19) and for the convenience of presentation, we define the "ground-truth" fields $E_{r, s}^{(0)}\left(x, y, z_{A}\right)=$ $E_{r, s}\left(M x_{V}, M y_{V}, z_{V, A}\right)$ between a specific pair of $z_{A}, z_{V, A}$ planes, with $M$ to be the magnification factor. With $U_{0 \text {,img }}$ to represent the perfect wavefront transformation, we have

$$
\begin{align*}
& E_{r}\left(z_{A}\right)=U_{\mathrm{img}} U_{0, \mathrm{img}}^{-1} E_{r}^{(0)}\left(z_{A}\right) \\
& E_{s}\left(z_{A}\right)=U_{\mathrm{img}} U_{0, \mathrm{img}}^{-1} E_{s}^{(0)}\left(z_{A}\right) \tag{D2}
\end{align*}
$$

The key insight about aplanatic aberration correction is that for $E^{(0)}\left(x_{0}, y_{0}, z_{A}\right)$ within a small enough imaging area at the $z_{A}$-plane,

$E\left(x, y, z_{A}\right)=\int \mathrm{d} x_{0} \mathrm{~d} y_{0} E^{(0)}\left(x_{0}, y_{0}, z_{A}\right) O\left(x-x_{0}, y-y_{0}\right)$.

Here $O(x, y)$ is the complex point-spread-function of our imaging system around $\mathbf{r}_{A}=\left(x_{A}, y_{A}, z_{A}\right)$.

Experimentally, we obtain $O(x, y)$ by directly measuring $E_{r}^{\prime}$, the probe beam $E_{r}$ (Fig. 1a) with its focus translated to the sample location $\mathbf{r}_{A}$. Similar to the $E_{r}$-phase recovery in Fig. 1b, we take intensity profiles of $E_{r}^{\prime}$ at multiple planes to reconstruct the complex $E_{r}^{\prime}$-profile, using the Gerchberg-Saxton iterations [18]. By assuming $E_{r}^{\prime}$ to be diffraction-limited itself, we obtain the complex point-spread function as $O(x, y)=E_{r}^{\prime} /\left|E_{r}^{\prime}\right|_{\max }$, up to the $\mathrm{NA}=0.3$ numerical aperture [73]. Notice here $O(x, y)$ at $z=z_{A}$ can be propagated to other $z$-planes through Eq. (D1), such as to obtain $O\left(x, y, z_{H}\right)$ at the $z=z_{H}$ camera plane to correct for the wavefronts there, as long as those wavefronts can be back-focused around $\mathbf{r}_{A}$.

With $O(x, y)$ at hand, we exploit Eq. (D3) in two ways. First, during Gaussian decomposition of $E_{s}$ for atomic sample centered at $x_{A}, y_{A}$, in particular for the evaluation of Eq. (11), we simply multiply $O\left(x-x_{A}, y-y_{A}, z_{H}\right)$ to the associated $E_{G}$. In other words, at this stage we approximate the Gaussians profiles as 2-dimensional $\delta$-functions at $z=z_{A}$ and directly exploit Eq.(D3) to estimate the aberrated Gaussians at the camera plane.

Second, during the final evaluation of $E_{s}$ (Eq. (16)) and $E_{r}$ (Eq. (17)), we divide $E_{s}$ and a windowed $E_{r}$ by $O\left(k_{x}, k_{y}\right)$ in k-space. Here $E_{r}$ is selected to within an area-of-interest, with a size close to the Fig. 2 display. To minimize edge effects, a Blackman-window is applied for the $E_{r}$ selection.

Finally, we note that in our imaging system with $M \neq 1$, the simple volumetric data process is subjected to the paraxial approximation, i.e., by Taylor-expanding the $k_{x, y}$-dependent phase shift in Eq.(D1) to the second order only. This paraxial condition is well-satisfied in the experimental demonstration where the axial displacements of samples are moderate (Fig. 2).

## Appendix E: Imaging larger samples

The experimental work presented in Sec. III exploits small atomic samples distributed in 3D. Due to their regular shapes, a total number of $n_{A}=3$ Gaussians suffices the decomposition of $E_{s, A}$ for each sample. In this section, we provide an example of imaging larger, more complex samples.

As in Fig. 7a, the cigar-shaped sample is released from the $1064 \mathrm{~nm}$ dipole trap (which acts as the $E_{m}$-field in the Fig. 5 measurement). During the $\tau_{p}=20 \mu$ s imaging exposure, a "dimple trap" beam $E_{d}$ at $840 \mathrm{~nm}$ is switched on to dress the atoms with its $w \approx 10 \mu \mathrm{m}$ focal spot. Similar to the Sec. III experiment, we repeat the atomic sample preparation to take the $\left\{I, I^{\prime}\right\}$ dataset with $\Delta / 2 \pi$ scanned between $-18 \mathrm{MHz}$ and $+18 \mathrm{MHz}$. Part of the data are presented in Fig. 7. The OD-image in Fig. $7 \mathrm{~b}$ and the $\left(\Delta^{\prime}, \rho_{c}\right)$ - images in Fig. 7c are all derived from the complex $\varphi_{A}$-data reconstructed from "singleshot" $\delta I$, as following. Similar to Fig. 2, here each $\delta I$ is also averaged over nine repetitions to enhance the display. We follow the Sec. II prescription with $n_{A}=16$ for the Gaussian decomposition of $E_{s}$. There are eight Gaussians to capture the global cigar shape, and another eight Gaussians to capture the local structure around the dimple-dressing beam. We then obtain $\tilde{E}_{s}$ according to Eq. (13)and approximated $\varphi_{A}$ according to Eq. (16). In Fig. 7c at different probe detuning $\Delta$, we consistently see the local Stark-shift spot with $\delta \omega_{e g} \approx 2 \pi \times 4 \mathrm{MHz}$.

Similar to Fig. 4, we average the $\varphi_{A}$-data (not shown) over two circular Region-Of-Interest(ROI), suggested in the Fig. 7c $\left(\Delta^{\prime}, \rho_{c}\right)$ plot, to compile $\overline{\mathrm{OD}}, \bar{\phi}$ in Fig. 7(d) and $\bar{\beta}$ data in Fig. 7(e). By fitting Fig. 7(d,e) spectroscopy data for free-flying atoms with Eq. (18), the probe intensity parameter $s_{0} \approx 1.2$ and the transition linewidth $\Gamma=2 \pi \times 6.0 \mathrm{MHz}$ are extracted, which are

highly agreeable to expectations. For the Fig. 7c $\left(\Delta^{\prime}, \rho_{c}\right)$ images, the local detuning $\Delta^{\prime}=-\frac{\Gamma}{2} \tan \beta$ is derived from $\beta=\arg \left[\varphi_{A}\right]$ similar to Fig. 4. The atomic column density $\rho_{c}$ is estimated with Eq. (18) with $\xi(s)=C^{2} /(1+s)$ [72].

(a)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-17.jpg?height=296&width=296&top_left_y=476&top_left_x=1099)

(c)
![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-17.jpg?height=648&width=856&top_left_y=812&top_left_x=1102)

(d)

![](https://cdn.mathpix.com/cropped/2024_06_04_b45e7195ea5f6064e4e2g-17.jpg?height=309&width=374&top_left_y=1155&top_left_x=1580)

FIG. 7. Spectroscopic imaging of a cigar-shaped atomic sample, released from a dipole trap $\left(E_{m}\right)$, and subjected to a "dimple" $E_{d}$ dressing. (a): The Experimental setup and the level diagram. (b): Typical optical depth image, processed from $\delta I$ averaged over 9 exposures to enhance the display. Here the probe detuning is $\Delta / 2 \pi=0 \mathrm{MHz}$. (c): $\left(\Delta^{\prime}, \rho_{c}\right)$ in color domain plots. Here $\rho_{c}$ is column density, and $\Delta^{\prime}=-\frac{\Gamma}{2} \tan \beta$ is the local detuning, both derived from the complex $\varphi_{A}$-data similar to Fig. 4 a. (d): ROI- averaged $\overline{\mathrm{OD}}$ and $\bar{\phi}$ spectroscopy. The two Region-Of-Interest (ROI) are marked in (c). The red (blue) curves correspond to region without (with) the $E_{d}$-dressing. The solid lines are according to Eq. (18) with $\xi(s) \propto 1 /(1+s)$. (e): The phase-angle spectroscopy of the same data. Similar to Fig. 4(b-i), the fits for the free-space data here give $s_{0}=1.2$ and $\Gamma=2 \pi \times 6.0 \mathrm{MHz}$, within expectations.
[1] C. J. Sansonetti, C. E. Simien, J. D. Gillaspy, J. N. Tan, S. M. Brewer, R. C. Brown, S. Wu, and J. V. Porto, $A b-$ solute transition frequencies and quantum interference in a frequency comb based measurement of the Li6,7 D lines, Physical Review Letters 107, 023001 (2011).

[2] Z. Lu, P. Mueller, G. W. F. Drake, and S. C. Pieper,

Colloquium : Laser probing of neutron-rich nuclei in light atoms, Rev. Mod. Phys. 85, 1383 (2013).

[3] A. Beyer, L. Maisenbacher, A. Matveev, R. Pohl, K. Khabarova, A. Grinin, T. Lamour, D. C. Yost, T. W. Hänsch, N. Kolachevsky, and T. Udem, The Rydberg constant and proton size from atomic hydrogen, Science 358, 79-85 (2017).

[4] S. Fuchs, R. Bennett, R. V. Krems, and S. Y. Buhmann, Nonadditivity of Optical and Casimir-Polder Potentials, Phys. Rev. Lett. 121, 83603 (2018).

[5] H. J. Metcalf and P. van der Straten, Laser Cooling and Trapping( Springer-Verlag) (1999).

[6] R. Wynands and S. Weyers, Atomic fountain clocks, Metrologia 42, 64 (2005).

[7] A. D. Ludlow, M. M. Boyd, and J. Ye, Optical atomic clocks, Review of Modern Physics 87, 637-701 (2015).

[8] M. S. Safronova, D. Budker, D. Demille, D. F. J. Kimball, A. Derevianko, and C. W. Clark, Search for new physics with atoms and molecules, Reviews of Modern Physics 90, 25008 (2018).

[9] R. J. Rengelink, Y. van der Werf, R. P. Notermans, R. Jannin, K. S. Eikema, M. D. Hoogerland, and W. Vassen, Precision spectroscopy of helium in a magic wavelength optical dipole trap, Nature Physics 14, 11321137 (2018), arXiv:1804.06693.

[10] P. Asenbaum, C. Overstreet, M. Kim, J. Curti, and M. A. Kasevich, Atom-Interferometric Test of the Equivalence Principle at the 10-12 Level, Physical Review Letters 125, 191101 (2020), arXiv:2005.11624.

[11] H. Stærkind, K. Jensen, J. H. Müller, V. O. Boer, E. T. Petersen, and E. S. Polzik, Precision Measurement of the Excited State Landé g-factor and Diamagnetic Shift of the Cesium D 2 Line, Physical Review X 13, 21036 (2023), arXiv:2208.00077.

[12] X. Zheng, Y. R. Sun, J. J. Chen, W. Jiang, K. Pachucki, and S. M. Hu, Measurement of the Frequency of the 2 S 3 -2 P 3 Transition of He 4, Physical Review Letters 119, 263002 (2017)

[13] R. Brown, S. Wu, J. Porto, C. Sansonetti, C. Simien, S. Brewer, J. Tan, and J. Gillaspy, Quantum interference and light polarization effects in unresolvable atomic lines: Application to a precise measurement of the 6,7Li D 2 lines, Physical Review A 87, 032504 (2013).

[14] T. Peyrot, N. Šibalić, Y. R. Sortais, A. Browaeys, A. Sargsyan, D. Sarkisyan, I. G. Hughes, and C. S. Adams, Measurement of the atom-surface van der Waals interaction by transmission spectroscopy in a wedged nanocell, Physical Review A 100, 022503 (2019), arXiv:1905.02783.

[15] E. Deist, J. A. Gerber, Y.-H. Lu, J. Zeiher, and D. M. Stamper-Kurn, Superresolution microscopy of optical fields using tweezer-trapped single atoms, Phys. Rev. Lett. 128, 083201 (2022).

[16] A. P. Hilton, A. N. Luiten, and P. S. Light, Light-shift spectroscopy of optically trapped atomic ensembles, New Journal of Physics 22, 033042 (2020), arXiv:1911.02708.

[17] C.-L. Hung, X. Zhang, L.-C. Ha, S.-K. Tung, N. Gemelke, and C. Chin, Extracting density-density correlations from in situ images of atomic quantum gases, New Journal of Physics 13, 075019 (2011).

[18] Y. Wang, J. Zhao, X. Huang, L. Qiu, L. Ji, Y. Ma, Y. He, J. P. Sobol, and S. Wu, Imaging Moving Atoms by Holographically Reconstructing the Dragged Slow Light, Physical Review Applied 18, 014065 (2022),
arXiv:2105.14832.

[19] J. Zhao, Y. Wang, X. Huang, and S. Wu, Spectroscopic localization of atomic sample plane for precise digital holography, Optics Express, 18-22 (2022).

[20] J. M. Higbie, L. E. Sadler, S. Inouye, A. P. Chikkatur, S. R. Leslie, K. L. Moore, and V. Savalli, Direct Nondestructive Imaging of Magnetization in a Spin-1 Bose-Einstein Gas, Physical Review Letters 95, 050401 (2005).

[21] S. A. Aljunid, M. K. Tey, B. Chng, T. Liew, G. Maslennikov, V. Scarani, and C. Kurtsiefer, Phase Shift of a Weak Coherent Beam Induced by a Single Atom, Phys. Rev. Lett. 103, 153601 (2009).

[22] M. Kohnen, P. G. Petrov, R. A. Nyman1, and E. A. Hinds, Minimally destructive detection of magnetically trapped atoms using frequency-synthesized light, New Journal of Physics 13, 085006 (2011).

[23] M. Pototschnig, Y. Chassagneux, J. Hwang, G. Zumofen, A. Renn, and V. Sandoghdar, Controlling the Phase of a Light Beam with a Single Molecule, Physical Review Letters 107, 063001 (2011).

[24] M. Fischer, B. Srivathsan, L. Alber, M. Weber, M. Sondermann, and G. Leuchs, Shifting the phase of a coherent beam with a $174 \mathrm{Yb}+$ ion: influence of the scattering cross section, Applied Physics B: Lasers and Optics 123, 48 (2017), arXiv:1609.08335.

[25] B. Zhu, J. Cooper, J. Ye, and A. M. Rey, Light scattering from dense cold atomic media, Physical Review A 94, 023612 (2016).

[26] A. B. Deb, J. Chung, and N. Kjærgaard, Dispersive detection of atomic ensembles in the presence of strong lensing, New Journal of Physics 22, 073017 (2020), arXiv:2002.10618.

[27] S. Agarwal, E. Chaparro, D. Barberena, A. P. Orioli, G. Ferioli, S. Pancaldi, I. Ferrier-Barbut, A. Browaeys, and A. M. Rey, Directional superradiance in a driven ultracold atomic gas in free-space, arXiv , 43-47 (2024), arXiv:arXiv:2403.15556v1.

[28] D. Gabor, Holography, 1948-1971, Proceedings of the IEEE 60, 655 (1972).

[29] T. Latychevskaia, Phase retrieval for digital holography, Journal of the Optical Society of America A 36, 31 (2019).

[30] J. P. Sobol and S. Wu, Imaging cold atoms with shotnoise and diffraction limited holography, New Journal of Physics 16, 093064 (2014).

[31] D. Gabor, Theory of communication. Part 1: The analysis of information, Journal of the Institution of Electrical Engineers - Part III: Radio and Communication Engineering 93, 429-441 (1946).

[32] E. J. Heller, Time-dependent approach to semiclassical dynamics, The Journal of Chemical Physics 62, 15441555 (1975)

[33] J. E. Harvey, R. G. Irvin, and R. N. Pfisterer, Modeling physical optics phenomena by complex ray tracing, Optical Engineering 54, 035001 (2015).

[34] J. N. Ashcraft and E. S. Douglas, An open-source gaussian beamlet decomposition tool for modeling astronomical telescopes, Proc. SPIE 11450,Modeling, Systems Engineering, and Project Management for Astronomy IX, 11450, 1 (2020), arXiv:2106.09162.

[35] S. L. Braunstein, C. M. Caves, and G. J. Milburn, Generalized uncertainty relations : Theory, examples, and Lorentz invariance, Annals of Physics 247, 135 (1996),

arXiv:9507004v1 [arXiv:quant-ph].

[36] E. Cuche, F. Bevilacqua, and C. Depeursinge, Digital holography for quantitative phase-contrast imaging, Optics Letters 24, 291 (1999).

[37] P. Marquet, B. Rappaz, P. J. Magistretti, E. Cuche, Y. Emery, T. Colomb, and C. Depeursinge, Digital holographic microscopy: a noninvasive contrast imaging technique allowing quantitative visualization of living cells with subwavelength axial accuracy, Optics Letters 30, 468 (2005).

[38] T. L. Nguyen, S. Pradeep, R. L. Judson-torres, J. Reed, M. A. Teitell, and T. A. Zangle, Quantitative Phase Imaging : Recent Advances and Expanding Potential in Biomedicine, ACS Nano 16, 11516 (2022).

[39] For the notation conciseness, we may omit the $x, y$ variables, or $x, y, z$ variables, when expressing the complex and real fields.

[40] S. Kadlecek, J. Sebby, R. Newell, and T. G. Walker, Nondestructive spatial heterodyne imaging of cold atoms, Optics Letters 26, 137 (2001).

[41] L. D. Turner, K. F. E. M. Domen, and R. E. Scholten, Diffraction-contrast imaging of cold atoms, Physical Review A 72, 031403 (2005).

[42] J. Smits, A. P. Mosk, and P. van der Straten, Imaging trapped quantum gases by off-axis holography, Optics Letters 45, 981 (2020), arXiv:1911.09590.

[43] E. Altuntas and I. B. Spielman, Self-Bayesian Aberration Removal via Constraints for Ultracold Atom Microscopy, Phys. Rev. Res 3, 043087 (2021), arXiv:2108.07106.

[44] I. Yamaguchi and T. ZHang, Phase-shifting digital holography, Optics Letters 22, 1268-1270 (1997).

[45] R. G. Paxman, T. J. Schulz, and J. R. Fienup, Joint estimation of object and aberrations by using phase diversity, Journal of the Optical Society of America A 9, 1072 (1992).

[46] X. Ou, R. Horstmeyer, C. Yang, and G. Zheng, Quantitative phase imaging via Fourier ptychographic microscopy, Optics Letters 38, 4845 (2013).

[47] A. R. Perry, S. Sugawa, F. Salces-Carcoba, Y. Yue, and I. B. Spielman, Multiple-camera defocus imaging of ultracold atomic gases, Optics Express 29, 17029 (2021), arXiv:2102.08292.

[48] E. N. Leith and J. Upatnieks, Reconstructed Wavefronts and Communication Theory*, Journal of the Optical Society of America 52, 1123 (1962).

[49] P. Gao, G. Pedrini, and W. Osten, Structured illumination for resolution enhancement and autofocusing in digital holographic microscopy, Optics Letters 11, 090901 (2013).

[50] C. Zuo, J. Li, J. Sun, Y. Fan, J. Zhang, L. Lu, R. Zhang, B. Wang, L. Huang, and Q. Chen, Transport of intensity equation: a tutorial, Optics and Lasers in Engineering 135, 106187 (2020).

[51] The highly sensitive relation between the apparent OD and $\phi$ at the sample plane $z=z_{A}$ is exploited itself for holographic imaging of cold atoms, as in ref. [41] and more generally discussed in ref. [43]. Here, since we plan is to measure OD and $\phi$, their relation cannot be assumed as a prior knowledge in general.

[52] H. A. Ilhan, M. Doğar, and M. Özcan, in Practical Holography XXVII: Materials and Applications, Vol. 8644 (SPIE, 2013) pp. 77-87.

[53] D. J. Brady, K. Choi, D. L. Marks, R. Horisaki, and
S. Lim, Compressive Holography, Opt. Express 17, 13040 (2009).

[54] Y. Zhang, H. Wang, Y. Wu, M. Tamamitsu, and A. Ozcan, Edge sparsity criterion for robust holographic autofocusing, Optics Letters 42, 3824 (2017).

[55] X. Fan, J. J. Healy, and B. M. Hennelly, Investigation of sparsity metrics for autofocusing in digital holographic microscopy, Opt. Eng. 56, 053112 (2017).

[56] Y. Wu, Y. Rivenson, Y. Zhang, Z. Wei, H. Günaydin, X. Lin, and A. Ozcan, Extended depth-of-field in holographic imaging using deep-learning-based autofocusing and phase recovery, Optica 5, 704 (2018).

[57] B. Redding, M. A. Choma, and H. Cao, Speckle-free laser imaging using random laser illumination, Nature Photonics 6, 355 (2012).

[58] G. Koren, F. Polack, and D. Joyeux, Iterative algorithms for twin-image elimination in in-line holography using finite-support constraints, Journal of the Optical Society of America A 10, 423 (1993).

[59] S. O. Isikman, W. Bishara, S. Mavandadi, F. W. Yu, S. Feng, R. Lau, and A. Ozcan, Lens-free optical tomographic microscope with a large imaging volume on a chip, Proceedings of the National Academy of Sciences of the United States of America 108, 7296 (2011).

[60] T. Latychevskaia and H.-w. Fink, Solution to the Twin Image Problem in Holography, Phys. Rev. Lett. 98, 233901 (2007).

[61] G. E. Marti, R. B. Hutson, A. Goban, S. L. Campbell, N. Poli, and J. Ye, Imaging Optical Frequencies with 100 muHz Precision and 1.1 mu m Resolution, Physical Review Letters 120, 103201 (2018).

[62] R. Li, Y. Wu, Y. Rui, B. Li, Y. Jiang, L. Ma, and H. Wu, Absolute Frequency Measurement of Li 6 D Lines with khz-Level Uncertainty, Physical Review Letters 124, 063002 (2020).

[63] L. Chomaz, L. Corman, T. Yefsah, R. Desbuquois, and J. Dalibard, Absorption imaging of a quasi-twodimensional gas: a multiple scattering analysis, New Journal of Physics 14, 055001 (2012).

[64] S. Kuhr, Special Topic : Cold Atoms Quantum-gas microscopes : a new tool for cold-atom quantum simulators, Nature Science Review 3, 170-172 (2016).

[65] G. Zheng, R. Horstmeyer, and C. Yang, Wide-field, high-resolution Fourier ptychographic microscopy, Nature Photonics 7, 739 (2013).

[66] G. Zheng, X. Ou, R. Horstmeyer, and C. Yang, Characterization of spatially varying aberrations for wide fieldof-view microscopy, Optics Express 21, 15131 (2013).

[67] K. Park, T. Kong, T. D. Yang, and Y. Choi, Measurement of multiple phase maps for wide-area aberration correction by switchable optical configuration, Optics Express 29, 41894 (2021).

[68] J. P. Sobol, Imaging cold atoms with shot-noise and diffraction limited holography, Ph.D. thesis, Swansea University (2015).

[69] G.-z. Yang, B.-z. Dong, B.-y. Gu, J.-y. Zhuang, and O. K. Ersoy, Gerchberg-Saxton and Yang-Gu algorithms for phase retrieval in a nonunitary transform system: a comparison, Applied Optics 33, 209 (1994).

[70] R. Meppelink, R. A. Rozendaal, S. B. Koller, J. M. Vogels, and P. V. D. Straten, Thermodynamics of BoseEinstein-condensed clouds using phase-contrast imaging, Physical Review A 81, 053632 (2010).

[71] G. Reinaudi, T. Lahaye, Z. Wang, and D. Guéry-Odelin,

Strong saturation absorption imaging of dense clouds of ultracold atoms, Optics Letters 32, 3143 (2007), arXiv:0707.2930.

[72] D. A. Steck, Rubidium 87 D Line Data, http://steck.us/alkalidata (revision 2.2.1, 21 November 2019)..

[73] W. Alt, An objective lens for efficient fluorescence detection of single atoms, Optik (Jena) 113, 142-144 (2002), arXiv:0108058 [physics].

[74] X. Li, F. Zhou, M. Ke, P. Xu, X.-D. He, J. Wang, and M.-S. Zhan, High-resolution ex vacuo objective for cold atom experiments, Applied Optics 57, 7584 (2018).

[75] G. D. Bruce, E. Haller, B. Peaudecerf, D. A. Cotta, M. Andia, S. Wu, M. Y. Johnson, B. W. Lovett, and S. Kuhr, Sub-Doppler laser cooling of $40 K$ with Raman gray molasses on the D2 line, Journal of Physics B: Atomic, Molecular and Optical Physics 50, 095002 (2017), arXiv:1612.04583.

[76] By comparing the shot-to-shot data between different samples, noticeable $\bar{\beta}$-correlations can be found at a level consistent with the frequency noise of our saturation-spectrum-locked cateye laser (Moglabs CEL) at $100 \mathrm{kHz}$ level. The relative phase-angle variations are close to the photon-shot-noise limit set by Eq. (9).

[77] R. Bachelard, N. Piovella, W. Guerin, and R. Kaiser, Collective effects in the radiation pressure force, Phys. Rev. A 94, 033836 (2016).

[78] P. C. Bons, R. De Haas, D. De Jong, A. Groot, and P. Van Der Straten, Quantum Enhancement of the Index of Refraction in a Bose-Einstein Condensate, Phys. Rev. Lett. 116, 173602 (2016).

[79] C. Gross and I. Bloch, Quantum simulations with ultracold atoms in optical lattices., Science 357, 995-1001 (2017).

[80] W. S. Bakr, J. I. Gillen, A. Peng, S. Fölling, and M. Greiner, A quantum gas microscope for detecting single atoms in a Hubbard-regime optical lattice, Nature 462, 74-77 (2009), arXiv:0908.0174.

[81] J. F. Sherson, C. Weitenberg, M. Endres, M. Cheneau, I. Bloch, and S. Kuhr, Single-Atom Resolved Fluorescence Imaging of an Atomic Mott Insulator, Nature 467, 68 (2010), arXiv:arXiv:1006.3799v2.

[82] D. Okuno, Y. Amano, K. Enomoto, N. Takei, and Y. Takahashi, Schemes for nondestructive quantum gas microscopy of single atoms in an optical lattice, New J. Phys. 22, 013041 (2020).

[83] K. D. Nelson, X. Li, and D. S. Weiss, Imaging single atoms in a three-dimensional array, Nature Physics 3, 556 (2007).

[84] D. Barredo, V. Lienhard, S. de Léséleuc, T. Lahaye, and A. Browaeys, Synthetic three-dimensional atomic structures assembled atom by atom, Nature 561, 79-82 (2018), arXiv:1712.02727.

[85] I. B. Spielman, W. D. Phillips, and J. V. Porto, MottInsulator Transition in a Two-Dimensional Atomic Bose Gas, Phys. Rev. Lett. 98, 080404 (2007).

[86] A. Greenbaum, W. Luo, T. W. Su, Z. Göröcs, L. Xue, S. O. Isikman, A. F. Coskun, O. Mudanyali, and A. Ozcan, Imaging without lenses: Achievements and remaining challenges of wide-field on-chip microscopy, Nat. Methods 9, 889 (2012).

[87] K. De Haan, Y. Rivenson, Y. Wu, and A. Ozcan, DeepLearning-Based Image Reconstruction and Enhance- ment in Optical Microscopy, Proc. IEEE 108, 2949575 (2020).

[88] J. Park, D. J. Brady, G. Zheng, L. Tian, and L. Gao, Review of bio-optical imaging systems with a high spacebandwidth product, Adv. Photonics 3, 044001 (2021).

[89] X. Kong, A. Markmann, and V. S. Batista, Time-Sliced Thawed Gaussian Propagation Method for Simulations of Quantum Dynamics, Journal of Physical Chemistry A 120, 3260-3269 (2016).

[90] N. G. Worku and H. Gross, Gaussian pulsed beam decomposition for propagation of ultrashort pulses through optical systems, Journal of the Optical Society of America A 37, 98 (2020).

[91] T. Legrand, F. R. Winkelmann, W. Alt, D. Meschede, A. Alberti, and C. A. Weidner, Three-dimensional imaging of single atoms in an optical lattice via helical pointspread-function engineering, Physical Review A 109, 033304 (2024), arXiv:2312.05341.

[92] S. Diego, S. Diego, M. E. Mossman, R. A. Corbin, M. M. Forbes, and P. Engels, Atom Interferometric Imaging of Differential Potentials Using an Atom Laser, Physical Review Letters 130, 263402 (2023).

[93] L. Ji, Y. He, Q. Cai, Z. Fang, Y. Wang, L. Qiu, L. Zhou, S. Wu, and S. Grava, Superradiant Detection of Microscopic Optical Dipolar Interactions, Phys. Rev. Lett. 131,253602 (2023).

[94] J. Rui, D. Wei, A. Rubio-Abadal, S. Hollerith, J. Zeiher, D. M. Stamper-Kurn, C. Gross, and I. Bloch, A subradiant optical mirror formed by a single structured atomic layer, Nature 583, 369-374 (2020), arXiv:2001.00795.

[95] A. B. Deb and N. Kjærgaard, Observation of Pauli blocking in light scattering from quantum degenerate fermions, Science (80-. ). 374, 972-975 (2021).

[96] Y. K. Lu, Y. Margalit, and W. Ketterle, Bosonic stimulation of atom-light scattering in an ultracold gas, Nature Physics 19, 210-214 (2022).

[97] K. Srakaew, P. Weckesser, S. Hollerith, D. Wei, D. Adler, I. Bloch, and J. Zeiher, A subwavelength atomic array switched by a single Rydberg atom, Nature Physics 10, 1038 (2023), 2207.09383.

[98] J. E. Lye, J. J. Hope, and J. D. Close, Nondestructive dynamic detectors for Bose-Einstein condensates, Phys. Rev. A 67, 043609 (2003).

[99] J. Miao, P. Charalambous, J. Kirz, and D. Sayre, Extending the methodology of X-ray crystallography to non-crystalline specimens, Nature 400, 342 (1999).

[100] M. Babiker, D. L. Andrews, V. E. Lembessis, M. Hamamda, P. Pillet, Y. Yin, and Y. Xia, Sisyphus cooling in a continuously loaded trap, New Journal of Physics 15, 093012 (2013).

[101] A. La Rooij, C. Ulm, E. Haller, and S. Kuhr, A comparative study of deconvolution techniques for quantum-gas microscope images, New Journal of Physics 25, 083036 (2023), arXiv:2207.08663.

[102] Y. Castin, in COHERENT ATOMIC MATTER WAVES, LES HOUCHES SUMMER SCHOOL SESSION, Vol. 72, edited by R. Kaiser, C. Westbrook, and F. David (NATO, Adv Study Inst, 2001) pp. 5-136.

[103] D. P. Kingma and J. L. Ba, Adam: A method for stochastic optimization, 3rd International Conference on Learning Representations, ICLR 2015 - Conference Track Proceedings , 1-15 (2015), arXiv:1412.6980.

