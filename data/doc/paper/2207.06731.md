# Monotone Comparative Statics for Equilibrium Problems 

Alfred Galichon ${ }^{\dagger}$, Larry Samuelson ${ }^{b}$, and Lucas Vernet ${ }^{\S}$

July 15,2022


#### Abstract

We introduce a notion of substitutability for correspondences and establish a monotone comparative static result, unifying results such as the inverse isotonicity of M-matrices, Berry, Gandhi and Haile's identification of demand systems, monotone comparative statics, and results on the structure of the core of matching games without transfers (Gale and Shapley) and with transfers (Demange and Gale). More specifically, we introduce the notions of unified gross substitutes and nonreversingness and show that if $\mathrm{Q}: P \rightrightarrows Q$ is a supply correspondence defined on a set of prices $P$ which is a sublattice of $\mathbb{R}^{N}$, and $Q$ satisfies these two properties, then the set of equilibrium prices $\mathbf{Q}^{-1}(q)$ associated with a vector of quantities $q \in Q$ is increasing (in the strong set order) in $q$; and it is a sublattice of $P$.


${ }^{\dagger}$ Economics Department, FAS, and Mathematics Department, Courant Institute, New York University; and Economics Department, Sciences Po. Email: ag133@nyu.edu. Galichon gratefully acknowledges funding from NSF grant DMS1716489 and ERC grant CoG-866274.

${ }^{b}$ Department of Economics, Yale University. Email: larry.samuelson@yale.edu.

${ }^{\S}$ Economics Department, Sciences Po, and Banque de France. Email: lucas.vernet@acpr.banque-france.fr.

## Contents

1 Introduction ..... 1
2 Theory ..... 2
2.1 Unified Gross Substitutes ..... 2
2.1.1 Definition ..... 2
2.1.2 Properties ..... 3
2.2 Nonreversingness ..... 5
2.2.1 Definitions ..... 5
2.2.2 Properties ..... 5
2.3 M0-correspondences and Inverse Isotonicity ..... 8
2.3.1 M0-correspondences and Related Notions ..... 8
2.3.2 Inverse Isotonicity Theorems ..... 10
3 Connections with Existing Theories ..... 12
3.1 Kelso and Crawford's Gross Substitutes ..... 12
3.2 Polterovich and Spivak's Gross Substitutes ..... 13
3.3 Berry, Gandhi and Haile's Connected Strict Substitutes ..... 13
3.4 Topkis' Theorem ..... 15
4 Applications ..... 16
4.1 Profit Maximization ..... 16
4.2 Structures of Solutions ..... 18
4.3 An Equilibrium Flow Problem ..... 18
4.4 Matching with (Fully or Imperfectly) Transferable Utility ..... 23
4.5 Matching Without Transfers ..... 24
4.6 Hedonic Pricing ..... 26
5 Conclusion ..... 28
A Appendix ..... 28
A. 1 Aggregation Preserves Unified Gross Substitutes ..... 28
A. 2 The Sum of Two M0-correspondences is Not Always an M0-correspondence ..... 29
A. 3 Kelso and Crawford's Substitutes Does Not Imply Unified Gross Substitutes ..... 29
A. 4 Unified Gross Substitutes and Polterovich and Spivak's Property Are Independent ..... 30
A. 5 Outside Goods and Weighted Monotonicity ..... 31
A. 6 Connections with Monotone Comparative Statics ..... 32
A. 7 Proof of Theorem 3 . ..... 33
A. 8 Proof of Theorem 5 . ..... 38
A. 9 Matching and Equilibrium Flows ..... 39
A. 10 Proof of Theorem 7 ..... 40
A. 11 Proof of Theorem 8 ..... 41
A. 12 Proof of Theorem 9 ..... 42
B Online Appendix ..... 46
B. 1 Weak or Strong Inequalities? ..... 46
B. 2 Nonreversingness and Aggregate Monotonicity but Not Monotone Total Output ..... 48
B. 3 Equivalent Definitions of M-functions ..... 49
B. 4 Imperfect Competition ..... 49
B. 5 Partial Inverse Correspondence ..... 51
B. 6 Structures of Solutions ..... 52

## Monotone Comparative Statics for Equilibrium Problems

## 1 Introduction

This paper proposes the notion of unified gross substitutes for a correspondence $\mathrm{Q}: P \rightrightarrows Q$. For concreteness we often interpret $\mathrm{Q}$ as a supply correspondence mapping from a set of prices $P$ to a set of quantities $Q$, though our analysis applies to correspondences in general. Our analysis encompasses the familiar case in which $\mathrm{Q}$ arises from the optimization problem of a single agent, but unified gross substitutes need not refer to a single agent's decision problem, and we are especially interested in its potential for the study of equilibrium problems.

Our focus is the inverse isotonicity of the correspondence Q. We show that if the correspondence $\mathrm{Q}$ satisfies unified gross substitutes as well as a mild condition called nonreversingness, then the set of parameters $\mathrm{Q}^{-1}(q)$ associated with an element $q \in Q$ is increasing (in the strong set order) in $q$ and is a sublattice of $P$.

For functions, the notion of unified gross substitutes is equivalent to the familiar notion of weak gross substitutes. Berry, Gandhi and Haile [5] provide an inverse isotonicity result for functions and explain the importance of inverse isotonicity. One can view our work as generalizing their result to correspondences. In some cases, there is a natural formulation of the inverse $\mathrm{Q}^{-1}$ as the solution to an optimization problem. We can then (under appropriate conditions) apply the monotone comparative statics results of Topkis [34 and Milgrom and Shannon [22] to obtain inverse isotonicity. One can view our work as extending the study of monotone comparative statics beyond optimization problems.

For correspondences, the notion of unified gross substitutes implies (but is not equivalent to) Kelso and Crawford's [20] notion of gross substitutes for correspondences, which is too weak to imply our inverse isotonicity result. The notion of unified gross substitutes is related to the generalization of $M$-matrices to $M$-functions introduced by More and Rheinboldt [24] and is independent of a similar substitutes notion introduced by Polterovich and Spivak [29].

We show that unified gross substitutes for the argmax correspondence of a maximization problem is equivalent to the submodularity of the value function, generalizing a familiar result for argmax functions. We introduce a new equilibrium problem, referred to as the equilibrium flow problem, that contains a number of familiar settings as special cases and whose equilibrium correspondence satisfies unified gross substitutes. This provides a new route to the result that the set of stable matches in matching problems with transfers (as in Demange and Gale [9]) and without transfers form a sublattice. Finally, we examine hedonic pricing problems (cf. Rosen [32] and Ekeland, Heckman and Nesheim [11]), extending the basic results of Chiappori, McCann and Nesheim [8] beyond quasilinear utilities and establishing an inverse isotonicity result for such models.

## 2 Theory

When $u$ and $v$ are two elements of a partially ordered set $(\mathcal{S}, \leq)$, we use $u<v$ to express that $u \leq v$ and $u \neq v$. Let $P \subseteq \mathbb{R}^{N}$ and $Q \subseteq \mathbb{R}^{N}$, for some finite $N$, with generic elements $p \in P$ and $q \in Q$. Let $\mathrm{Q}: P \rightrightarrows Q$ be a correspondence. We maintain the following assumption throughout, typically without explicit mention:

Assumption 1. $P$ is a sublattice of $\mathbb{R}^{N}$.

Recall from Topkis [34, p. 13] that a set $P$ is a sublattice of $\mathbb{R}^{N}$ if for any pair of vectors $p, p^{\prime} \in P$, the set $P$ also contains their least upper bound (denoted by $p \vee p^{\prime}$ and defined as the coordinate-wise maximum of $p$ and $p^{\prime}$ ) as well as their greatest lower bound (denoted by $p \wedge p^{\prime}$ and defined as the coordinate-wise minimum of $p$ and $\left.p^{\prime}\right)$.

In one of our leading interpretations of the correspondence $\mathrm{Q}$, we view the dimensions of $\mathbb{R}^{N}$ as identifying goods and interpret $\mathrm{Q}$ as a supply correspondence. An element $p \in P$ is then a price vector, with $p_{z}$ denoting the price of good $z \in\{1, \ldots, N\}$. An element $q \in \mathrm{Q}(p)$ is an allocation, with $q_{z}$ denoting the quantity of good $z$ supplied at price vector $p$. No matter what the interpretation, we typically refer to elements of $q$ as quantities and elements of $p$ as prices.

### 2.1 Unified Gross Substitutes

### 2.1.1 Definition

Our basic notion of substitutability for correspondences is:

Definition 1 (Unified Gross Substitutes). The correspondence $\mathbf{Q}$ : $P \rightrightarrows Q$ satisfies unified gross substitutes if, given $p \in P, p^{\prime} \in P, q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$, there exists $q^{\wedge} \in \mathrm{Q}\left(p \wedge p^{\prime}\right)$ and $q^{\vee} \in \mathrm{Q}\left(p \vee p^{\prime}\right)$ such that

$$
\begin{align*}
& p_{z} \leq p_{z}^{\prime} \quad \Longrightarrow \quad q_{z} \leq q_{z}^{\wedge} \text { and } q_{z}^{\vee} \leq q_{z}^{\prime}  \tag{1}\\
& p_{z}^{\prime}<p_{z} \quad \Longrightarrow \quad q_{z}^{\prime} \leq q_{z}^{\wedge} \text { and } q_{z}^{\vee} \leq q_{z} \tag{2}
\end{align*}
$$

Figure 1 gives an illustration of the unified gross substitutes property with two goods. This definition is appropriate for our interpretation of $\mathrm{Q}$ as a supply correspondence, and would need to be adjusted in a straightforward way for applications to demand correspondences 1 Section 3 connects this definition with existing notions in the literature and explains what is unified by this concept.
\footnotetext{
${ }^{1}$ The counterpart of $(1)-\sqrt{2}$ would then be

$$
\begin{equation*}
p_{z} \leq p_{z}^{\prime} \quad \Longrightarrow \quad q_{z} \geq q_{z}^{\wedge} \text { and } q_{z}^{\vee} \geq q_{z}^{\prime} \tag{3}
\end{equation*}
$$

$$
\begin{equation*}
p_{z}^{\prime}<p_{z} \quad \Longrightarrow \quad q_{z}^{\prime} \geq q_{z}^{\wedge} \text { and } q_{z}^{\vee} \geq q_{z} \tag{4}
\end{equation*}
$$

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-05.jpg?height=662&width=1070&top_left_y=299&top_left_x=516)

Figure 1: An illustration of the unified gross substitutes property with two goods. Q is a mapping between the set of prices on the left and the set of quantities on the right with $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$. Definition 1 imposes that there exists a $q^{\vee} \in\left(p \vee p^{\prime}\right)$, smaller than the top-right border of the rectangle drawn in the set of quantities, and a $q^{\wedge} \in\left(p \wedge p^{\prime}\right)$ larger than the bottom-left border.

One might be tempted to strengthen this definition by making the antecedents of (1)-(2) both weak inequalities. The resulting notion is not only stronger than we need, but vitiates many of our equivalence results and too often fails to hold. Appendix B. 1 provides an example. Notice that, given the ability to interchange the prices $p$ and $p^{\prime}$, it is irrelevant which antecedent carries the strict inequality, as long as one does.

### 2.1.2 Properties

This section collects some basic properties of unified gross substitutes. We first show that in the case of a function, unified gross substitutes is equivalent to the the textbook notion of weak gross substitutes (e.g., Mas-Colell, Green and Whinston [21, Definition 17.F.2, p. 611]). ${ }^{2}$

Property 1. For functions, unified gross substitutes and weak gross substitutes are equivalent. Recall that a function $\mathrm{q}: \mathbb{R}^{N} \rightarrow \mathbb{R}^{N}$ satisfies weak gross[^0]substitutes, or equivalently is off-diagonally isotone, or is a Z-map (Plemmons [28]), if and only if $\mathrm{q}_{i}(p)$ is nonincreasing in $p_{j}$ for $i \neq j$.

We now show that the function q satisfies weak gross substitutes if and only if the correspondence $\mathrm{Q}(p)=\{\mathrm{q}(p)\}$ satisfies unified gross substitutes. First let $\mathrm{q}$ satisfy weak gross substitutes, take $q=\mathrm{q}(p)$ and $q^{\prime}=\mathrm{q}\left(p^{\prime}\right)$, and let $q^{\wedge}=\mathrm{q}\left(p \wedge p^{\prime}\right)$ and $q^{\vee}=\mathrm{q}\left(p \vee p^{\prime}\right)$. Then $p_{z} \leq p_{z}^{\prime} \Longrightarrow\left(p \wedge p^{\prime}\right)_{z}=p_{z}$, which combines with $p \wedge p^{\prime} \leq p$ and weak gross substitutes to give $\mathrm{q}_{z}(p) \leq \mathrm{q}_{z}\left(p \wedge p^{\prime}\right)$ and hence the first part of (1). The other requirements in (1)-(2) are dealt with similarly, and hence $Q$ satisfies unified gross substitutes. Conversely, let $\mathrm{Q}(p)=\{\mathrm{q}(p)\}$ satisfy unified gross substitutes, let $p_{j} \geq p_{j}^{\prime}$ and $p_{i}=p_{i}^{\prime}$ for all $i \neq j$. Then $p^{\wedge}=p^{\prime}$ and $p^{\vee}=p$, so that applying (1) to some $i \neq j$ gives $\mathrm{q}_{i}(p) \leq \mathrm{q}_{i}\left(p^{\prime}\right)$, and hence $\mathrm{q}$ satisfies weak gross substitutes.

We next note that if the correspondence $\mathrm{Q}$ is the solution to a maximization problem, the unified gross substitutes condition admits a familiar characterization. Ausubel and Milgrom [3, Theorem 10] show that a demand correspondence satisfies a weak gross substitutes property (namely that $\mathrm{q}_{i}(p)$ is nonincreasing in $p_{j}$ for $i \neq j$ and for those $p$ for which $\mathrm{q}(p)$ is single-valued) if and only if the associated indirect utility function is submodular. We establish an analogous condition for unified gross substitutes.

Property 2. Subdifferentials of convex submodular functions satisfy unified gross substitutes. Let $c^{*}: \mathbb{R}^{N} \rightarrow \mathbb{R}$ be a convex function and consider the subdifferential of $c^{*}$, given by $\partial c^{*}(p)=\left\{q: p^{\prime} \rightarrow\left[q^{\top} p^{\prime}-c^{*}\left(p^{\prime}\right)\right]\right.$ is maximal at $\left.p\right\}$. Theorem 3 in Section 4.1 shows that $c^{*}$ is submodular if and only if the correspondence $p \rightrightarrows \partial c^{*}(p)$ satisfies unified gross substitutes.

Section 4.1 shows that we can think of $c^{*}$ as the indirect profit function associated with a profit maximization problem, which is necessarily convex, allowing us to conclude that the associated supply correspondence satisfies unified gross substitutes if and only if the indirect profit function is submodular.

Property 9 below illustrates one use of the following property.

Property 3. Monetary measurement preserves unified gross substitutes. Given an excess supply correspondence $\mathrm{Q}$ for a competitive economy, we can define the excess supply correspondence expressed in monetary terms as

$$
\mathbf{Q}^{\$}(p)=\left\{\left(p_{z} q_{z}\right)_{z \in\{1, \ldots, N\}} \text { with } q \in \mathbb{Q}(p)\right\}
$$

It is straightforward to verify that when the domain $P$ of $\mathrm{Q}$ is included in $\mathbb{R}_{+}^{N}$, so that prices are nonnegative, then $\mathrm{Q}$ satisfies unified gross substitutes if and only if $Q^{\$}$ satisfies unified gross substitutes.

The following property shows that unified gross substitutes aggregates in a natural way.

Property 4. Aggregation preserves unified gross substitutes. If the correspondences $Q^{1}$ and $Q^{2}$ have the unified gross substitutes property, then so does $\lambda Q^{1}+\mu Q^{2}$ for $\lambda \geq 0$ and $\mu \geq 0$, where

$$
\left(\lambda \mathbf{Q}^{1}+\mu \mathbf{Q}^{2}\right)(p)=\left\{\lambda q^{1}+\mu q^{2}: q^{1} \in \mathbf{Q}^{1}(p), q^{2} \in \mathbf{Q}^{2}(p)\right\} .
$$

The proof, in Appendix A.1, is a straightforward bookkeeping exercise.

### 2.2 Nonreversingness

Our second condition is a requirement that the correspondence $Q$ cannot completely reverse the order of two points:

### 2.2.1 Definitions

Definition 2 (Nonreversing correspondence). The correspondence $\mathrm{Q}: P \rightrightarrows Q$ is nonreversing if

$$
\left(\begin{array}{c}
q \in \mathbb{Q}(p)  \tag{5}\\
q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right) \\
q \leq q^{\prime} \\
p \geq p^{\prime}
\end{array}\right) \Longrightarrow\binom{q \in \mathbb{Q}\left(p^{\prime}\right)}{q^{\prime} \in \mathbb{Q}(p)}
$$

Nonreversingness is a weak monotonicity requirement. It is implied by the (stronger but common) assumption that $\mathrm{Q}$ is increasing in the strong set order, as we would typically expect of a supply correspondence.

When $\mathrm{Q}$ is point-valued, the previous notion equivalently boils down to the following implication:

$$
\begin{equation*}
p \geq p^{\prime} \text { and } \mathrm{q}(p) \leq \mathrm{q}\left(p^{\prime}\right) \text { implies } \mathrm{q}(p)=\mathrm{q}\left(p^{\prime}\right) \tag{6}
\end{equation*}
$$

Nonreversingneess is weaker than strong nonreversingness, where the conclusion in (5) is replaced by the stronger statement that $p=p^{\prime}$ :

Definition 3 (Strongly nonreversing correspondence). The correspondence Q : $P \rightrightarrows Q$ is strongly nonreversing if

$$
\left(\begin{array}{c}
q \in \mathbb{Q}(p)  \tag{7}\\
q^{\prime} \in \mathbf{Q}\left(p^{\prime}\right) \\
q \leq q^{\prime} \\
p \geq p^{\prime}
\end{array}\right) \Longrightarrow p=p^{\prime}
$$

### 2.2.2 Properties

Some familiar properties of economic models imply the nonreversingness of the supply correspondence. The first three of the following properties immediately imply nonreversingness by ensuring that the antecedent of (5) can hold only if $q=q^{\prime}$, rendering the consequent immediate.

Property 5. Constant aggregate output implies nonreversingness. The correspondence $\mathrm{Q}$ satisfies constant aggregate output if there exists $k \in \mathbb{R}_{++}^{N}$ such that $\sum_{z=1}^{N} k_{z} q_{z}=0$ holds for all $p \in P$ and $q \in \mathbb{Q}(p)$.

It will often be natural to take $k$ to be the unit vector. One obvious circumstance in which aggregate output is constant is that in which the bundle of goods is augmented by an "outside good" whose quantity is the negative of the sum of the quantities of the original set of goods, as in Berry, Gandhi and Haile 55. Alternatively, the correspondence may be describing market shares in a model of competition, probabilities in a prediction problem, or budget shares in a model of consumption.

Property 6. Monotone total output implies nonreversingness. The correspondence $\mathbb{Q}$ satisfies monotone total output if for $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right), p \geq p^{\prime}$ implies $\sum_{z=1}^{N} q_{z} \geq \sum_{z=1}^{N} q_{z}^{\prime}$.

The monotone total output property plays an important role in the matching with contracts literature (Hatfield and Milgrom [18]) under the name of law of aggregate demand (or more properly here, law of aggregate supply). ${ }^{3}$

Property 7. Aggregate monotonicity implies nonreversingness. The correspondence $\mathbf{Q}$ satisfies aggregate monotonicity if for $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$, both $p \geq p^{\prime}$ and $q<q^{\prime}$ cannot hold simultaneously.

The correspondence $\mathrm{Q}$ satisfies aggregate monotonicity if and only if for all $p \geq p^{\prime}, q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$, there exists $k \in \mathbb{R}_{++}$with $\sum_{z=1}^{N} k_{z} q_{z} \geq \sum_{z=1}^{N} k_{z} q_{z}^{\prime}$.

Constant aggregate output implies monotone total output if we take $k$ to be the unit vector in the former; otherwise they are not nested. Aggregate monotonicity is clearly implied by either of constant aggregate output or monotone total output, but the converses fail. To illustrate, Appendix B. 2 provides an example of a function that is nonreversing and that satisfies aggregate and weighted monotonicity (defined next) but not monotone total output.

Our next property combines with unified gross substitutes to imply nonreversingness.

Property 8. Weighted monotonicity and unified gross substitutes imply nonreversingness. The correspondence $\mathrm{Q}$ satisfies weighted monotonicity if, given prices $p$ and $p^{\prime}$ in $P$ and allocations $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$, there exists $k \in \mathbb{R}_{++}^{N}$ and allocations $q^{\wedge} \in \mathrm{Q}\left(p \wedge p^{\prime}\right)$ and $q^{\vee} \in \mathrm{Q}\left(p \vee p^{\prime}\right)$ such that

$$
\begin{equation*}
\sum_{z=1}^{N} k_{z} q_{z} \geq \sum_{z=1}^{N} k_{z} q_{z}^{\wedge} \quad \text { and } \quad \sum_{z=1}^{N} k_{z} q_{z}^{\vee} \geq \sum_{z=1}^{N} k_{z} q_{z}^{\prime} \tag{8}
\end{equation*}
$$

Notice that the vector $k$ is allowed to depend on the prices and allocations involved.[^1]

Weighted monotonicity and unified gross substitutes together imply that $\mathrm{Q}$ is nonreversing. To see this, consider $p$ and $p^{\prime}$ in $P$, and $q$ and $q^{\prime}$ in $Q$, such that $q \in \mathbb{Q}(p), q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right), q \leq q^{\prime}$ and $p \geq p^{\prime}$. By definition, there exists $k \in \mathbb{R}_{++}^{N}$, $q^{\wedge} \in \mathbb{Q}\left(p \wedge p^{\prime}\right)$ and $q^{\vee} \in \mathbb{Q}\left(p \vee p^{\prime}\right)$, satisfying (8). Using $q \leq q^{\prime}$ and unified gross substitutes (1), one sees that $q_{z} \leq q_{z}^{\wedge}$ and $q_{z}^{\vee} \leq q_{z}^{\prime}$ for all $z$. By summation one obtains $\sum_{z=1}^{N} k_{z} q_{z} \leq \sum_{z=1}^{N} k_{z} q_{z}^{\wedge}$ and $\sum_{z=1}^{N} k_{z} q_{z}^{\vee} \leq \sum_{z=1}^{N} k_{z} q_{z}^{\prime}$, and thus (using (8)) all these inequalities are equalities. Hence $q=q^{\wedge}$, and $q^{\prime}=q^{\vee}$, which shows that $q \in \mathbb{Q}\left(p \wedge p^{\prime}\right)=\mathrm{Q}\left(p^{\prime}\right)$ and $q^{\prime} \in \mathrm{Q}\left(p \vee p^{\prime}\right)=\mathrm{Q}(p)$ as needed.

Property 9. Walras law and nonreversingness. Given a correspondence Q, consider the correspondence measured in monetary terms,

$$
\mathbf{Q}^{\$}(p)=\left\{\left(p_{z} q_{z}\right)_{z \in\{1, \ldots, N\}} \text { with } q \in \mathbb{Q}(p)\right\}
$$

introduced in Property 3. Then $\mathbf{Q}$ satisfies Walras law if for all $p$, and all $q \in \mathbf{Q}(p)$, we have $p^{\top} q=0$, which holds if and only if for all $p$ and all $\tilde{q} \in Q^{\$}(p)$, we have $1^{\top} \tilde{q}=0$. Hence, if $\mathrm{Q}$ satisfies Walras law, it follows that $Q^{\$}$ has constant aggregate output, and is therefore nonreversing.

The obvious example of a correspondence satisfying Walras law is the excess supply correspondence of a competitive economy.

Property 10. Inverse isotonicity implies nonreversingness. The inverse correspondence $\mathrm{Q}^{-1}$ is isotone in the strong set order if for $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$ with $q \leq q^{\prime}$, one has $q \in \mathbb{Q}\left(p \wedge p^{\prime}\right)$ and $q^{\prime} \in \mathbb{Q}\left(p \vee p^{\prime}\right)$.

It follows immediately from the definitions that inverse isotonicity in the strong set order implies nonreversingness. Section 2.3.2 develops this connection further.

Property 11. Single crossing of the objective function implies nonreversing argmax, and conversely. Consider $\varphi: \mathbb{R}^{2 N} \rightarrow \mathbb{R}$ and assume $\varphi(p, q)$ has single crossing in $(p, q)$, that is if $0 \geq \varphi\left(p^{\prime}, q\right)-\varphi\left(p^{\prime}, q^{\prime}\right)$ and $\varphi(p, q)-\varphi\left(p, q^{\prime}\right) \geq 0$ holds for $p^{\prime} \geq p$ and $q^{\prime} \leq q$, then these two inequalities hold as equalities. Although stated differently, this definition is equivalent to the one introduced by Milgrom and Shannon [22]. Consider

$$
\begin{equation*}
\mathrm{Q}(p)=\arg \max _{q \in Q}\{\varphi(p, q)\} \tag{9}
\end{equation*}
$$

Then $\mathbf{Q}$ is nonreversing. Indeed, assume $q \in \mathbb{Q}(p), q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right), p \geq p^{\prime}$ and $q \leq q^{\prime}$. Then by definition of $\mathbf{Q}$, one has $\varphi(p, q) \geq \varphi\left(p, q^{\prime}\right)$ and $\varphi\left(p^{\prime}, q^{\prime}\right) \geq \varphi\left(p^{\prime}, q\right)$. By single crossing, equality holds in both inequalities, and therefore $q \in \mathbb{Q}\left(p^{\prime}\right)$ and $q^{\prime} \in \mathbb{Q}(p)$. Conversely, it is easily seen by taking $Q=\left\{q, q^{\prime}\right\}$ that if $\mathbf{Q}$ defined as in (9) above is nonreversing for all $Q$, then $\varphi(p, q)$ has single crossing in (p,q).

Our next property connects nonreversingness with the notion of a $P$-function. Such functions arise in a number of applications, and are the subject of a rich literature (e.g., Varga [35]).

Property 12. A P-function is nonreversing. An affine function $\mathrm{q}: \mathbb{R}^{N} \rightarrow \mathbb{R}^{N}$, written as $\mathrm{q}(p)=A p+b$ for an $N \times N$ matrix $A$ and an $N \times 1$ vector $b$, is a $P$ function if the matrix $A$ is a $P$ matrix (every principal minor is positive).

More and Rheinboldt [24, Definition 2.5, p. 49] generalize this notion. A function $\mathrm{q}: \mathbb{R}^{N} \rightarrow \mathbb{R}^{N}$ is a $P$-function if for every $p$ and $p^{\prime}$ with $p \neq p^{\prime}$, there exists $z \in\{1, \ldots, N\}$ such that $\left(p_{z}-p_{z}^{\prime}\right)\left(\mathrm{q}(p)_{z}-\mathrm{q}\left(p^{\prime}\right)_{z}\right)>0$. An implication of this condition is

$$
p \geq p^{\prime}, \mathbf{q}(p) \leq \mathrm{q}\left(p^{\prime}\right) \Longrightarrow p=p^{\prime}
$$

The natural application of this concept to correspondences $\mathrm{Q}: P \rightrightarrows Q$ is that

$$
\left[q \in \mathbb{Q}(p), q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right), q \leq q^{\prime}, p \geq p^{\prime}\right] \Longrightarrow p=p^{\prime}
$$

The $P$-correspondence property immediately implies nonreversingness.

Gale and Nikaido [12] show that a smooth P-function defined on a rectangle is injective [Theorem 4.2, p. 86] and and establish conditions under which it has an isotone inverse [Theorem 5, p. 87]. P-functions and their properties are discussed at length in Nikaido [25].

### 2.3 M0-correspondences and Inverse Isotonicity

### 2.3.1 M0-correspondences and Related Notions

We introduce the notion of an MO-correspondences:

Definition 4 (M0-correspondence). An M0-correspondence is a correspondence which satisfies unified gross substitutes and is nonreversing.

We view unified gross substitutes as the more substantive of the two conditions, with nonreversingness typically being innocuous.

We noted in Property 4 that unified gross substitutes is preserved by aggregation. The same is not the case once we add nonreversingness:

Remark 1 (M0-correspondences fail to aggregate). Appendix A.2 shows that the sum (as defined in Property (4) of two M0-correspondences $\mathrm{Q}$ and $\mathrm{Q}^{\prime}$ is not necessarily an M0-correspondence.

If $\mathrm{Q}$ is an $\mathrm{M} 0$-correspondence, then neither $\mathrm{Q}$ nor $\mathrm{Q}^{-1}$ need be point-valued. In the special case in which both are point-valued, we recover the existing notion of an $M$-function:

Definition 5 (M-function). An M-function is an MO-correspondence Q which is point-valued and has point-valued inverse $\mathrm{Q}^{-1}$.

We can then mix and match to define:

Definition 6 (M0-function). An M0-function is an M0-correspondence Q which is point-valued.

Definition 7 (M-correspondence). An M-correspondence is an M0-correspondence Q which has point-valued inverse $\mathrm{Q}^{-1}$.

We summarize with the following table:

|  | $\mathrm{Q}^{-1}$ is point-valued | $\mathrm{Q}^{-1}$ is set-valued |
| :--- | :---: | :---: |
| $\mathrm{Q}$ is point-valued | $\mathrm{Q}$ is an M-function | $\mathrm{Q}$ is an M0-function |
| $\mathrm{Q}$ is set-valued | $\mathrm{Q}$ is an M-correspondence | $\mathrm{Q}$ is an $\mathrm{M} 0$-correspondence |

This string of definitions is based on our characterization of M0-correspondences in terms of unified gross substitutes and nonreversingness. More and Rheinboldt [24, Definition 2.3, p. 48] (see also Ortega and Rheinboldt [27, Definition 13.5.7, p. 468]) define an M-function Q as one that (in our terms) satisfies weak gross substitutes and the condition that $\mathrm{Q}(p) \leq \mathrm{Q}\left(p^{\prime}\right)$ implies $p \leq p^{\prime}$. In Appendix B.3, we show that our definition and More and Rheinboldt's definition of an M-function are indeed equivalent.

To motivate the labels for these various notions, we recall that an M-matrix is a square matrix with every off-diagonal entry less or equal than zero and with every principal minor greater than zero. An M0-matrix is a square matrix with every off-diagonal entry less or equal than zero and with every principal minor greater than or equal to zero. 4 Then we have:

Property 13. M(M0)-matrices Induce M(M0)-functions. Let $Q$ be an $n \times n$ matrix and consider the function $\mathrm{Q}(p)=Q p$. Then $\mathrm{Q}$ is an $\mathrm{M}$-function if and only if $Q$ is a M-matrix, and $\mathrm{Q}$ is a $\mathrm{M} 0$-function if and only if $Q$ is an $\mathrm{M} 0$-matrix.

To confirm this statement, we first note that $Q p$ is obviously point valued. If $Q$ is an M-matrix, then it is nonsingular and hence has an inverse $Q^{-1}$, and in addition the nonsingular matrix $Q$ is the inverse of $Q^{-1}$, ensuring that $Q^{-1}$ is point valued. Next, if $Q$ is an M0-matrix, then $Q p$ is again point-valued but $Q$ may be singular, in which case $Q^{-1}$ can be set-valued.

Our terms thus exte notions of an M-function and M0-function to nonlinear functions and correspondences.

We can give examples for each of these categories. As Section 3.3 explains, Berry, Gandhi and Haile [5] offer sufficient conditions for a function to be an M-function, with one example (among others) being the estimation of the choice probabilities in a random-utility discrete choice model. Section 4 below presents examples of[^2]

M0-correspondences. The excess supply correspondence of a competitive exchange economy with strictly convex preferences is in general an M0-function. Each price vector gives rise to a unique excess supply, but the inverse may be set-valued-multiple price vectors may give rise to (for example) an excess supply of zero. Relaxing strict convexity to convexity but adding weak gross substitutes yields an M-correspondence. A price vector may give rise to multiple excess supplies, but the inverse is pointvalued - each excess supply comes from a unique price vector. The following properties present additional examples.

Property 14. The aggregate supply function associated with a logit model without price normalization is an M0-function. Consider a logit model where there are $n_{x}$ producers of type $x \in \mathcal{X}$ and each producer $x$ produces one unit of good $z$ chosen from a set of goods $\{1, \ldots, N\}$. Producer type $x$ gleans the random profit $\pi_{x z}\left(p_{z}\right)+\varepsilon_{z}$ from producing good $z$, where $\pi_{x z}($.$) is increasing and \left(\varepsilon_{z}\right)_{z \in\{1, \ldots, N\}}$ is an independent-and-identically-distributed random vector with Gumbel distribution. Then the aggregate supply function is a function $Q_{z}: \mathbb{R}^{N} \rightarrow \mathbb{R}^{N}$ given by

$$
\mathbf{Q}_{z}(p)=\sum_{x \in \mathcal{X}} n_{x} \frac{\exp \left(\pi_{x z}\left(p_{z}\right)\right)}{\sum_{z^{\prime}=1}^{N} \exp \left(\pi_{x z^{\prime}}\left(p z^{\prime}\right)\right)}
$$

and is an M0-function.

Property 15. The aggregate supply function associated with a logit model with price normalization is an M-function. In the model of Property 14, assume that the price $p_{N}$ of good $N$ is normalized to equal $\pi$. The aggregate production function restricted and corestricted to $\mathbb{R}^{N-1}$, denoted by $\mathrm{Q}_{z}: \mathbb{R}^{N-1} \rightarrow \mathbb{R}^{N-1}$ and given by

$$
\mathbf{Q}_{z}(p)=\sum_{x \in \mathcal{X}} n_{x} \frac{\exp \left(\pi_{x z}\left(p_{z}\right)\right)}{\exp \left(\pi_{x N}(\pi)\right)+\sum_{z^{\prime}=1}^{N} \exp \left(\pi_{x z^{\prime}}\left(p z^{\prime}\right)\right)}
$$

is an M-function.

### 2.3.2 Inverse Isotonicity Theorems

We introduce the following condition, which is slightly stronger than requiring that the inverse correspondence $\mathrm{Q}^{-1}$ is isotone in the strong set order (a.k.a. Veinott's order, Veinott [36]). 5

Definition 8 (Totally Isotone Inverse). A correspondence $\mathbf{Q}: P \rightrightarrows Q$ has totally isotone inverse if, whenever $q \in \mathrm{Q}(p)$ and $q^{\prime} \in \mathrm{Q}\left(p^{\prime}\right)$ are such that there exists $B \subseteq\{1, \ldots, N\}$ with $p_{z} \leq p_{z}^{\prime}$ for all $z \in B$ and $q_{z} \leq q_{z}^{\prime}$ for all $z \notin B$, we have

$$
\begin{equation*}
q \in \mathbb{Q}\left(p \wedge p^{\prime}\right) \text { and } q^{\prime} \in \mathbb{Q}\left(p \vee p^{\prime}\right) \tag{10}
\end{equation*}
$$[^3]

If we require 10 to hold only for the case $B=\emptyset$, then the inverse correspondence $\mathbf{Q}^{-1}$ is isotone in the strong set order, i.e, whenever $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbf{Q}\left(p^{\prime}\right)$ are such that $q_{z} \leq q_{z}^{\prime}$ for all $1 \leq z \leq N$, we have

$$
q \in \mathbb{Q}\left(p \wedge p^{\prime}\right) \text { and } q^{\prime} \in \mathbb{Q}\left(p \vee p^{\prime}\right)
$$

In this case we say simply that $\mathrm{Q}$ is inverse isotone, a weaker property obviously implied by totally isotone inverse. We can equivalently express the inverse isotonicity of $\mathrm{Q}$, or equivalently the isotonicity of $\mathrm{Q}^{-1}$ in the strong set order, as the requirement that whenever $p \in \mathbf{Q}^{-1}(q)$ and $p^{\prime} \in \mathbf{Q}^{-1}\left(q^{\prime}\right)$ where $q \leq q^{\prime}$, it follows that

$$
p \wedge p^{\prime} \in Q^{-1}(q) \text { and } p \vee p^{\prime} \in Q^{-1}\left(q^{\prime}\right)
$$

The following inverse isotonicity result is the building block for subsequent applications.

Theorem 1. Let $\mathrm{Q}: P \rightrightarrows Q$ satisfy unified gross substitutes. Then the following conditions are equivalent:

(i) $\mathrm{Q}$ is nonreversing (i.e., $\mathrm{Q}$ is a M0-correspondence), and

(ii) $\mathrm{Q}$ has totally isotone inverse.

Proof Assume (i) and consider $q \in \mathbb{Q}(p), q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$, and $B \subseteq\{1, \ldots, N\}$ such that $p_{z} \leq p_{z}^{\prime}$ for all $z \in B$ and $q_{z} \leq q_{z}^{\prime}$ for all $z \notin B$. By unified gross substitutes, one has the existence of $q^{\wedge} \in \mathrm{Q}\left(p \wedge p^{\prime}\right)$ and $q^{\vee} \in \mathrm{Q}\left(p \vee p^{\prime}\right)$ such that

$$
\begin{aligned}
& p_{z} \leq p_{z}^{\prime} \quad \Longrightarrow \quad q_{z} \leq q_{z}^{\wedge} \\
& p_{z}>p_{z}^{\prime} \quad \Longrightarrow \quad q_{z}^{\prime} \leq q_{z}^{\wedge}
\end{aligned}
$$

We have $p_{z}>p_{z}^{\prime} \Longrightarrow z \notin B$, which implies $q_{z} \leq q_{z}^{\prime}$. Combining with the inequalities above, we see that $q_{z} \leq q_{z}^{\wedge}$ holds for any $1 \leq z \leq N$. But then $q \leq q^{\wedge}$ and $p \geq p \wedge p^{\prime}$, so by nonreversingness it follows that $q \in \mathbb{Q}\left(p \wedge p^{\prime}\right)$. A similar reasoning shows that $q^{\prime} \in \mathrm{Q}\left(p \vee p^{\prime}\right)$. We have therefore shown statement (ii).

Conversely, we assume statement (ii) holds and show $\mathrm{Q}$ is nonreversing. Take $p \geq p^{\prime}$ and $q \leq q^{\prime}$ such that $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathrm{Q}\left(p^{\prime}\right)$. Letting $B=\emptyset$, because $\mathrm{Q}$ has totally isotone inverse, we have that $q \in \mathbb{Q}\left(p \wedge p^{\prime}\right)$, which is equivalent to $q \in \mathbb{Q}\left(p^{\prime}\right)$, and $q^{\prime} \in \mathrm{Q}\left(p \vee p^{\prime}\right)$, which is equivalent to $q^{\prime} \in \mathrm{Q}(p)$, which shows (i).

Appendix 14 generalizes this result to partial inverse correspondences. It is an immediate implication that:

Corollary 1. Let $\mathrm{Q}$ be an M0-correspondence. Then the set of prices $\mathrm{Q}^{-1}(q)$ associated with an allocation $q$ is a sublattice of $P$.

Proof Take $p \in \mathbf{Q}^{-1}(q)$ and $p^{\prime} \in \mathbf{Q}^{-1}(q)$. Then $q \leq q$ yields $q \in \mathbf{Q}\left(p \wedge p^{\prime}\right)$ and $q^{\prime} \in \mathrm{Q}\left(p \vee p^{\prime}\right)$.

The inverse image $\mathrm{Q}^{-1}(\tilde{q})$ will often describe an equilibrium. For example, $\mathbf{Q}$ may be the aggregate supply function of a competitive economy and $\tilde{q}$ may be the negative if the aggregate endowment, so that $\mathrm{Q}^{-1}(\tilde{q})$ identifies the set of competitive equilibrium prices. Theorem 1 thus gives us monotone comparative statics results for equilibrium problems, in our example describing how competitive equilibrium prices vary in the endowment.

One can can show that under uniform gross substitutes, $\mathrm{Q}$ is a $\mathrm{M}$-correspondence if and only if it is totally nonreversing.

Theorem 2. Let $\mathrm{Q}: P \rightrightarrows Q$ satisfy unified gross substitutes. Then the following three conditions are equivalent:

(i) $\mathrm{Q}$ is an $M$-correspondence;

(ii) $\mathrm{Q}^{-1}$ is point-valued and isotone where not empty, i.e. $q \in \mathrm{Q}(p), q^{\prime} \in \mathrm{Q}\left(p^{\prime}\right)$ and $q \leq q^{\prime}$ imply $p \leq p^{\prime}$;

(iii) Q is strongly nonreversing.

Proof (i) implies (ii): Assume $\mathrm{Q}$ is a M-correspondence and assume $q \in \mathbb{Q}(p)$, $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$ and $q \leq q^{\prime}$. By Theorem 1, we have $q \in \mathbb{Q}\left(p \wedge p^{\prime}\right)$ and $q^{\prime} \in \mathbb{Q}\left(p \vee p^{\prime}\right)$. Because $\mathbf{Q}$ is injective, it follows that $p=p \wedge p^{\prime}$ and thus $p \leq p^{\prime}$.

(ii) implies (iii): Assume $\mathrm{Q}$ is inverse isotone and assume $\mathrm{q}(p) \leq \mathrm{q}\left(p^{\prime}\right)$ and $p \geq p^{\prime}$. By inverse isotonicity one has $p \leq p^{\prime}$, and thus $p=p^{\prime}$.

(iii) implies (i): Assume $\mathrm{Q}$ is strong nonreversing. Then it is nonreversing and thus $\mathrm{Q}$ is a M0-correspondence. Assume $q \in \mathbb{Q}(p)$ and $q \in \mathbb{Q}\left(p^{\prime}\right)$. By unified gross substitutes, we have $q^{\vee} \in \mathbb{Q}\left(p \vee p^{\prime}\right)$ with $q^{\vee} \leq q$. Because $p \vee p^{\prime} \geq p, p^{\prime}$, strong nonreversingness gives $p=p \vee p^{\prime}=p^{\prime}$. Hence, $p=p^{\prime}$ and thus $\mathrm{q}$ is injective.

## 3 Connections with Existing Theories

### 3.1 Kelso and Crawford's Gross Substitutes

We can connect unified gross substitutes to Kelso and Crawford's well-known definition [20, p. 1486] of substitutes. Translating their definition to our setting of supply correspondences, the correspondence $\mathrm{Q}$ has the Kelso-Crawford substitutes property if, given two price vectors $p$ and $p^{\prime}$ with $p^{\prime} \leq p$, for any $q \in \mathbb{Q}(p)$ there exists $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$ such that $p_{z}=p_{z}^{\prime} \Longrightarrow q_{z}^{\prime} \geq q_{z}$.

Property 16. Unified gross substitutes implies Kelso-Crawford substitutes. It follows immediately from (1) and the definition of Kelso-Crawford substitutes that unified gross substitutes implies the Kelso and Crawford substitutes property.

Appendix A. 3 shows that Kelso and Crawford's definition does not imply unified gross substitutes.

We refer to our notion as unified gross substitutes in order to emphasize the distinction between Kelso and Crawford gross substitutes and our notion, namely that the latter "unifies" the conditions (1) and (2) by requiring them to be satisfied by common $q^{\wedge}$ and $q^{\vee}$. Kelso and Crawford's condition implies there are allocations $q^{\wedge}$ and $q^{\vee}$ satisfying (1) and also allocations $q^{\wedge}$ and $q^{\vee}$ satisfying (2), but allows these allocations to differ.

### 3.2 Polterovich and Spivak's Gross Substitutes

Polterovich and Spivak [29, Definition 1, p. 118] propose a notion of gross substitutes for correspondences. (See Howitt [19] for an intermediate notion.) In our notation and setting, the correspondence $\mathrm{Q}(p)$ satisfies their notion of gross substitutability if, for any price vectors $p \leq p^{\prime}$ and any $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathbb{Q}\left(p^{\prime}\right)$, it is not the case that

$$
q_{z}^{\prime}>q_{z} \quad \forall z \text { s.t. } p_{z}=p_{z}^{\prime}
$$

Polterovich and Spivak's notion thus stipulates that if the prices of some set of goods increase while others remain constant, it cannot be the case that every one of the quantities associated with the latter set strictly increases.

Polterovich and Spivak [29, Lemma 1, p. 123] show that if the correspondence $\mathrm{Q}$ maps from the interior of $\mathbb{R}_{+}^{N}$ into $\mathbb{R}^{N}$, is convex valued and closed valued, and maps compact sets into nonempty bounded sets, then their gross substitutability condition implies (1)-(2). Appendix A.4 shows that our requirement that $P$ be a sublattice of $\mathbb{R}^{N}$ does not suffice for this result, and that in general neither notion implies the other. Polterovich and Spivak [29, p. 119] note that their definition of gross substitutes for correspondences is not preserved under the addition of correspondences, unlike unified gross substitutes.

### 3.3 Berry, Gandhi and Haile's Connected Strict Substitutes

Berry, Gandhi and Haile [5], abbreviated as BGH, examine functions q: $P \rightarrow Q$. They make the follwoing assumptions, which allow them to show that an inverse function is isotone and point-valued:

BGH, Implicit Assumption 0: q is point-valued.

BGH, Assumption 1: q is defined on a Cartesian product of sets.

BGH, Assumption 2.a: q has the gross substitutes property.

BGH, Assumption 2.b: The function defined by

$$
\mathrm{q}_{0}(p):=-\sum_{z=1}^{N} \mathrm{q}_{z}(p)
$$

is weakly decreasing in each $p_{z}$ for $z \in\{1, \ldots, N\}$.

BGH, Assumption 3: For all $B \subseteq\{1, \ldots, N\}, p$ and $p^{\prime}$ such that $p_{z}=p_{z}^{\prime}$ for all $z \in B$ and $p_{z}>p_{z}^{\prime}$ for all $z \notin B$, there exists $\tilde{z} \in B \cup\{0\}$ such that $\mathrm{q}_{\tilde{z}}(p)<\mathrm{q}_{\tilde{z}}\left(p^{\prime}\right)$.

We find it useful to record Berry, Gandhi and Haile's restriction to demand functions as an implicit Assumption 0. Berry, Gandhi and Haile's Assumption 1, that q is defined on a Cartesian produce of Euclidean spaces [5, p. 2094], implies our Assumption 1 that $P$ is a sublattice of $\mathbb{R}^{N}$. Their second assumption [5, p. 2094] (in our notation, and translating from their framing in terms of demand functions to our framing in terms of supply functions) is split here into Assumptions by 2.a and 2.b. Lastly, their Assumption 3 [5, p. 2095] is a connected strict substitutes assumption which expresses that one cannot partition the set of goods into two set of products such that no good in the first set is a substitute for some good in the second set. We have stated this assumption in the equivalent form established in their Lemma 1.

Applying our Theorem 1 gives a variant of Berry, Gandhi and Haile's 5] Theorem 1 which operates under weaker assumptions (more precisely, without their Assumption 3) but delivers a weaker conclusion:6

Corollary 2. Under Berry, Gandhi and Haile's Assumptions 0, 1, 2.a, and 2.b, the function $\mathrm{q}$ is an MO-function and hence the inverse $\mathrm{q}^{-1}$ of $\mathrm{q}$ is isotone in the strong set order, that is $\mathrm{q}(p) \leq \mathrm{q}\left(p^{\prime}\right)$ implies $\mathrm{q}(p)=\mathrm{q}\left(p \wedge p^{\prime}\right)$ and $\mathrm{q}\left(p^{\prime}\right)=\mathrm{q}\left(p \vee p^{\prime}\right)$.

Proof Recall that Property 1 establishes that if the function q satisfies weak gross substitutes, which it does under Assumption 2.a, then it satisfies unified gross substitutes. Using Assumption 2.b and Property 6, we get that $\mathrm{q}$ is also nonreversing, and hence $\mathrm{q}$ is an M0-function.

Applying our Theorem 2 now gives an alternative route to Berry, Gandhi and Haile's Theorem [5] Theorem 1 and Corollary 1.

Corollary 3. Under Berry, Gandhi and Haile's Assumptions 0, 1, 2.a, 2.6 and 3, the function $\mathrm{q}$ is an $M$-function and hence is inverse isotone $\left(\mathrm{q}(p) \leq \mathrm{q}\left(p^{\prime}\right)\right.$ implies $p \leq p^{\prime}$ ) and $\mathrm{q}^{-1}$ is point-valued.

Proof We show that under the additional Assumption 3, the function $\mathrm{q}$ is in addition strongly nonreversing. Indeed, assume $\mathrm{q}(p) \leq \mathrm{q}\left(p^{\prime}\right)$ and $p \geq p^{\prime}$. By nonreversingness, one has $\mathrm{q}(p)=\mathrm{q}\left(p^{\prime}\right)$. Assume $p>p^{\prime}$. Let $B=\left\{z: p_{z}=p^{\prime}\right\} \neq\{1, \ldots, N\}$. By BGH Assumption 3, there exists $z \in B \cup\{0\}$ such that $\mathrm{q}_{z}(p)<\mathrm{q}_{z}\left(p^{\prime}\right)$, a contradiction. Hence $p=p^{\prime}$, giving strong nonreversingness. Theorem 2 then gives the result.[^4]

We can generalize Berry, Gandhi and Haile's result to correspondences.

BGH, Assumption 3': For all $B \subseteq\{1, \ldots, N\}, p$ and $p^{\prime}$ such that $p_{z}=p_{z}^{\prime}$ for all $z \in B$ and $p_{z}>p_{z}^{\prime}$ for all $z \notin B$, and all $q \in \mathbb{Q}(p)$ and $q^{\prime} \in \mathrm{Q}\left(p^{\prime}\right)$ with $q \leq q^{\prime}$, there exists $\tilde{z} \in B \cup\{0\}$ such that $q_{\tilde{z}}<q_{\tilde{z}}^{\prime}$.

Let $\tilde{Q}:\{1\} \times P \rightrightarrows \mathbb{R} \times Q$ be the correspondence, written $\tilde{q} \in \tilde{Q}(\tilde{p})$ constructed from $Q$ by letting $\tilde{p}=(1, p)$ and $\tilde{q}=\left(-\sum_{z=1}^{N} q_{z}, q\right)$. Then $\tilde{Q}$ by construction satisfies constant aggregate output and hence nonreversingingss. An argument analogous to the proof of Corollary 3 establishes that $\mathrm{Q}$ is strongly nonreversing. Theorem 2 then immediately gives:

Corollary 4. Let $\tilde{Q}$ satisfy unified gross substitutes. Then $\tilde{Q}$ is an $M$-function and hence is inverse isotone $\left(\mathrm{q}(p) \leq \mathrm{q}\left(p^{\prime}\right)\right.$ implies $p \leq p^{\prime}$ ) and and $\mathrm{Q}^{-1}$ is point-valued.

Appendix A.5 shows that if the correspondence $\tilde{Q}$ satisfies unified gross substitutes, then so does $Q$.

### 3.4 Topkis' Theorem

When the inverse $\mathrm{Q}^{-1}$ is itself the solution to a maximization problem, we may be able to obtain an inverse isotonicity result via monotone comparative static arguments familiar from Topkis [33, 34]. For example, we may be interested in the supply function of a competitive, multiproduct firm, given by

$$
\begin{equation*}
\mathbf{Q}(p)=\arg \max _{q \in \mathbb{R}_{+}^{N}}\left\{p^{\top} q-c(q)\right\}=\partial c^{*}(p) \tag{11}
\end{equation*}
$$

where $c$ is a convex cost function $c: \mathbb{R}_{+}^{N} \rightarrow \mathbb{R}, c^{*}(p)=\max _{q \in \mathbb{R}_{+}^{N}}\left\{p^{\top} q-c(q)\right\}$ is the indirect profit function, and $\partial c^{*}(p)$ is the subdifferential of $c^{*}$ at $\left.p\right\urcorner \square$

$$
\mathbf{Q}^{-1}(q)=\arg \max _{p \in \mathbb{R}_{+}^{N}}\left\{p^{\top} q-c^{*}(p)\right\}=\partial c(q)
$$

where $\partial c(q)$ is the subdifferential of $c$ at $q$.

We now have two routes to establishing the isotonicity in the strong set order of $\mathrm{Q}^{-1}$. Section 4.1 pursues an approach based on establishing an equivalence between the submodularity of the profit cost function $c^{*}$ and the supply correspondence $\mathrm{Q}=\partial c^{*}$ satisfying unified gross substitutes. Alternatively, we can note that the function $p^{\top} q-c^{*}(p)$ is supermodular in $p$ (given the submodularity of $c^{*}$ ) and exhibits increasing differences, and so $\mathrm{Q}^{-1}$ is increasing in the strong set order (Topkis [33, Theorem 6.1, p. 317]).[^5]

More generally, given a correspondence $\mathbf{Q}: P \rightrightarrows Q$, we can potentially exploit the existence of a function $g(p, q)$ such that the inverse correspondence $\mathrm{Q}^{-1}$ is the solution to the maximization problem

$$
\begin{equation*}
\mathbf{Q}^{-1}(q)=\arg \max _{p \in P} g(p, q) \tag{12}
\end{equation*}
$$

Topkis [33] assumes that $g$ is supermodular in $p$ and has increasing differences in $(p, q)$, which imply the following sufficient condition for his isotonicity result:

$$
\begin{equation*}
q \geq q^{\prime} \Longrightarrow g\left(p \vee p^{\prime}, q\right)-g\left(p^{\prime}, q\right) \geq g\left(p, q^{\prime}\right)-g\left(p \wedge p^{\prime}, q^{\prime}\right) \tag{13}
\end{equation*}
$$

Milgrom and Shannon's [22] weaker assumptions of quasi-supermodularity and single crossing similarly imply

$$
q \geq q^{\prime} \Longrightarrow\left\{\begin{array}{l}
g\left(p, q^{\prime}\right)-g\left(p \wedge p^{\prime}, q^{\prime}\right) \geq 0 \Longrightarrow g\left(p \vee p^{\prime}, q\right)-g\left(p^{\prime}, q\right) \geq 0  \tag{14}\\
g\left(p \vee p^{\prime}, q\right)-g\left(p^{\prime}, q\right) \leq 0 \Longrightarrow g\left(p, q^{\prime}\right)-g\left(p \wedge p^{\prime}, q^{\prime}\right) \leq 0
\end{array}\right.
$$

Both sets of assumptions lead to monotone comparative statics results. In Appendix A. 6 we give two examples showing that our (unified gross substitutes and nonreversingness) conditions for inverse isotonicity do not imply those of Topkis or Milgrom and Shannon, nor do the reverse implications hold. We thus have independent conditions for the case of optimization problems, while we can also view our results as extending the analysis beyond the purview of optimization problems.

## 4 Applications

### 4.1 Profit Maximization

In keeping with our interpretation of $Q$ as a supply correspondence, suppose a competitive multiproduct firm faces output price vector $p \in \mathbb{R}^{N}$ and convex cost function $c: \mathbb{R}^{N} \rightarrow \mathbb{R}$. Given a price $p$, the set of optimal production vectors $\mathrm{Q}(p) \subseteq \mathbb{R}^{N}$ is given by (11). The conjugate of the cost function $c$, denoted by $c^{*}(p)$, is the indirect profit function:

$$
c^{*}(p)=\max _{q \in \mathbb{R}^{N}}\left\{p^{T} q-c(q)\right\}
$$

Note that by Property 11, the arg max correspondence $\mathbf{Q}$ is nonreversing, and hence $\mathbf{Q}$ is a M0-correspondence if and only if it satisfies unified gross substitutes.

The following result, whose proof is given in Appendix A.7, relates unified gross substitutes to the submodularity of the indirect profit function. It offers a continuous counterpart to Ausubel and Milgrom's [3] Theorem 10:

Theorem 3. The following conditions are equivalent:

(i) the indirect profit function $c^{*}$ is submodular, and

(ii) the supply correspondence $\mathrm{Q}(p)=\partial c^{*}(p)$ satisfies unified gross substitutes, and

(iii) the supply correspondence $\mathrm{Q}(p)=\partial c^{*}(p)$ is an M0-correspondence.

Remark 2. We can relax the assumption of perfect competition and accommodate a more general revenue function. Consider a firm whose profit maximization problem is given by

$$
\begin{equation*}
c^{\pi}(p)=\max _{q \in \mathbb{R}^{N}}\left\{\sum_{z=1}^{N} \pi_{z}\left(p_{z}, q_{z}\right)-c(q)\right\} \tag{15}
\end{equation*}
$$

where $c: \mathbb{R}^{N} \rightarrow \mathbb{R}$ is an increasing and strictly convex cost function and each function $\pi_{z}: \mathbb{R}^{2} \rightarrow \mathbb{R}$ is a revenue function that is differentiable, increasing in $p_{z}$ and concave in $q_{z}$ and satisfies $\frac{\partial^{2} \pi_{z}\left(p_{z}, q_{z}\right)}{\partial p_{z} \partial q_{z}}>0$ and $\frac{\partial^{3} \pi_{z}\left(p_{z}, q_{z}\right)}{\partial p_{z} \partial q_{z}^{2}}>0$. The interpretation is that a firm chooses quantities $q_{1} \ldots, q_{N}$ to sell in each of $N$ markets. The total cost of production is given by $c(q)$. Revenue in each market $z$ is given by $\pi_{z}\left(p_{z}, q_{z}\right)$. Market $z$ may be perfectly competitive, in which case we can take $p_{z}$ to be the price in the market. More interestingly, market $z$ may be imperfectly competitive, in which case $p_{z}$ is a demand shifter, with higher values of $p_{z}$ indicating higher revenue and higher marginal revenue for each given quantity.

Appendix B. 4 shows that the supply correspondence $Q$ emanating from (15) satisfies unified gross substitutes if and only if the indirect profit function $c^{\pi}$ is submodular, providing an extension of Theorem 3 to revenue functions $\pi_{z}\left(p_{z}, q_{z}\right)$ that are more general than $\pi_{z}\left(p_{z}, q_{z}\right)=p_{z} q_{z}$.

Remark 3. Gul and Stacchetti 16, Theoren 1, p, 99] show that in their context of utility maximization with indivisible goods (so that an individual consumes either zero or one unit of each good and a consumption bundle is a list of which goods are consumed), gross substitutes is equivalent to each of two additional properties that they introduce, namely no complementarities and single improvement. Their nocomplementarities condition stipulates that if $X$ and $Y$ are both optimal consumption bundles and $Z \subset X \backslash Y$, then one can also obtain an optimal consumption bundle by removing the goods $Z$ from the set $X$ and adding some elements of $Y$. For the case of divisible goods, Galichon et al. 14] offer the following continuous counterpart, which requires the optimality of only one of the two bundles $8^{8}$

Definition 9 (No Complementarities). The correspondence $\mathrm{Q}(p)$ satisfies the no complementarities property if whenever $q \in Q(p)$ and $q^{\prime} \neq q$, then for each $\delta_{1}$ such that $0 \leq \delta_{1} \leq\left(q^{\prime}-q\right)^{+}$, there exists $\delta_{2}$ such that $0 \leq \delta_{2} \leq\left(q-q^{\prime}\right)^{+}$such that

$$
p^{\top}\left(q^{\prime}+\delta_{2}-\delta_{1}\right)-c\left(q^{\prime}+\delta_{2}-\delta_{1}\right) \geq p^{\top} q^{\prime}-c\left(q^{\prime}\right)
$$[^6]

When applied to the special case in which $q, q^{\prime} \in Q(p)$, the result is the functional equivalent of Gul and Stacchetti's condition, in that we begin with the optimal allocations $q$ and $q^{\prime}$, and then construct a new optimal allocation by adding to $q^{\prime}$ in some dimensions $z$ in which $q_{z}^{\prime}<q_{z}$ and subtracting from $q^{\prime}$ in some dimensions $z$ in which $q_{z}^{\prime}>q_{z}$. Galichon et al. [14] prove the following. $9^{9}$

Theorem 4. Assume $c(q)$ is convex. The correspondence $\mathrm{Q}$ defined in (11) satisfies unified gross substitutes if and only if it satisfies no complementarities.

### 4.2 Structures of Solutions

It is a familiar result that if each agent's (point-valued) demand function in an exchange economy satisfies strict gross substitutes, then that economy has a unique equilibrium (e.g., Arrow and Hahn [2, Chapter 9]). In more general settings that allow for set-valued demand and supply functions, the proximate notion of a unique equilibrium is that the set of equilibrium prices forms a lattice. Since Walras law implies nonreversingness (Property 9), we have the result that if the excess supply correspondence $\mathrm{Q}$ satisfies unified gross substitutes, then the set of equilibrium prices is a sublattice. Polterovich and Spivak [29, Corollary 1, p. 125] similarly show that the set of equilibrium prices in an exchange economy satisfying their gross substitutes condition is a lattice. Gul and Stacchetti [16, Corollary 1, p. 105] have a similar result for economies with indivisible goods.

In the point-valued case, the notion of subsolutions (a price vector $p$ such that $Q(p) \leq 0$ (or any other exogenously-specified value) and supersolutions (a price vector $p$ such that $Q(p) \geq 0$ ) play an important role. One can show in particular that if $Q$ is continuous and satisfies weak gross substitutes, then any subsolution $p$ that is not a solution, is such that there exists another subsolution $p^{\prime}$ such that $p<p^{\prime}$. As a result, if an iterative method produces a sequence of subsolutions $p_{k}$ that increases "enough," in the sense that the set of subsolutions that dominate $p_{k}$ shrinks, one may show that it converges to a solution. As our larger goal is to provide iterative methods for correspondences, we investigate set-valued extensions of these notions. Appendix B. 6 reports first steps in this broader research agenda.

### 4.3 An Equilibrium Flow Problem

Network. Consider a network $(\mathcal{Z}, \mathcal{A})$ where $\mathcal{Z}$ is a finite set of nodes and $\mathcal{A} \subseteq \mathcal{Z} \times \mathcal{Z}$ is the set of directed arcs. If $x y \in \mathcal{A}$, we say that $x y$ is the arc from $x \in \mathcal{Z}$ to $y \in \mathcal{Z}$,[^7]and we say that $x$ is the starting point of the arc, while $y$ is its end point. We assume that there is no arc in $\mathcal{A}$ whose starting point coincides with the end point. We describe the network with an $|\mathcal{A}| \times|\mathcal{Z}|$ arc-node incidence matrix matrix $\nabla$, defined by letting, for $x y \in \mathcal{A}$ and $z \in Z$

$$
\nabla_{x y, z}=\mathbf{1}_{\{z=y\}}-\mathbf{1}_{\{z=x\}}
$$

We thus have $\nabla_{x y, z}=1$ if $x y$ is an arc ending at $z$, and $\nabla_{x y, z}=-1$ if $x y$ is an arc beginning at $z$. Otherwise $\nabla_{x y, z}=0$.

Prices, connection functions. Let $p \in \mathbb{R}^{\mathcal{Z}}$ be a price vector, where we interpret $p_{z}$ as the price at node $z$. To have a concrete description, though we do not require this interpretation, one may consider a trader operating on node $x y$, who is able to purchase one unit of a commodity at node $x$, ship it along arc $x y$ toward node $y$, and resell it at node $y$. Given the resale price at node $y$, there is a certain threshold value of the price at node $x$ such that the trader is indifferent between engaging in the trade or not. This value is an increasing and continuous function of the price at node $y$, and can be expressed as $G_{x y}\left(p_{y}\right)$, where for each arc $x y \in \mathcal{A}$, the function $G_{x y}: \mathbb{R} \rightarrow \mathbb{R}$ is continuous and increasing, and called the connection function. ${ }^{10}$ Hence, if $p_{x}>G_{x y}\left(p_{y}\right)$, the purchase price at node $x$ is excessive, and the trader will not engage in the trade. On the contrary, if $p_{x}<G_{x y}\left(p_{y}\right)$, the purchase price is strictly below indifference level and positive rent can be made from the trade on the arc $x y$.

Our framework allows for any situation where the per-unit rent $\Pi_{x y}\left(p_{x}, p_{y}\right)$ of the trade on arc $x y$ is a continuous and possibly nonlinear function of $p_{x}$ and $p_{y}$, increasing in the resale price $p_{y}$ and decreasing in the purchase price $p_{x}$. In that case, $G_{x y}\left(p_{y}\right)$ is implicitly defined from $\Pi_{x y}$ by $G_{x y}\left(p_{y}\right)=\Pi_{x y}\left(., p_{y}\right)^{-1}(0)$, or equivalently, $\Pi_{x y}\left(G_{x y}\left(p_{y}\right), p_{y}\right)=0$

Example 1 (Additive case). A simple example of connection function assumes linear surplus for the trader, in which case the per-unit profit of the trader on arc $x y$ is $p_{y}-p_{x}-c_{x y}$ where $c_{x y}$ is the unit shipping cost from $x$ to $y$, and the indifference price at $\operatorname{arc} x$ is

$$
\begin{equation*}
G_{x y}\left(p_{y}\right)=p_{y}-c_{x y} \tag{16}
\end{equation*}
$$

We refer to this as the additive case.

Exiting flow, internal flow, mass balance. Let $q \in \mathbb{R}^{\mathcal{Z}}$ with $\sum_{z \in \mathcal{Z}} q_{z}=0$ attach a net flow to each node $z \in \mathcal{Z}$. If $q_{z}>0$, then the net quantity $\left|q_{z}\right|$ must flow into node $z$, while $q_{z}<0$ indicates that the net quantity $\left|q_{z}\right|$ must flow away from node $z$. Hence, we call $q$ the vector of exiting flows. We let $\mu \in \mathbb{R}_{+}^{\mathcal{A}}$ be the vector of internal flows along arcs, so that $\mu_{x y}$ is the flow through arc $x y$. The feasibility condition[^8]connecting these notions is that, for any $z \in \mathcal{Z}_{0}$, the total internal flow that arrives at $z$ minus the total internal flow that leaves $z$ equals the exiting flow at $z$, that is

$$
\sum_{x: x z \in \mathcal{A}} \mu_{x z}-\sum_{y: z y \in \mathcal{A}} \mu_{z y}=q_{z}
$$

which we call the mass balance equation, and which can be rewritten as

$$
\begin{equation*}
\nabla^{\top} \mu=q \tag{17}
\end{equation*}
$$

The interpretation of these flows will depend on the application of the equilibrium flow problem. The flows may represent quantities of commodities, volumes of traffic, assignments of objects, matches of individuals, and so on.

Equilibrium flow. The triple $(q, \mu, p) \in \mathbb{R}^{\mathcal{Z}} \times \mathbb{R}_{+}^{\mathcal{A}} \times \mathbb{R}^{\mathcal{Z}}$ is an equilibrium flow outcome if it satisfies three conditions. The first condition is the conservation of the flow given by the mass balance equation (17). The second condition is that there there is no positive rent on any arc, that is:

$$
p_{x} \geq G_{x y}\left(p_{y}\right) \quad \forall x y \in \mathcal{A}
$$

Our third condition is that arcs with negative rents carry no flow. Hence $\mu_{x y}>$ $0 \Longrightarrow p_{x} \leq G_{x y}\left(p_{y}\right)$, which combines with no-positive-rent requirement to yield $\mu_{x y}>0 \Longrightarrow p_{x}=G_{x y}(p)$. This is a complementary slackness condition, which can be written

$$
\sum_{x y \in \mathcal{A}} \mu_{x y}\left(p_{x}-G_{x y}\left(p_{y}\right)\right)=0
$$

The interpretation of these rent conditions will again depend on the application. In some cases, they will be the counterparts of zero-profit conditions in markets with entry, while in other cases they will play the role of incentive constraints.

In summary, we define:

Definition 10 (Equilibrium Flow Outcome). The triple $(q, \mu, p) \in \mathbb{R}^{\mathcal{Z}} \times \mathbb{R}_{+}^{\mathcal{A}} \times \mathbb{R}^{\mathcal{Z}}$ is an equilibrium flow outcome when the following conditions are met:

$$
\begin{aligned}
& \text { (i) } \nabla^{\top} \mu=q \\
& \text { (ii) } p_{x} \geq G_{x y}\left(p_{y}\right) \quad \forall x y \in \mathcal{A} \\
& \text { (iii) } \sum_{x y \in \mathcal{A}} \mu_{x y}\left(p_{x}-G_{x y}\left(p_{y}\right)\right)=0
\end{aligned}
$$

The first condition implies $\sum_{z \in \mathcal{Z}} q_{z}=0$. Notice that if $p$ satisfies condition (ii), then setting $q=0$ and $\mu=0$ ensures that the remaining conditions are satisfied. Indeed, if $(q, \mu, p)$ is a equilibrium flow outcome, then so is $(\lambda q, \lambda \mu, p)$ for any nonnegative scalar $\lambda$. Hence, there will either be no equilibrium flow outcome (if there is no $p$ satisfying condition (ii)) or there will be multiple equilibrium flows outcomes. Figure 2 presents a simple example of an equilibrium flow outcome.

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-23.jpg?height=461&width=770&top_left_y=293&top_left_x=683)

Figure 2: A simple example of equilibrium flow outcome. The three equilibrium conditions are satisfied as (i) the flow balance condition is satisfied at each node of the network (ii) there is no arbitrage on the network (iii) when there is a trade on an arc ( $\mu$ larger than zero on this arc), rent on this arc is nonnegative.

Example 1 (continued). Consider the network $(\mathcal{Z}, \mathcal{A})$, with the node-arc incidence matrix $\nabla$ and the additive rent function $G_{x y}\left(p_{y}\right)=p_{y}-c_{x y}$. In this additive case, the no-positive-rent condition rewrites as $p_{y}-p_{x} \leq c_{x y} \forall x y \in \mathcal{A}$. Let $q$ be a vector of exit flows. A triple $(q, \mu, p)$ is then an equilibrium flow outcome if

(i) $\quad \nabla^{T} \mu=q$

(ii) $\quad(\nabla p)_{a} \leq c_{a} \quad \forall a \in \mathcal{A}$

(iii) $\mu_{a}>0 \Longrightarrow(\nabla p)_{a}=c_{a} \quad \forall a \in \mathcal{A}$.

These conditions are exactly the optimality conditions associated with the linear programming problem which consists of minimizing $\mu^{\top} c$ subject to $\mu \geq 0$ and $\nabla^{\top} \mu=q$, which has dual $\max _{p}\left\{p^{\top} q: \nabla p \leq c\right\}$. This problem is well-known as the minimumcost flow problem (see e.g. Ahuja, Magnanti and Orlin [1). We can interpret the problem as one in which each source node $z$ contains an amount $-q_{z}$ of material (soil, in the original incarnation of the problem by Monge [23]), with the objective being to minimize the cost of transporting $q_{\tilde{z}}$ of this material to each destination $\tilde{z}$.

Example 2 (Nonadditive shortest path problem). Our setting allows for a natural extension of the well-known (additive) shortest path problem of Bellman [4]. The shortest path problem is an instance of the minimum-cost flow problem described in the example above, with a single origin or source node $o \in \mathcal{Z}$ and a single destination node $d \in \mathcal{Z}$, and $q_{z}=1_{\{z=d\}}-1_{\{z=o\}}$. In that case, the additive shortest path problem consists of looking for the path from $o$ to $d$ through the network with the smallest sum of arc costs.

We introduce our nonadditive extension by assuming that $p_{z}$ measures the time of passage at node $z$. Fixing $p_{d}$, which is the arrival time at the destination node $d$, one seeks the latest departure from the origin node $o$ consistent with arriving at the destination at no later than time $p_{d}$. The innovation allowed by the equilibrium flow
formulation is that we can allow the duration of the travel though arc $a$ to depend on the tine the arc is reached, which we can interpret as reflecting the state of traffic, or discrete times of passage of the means of transportation, and so on.

More formally, if a traveler on arc $x y$ aims at arriving at node $y$ at time $p_{y}$, then she must leave node $x$ no later than time $p_{x}=G_{x y}\left(p_{y}\right)$. To avoid time travel, we assume throughout that the various functions $G_{x y}: \mathbb{R} \rightarrow \mathbb{R}$ are increasing and satisfy $G_{x y}\left(p_{y}\right)<p_{y}$. As one can arrive at node $y$ at time $p_{y}$ by leaving no sooner than $p_{x}$, the equilibrium should satisfy the condition

$$
p_{x} \geq G_{x y}\left(p_{y}\right)
$$

At equilibrium, we have

$$
\mu_{x y}>0 \quad \Longrightarrow \quad p_{x}=G_{x y}\left(p_{y}\right)
$$

which ensures that if arc $x y$ is visited, the time of departure is consistent with the date of arrival.

Equilibrium flow correspondence. Given an equilibrium flow problem, let the equilibrium flow correspondence be the correspondence between prices $p$ and quantities $q$ that appear in an equilibrium flow. More formally:

Definition 11 (Equilibrium flow correspondence). The equilibrium flow correspondence is the correspondence $\mathbf{Q}: P \rightrightarrows \mathbb{R}^{\mathcal{Z}}$ defined by the fact that for $p \in P, \mathbb{Q}(p)$ is the set of $q \in \mathbb{R}^{\mathcal{Z}}$ such that there is a flow $\mu$ such that $(q, \mu, p)$ is an equilibrium flow outcome.

Appendix A. 8 proves:

Theorem 5. The equilibrium flow correspondence $\mathrm{Q}: \mathbb{R}^{\mathcal{Z}} \rightrightarrows \mathbb{R}^{\mathcal{Z}}$ satisfies unified gross substitutes.

It is immediate that the correspondence $\mathbf{Q}$ is nonreversing, since $q \in \mathbb{Q}(p)$ implies $\sum_{z \in \mathcal{Z}} q_{z}=0$. Hence it follows from Theorem 5 , the inverse isotonicity Theorem 1. and Corollary 1 that:

Corollary 5. The equilibrium flow correspondence $\mathrm{Q}(p)$ has totally isotone inverse and the set of equilibrium prices $\mathrm{Q}^{-1}$ is a sublattice of $\mathbb{R}^{\mathcal{Z}}$.

Galichon, Samuelson and Vernet [15] provide an existence result for the equilibrium flow problem, invoking a generalization of Hall's [17] conditions and an analogue of Rochet's [30] cyclical monotonicity condition.

### 4.4 Matching with (Fully or Imperfectly) Transferable Utility

To put our equilibrium flow formulation to work, consider the following one-to-one matching market with either fully or imperfectly transferable utility. Let $\mathcal{X}$ be a set of types of workers and $\mathcal{Y}$ a set of types of firms. There are $n_{x}$ workers of each type $x \in \mathcal{X}$, and $m_{y}$ firms of each type $y \in \mathcal{Y}$. Assume the total number of workers and firms is the same, or

$$
\sum_{x \in \mathcal{X}} n_{x}=\sum_{y \in \mathcal{Y}} m_{y}
$$

A match between worker type $x$ and firm type $y$ is characterized by a wage $w_{x y}$, in which case it gives rise to the utilities $\mathcal{U}_{x y}\left(w_{x y}\right)$ for the worker and $\mathcal{V}_{x y}\left(w_{x y}\right)$ for the firm.

A matching is a pair $(\mu, w)$, where $w$ is a vector specifying the wage $w_{x y}$ attached to each pair $x y \in \mathcal{X} \times \mathcal{Y}$ and $\mu$ is a vector identifying the mass $\mu_{x y}$ of matches between workers of type $x$ and firms of type $y$, for each $x y \in \mathcal{X} \times \mathcal{Y}$. The matching $(\mu, w)$ is stable if

$$
\begin{equation*}
\sum_{y \in \mathcal{Y}} \mu_{x y}=n_{x} \text { and } \sum_{x \in \mathcal{X}} \mu_{x y}=m_{y} \tag{18}
\end{equation*}
$$

and

$$
\begin{equation*}
\mu_{x y}>0 \text { implies } y \in \arg \max _{y \in \mathcal{Y}} \mathcal{U}_{x y}\left(w_{x y}\right) \text { and } x \in \arg \max _{x \in \mathcal{X}} \mathcal{V}_{x y}\left(w_{x y}\right) \tag{19}
\end{equation*}
$$

The first condition provides the feasibility condition that the number of each type of worker and firm that is matched equals the number present in the market, while the second provides the stability condition that no worker and firm can improve their utilities by matching with one another at an appropriate wage.

Now let $\mathrm{Q}$ be a correspondence identifying, for each specification of utilities, the configurations of workers and firms for which there exists a stable match exhibiting those utilities. More formally, let $\mathcal{Z}=\mathcal{X} \cup \mathcal{Y}$ and fix the utility vector $u: \mathcal{Z} \rightarrow \mathbb{R}$. Let $p \in \mathbb{R}^{\mathcal{Z}}$ be defined by $p_{z}=u_{z} \mathbf{1}_{\{z \in \mathcal{X}\}}-v_{z} \mathbf{1}_{\{z \in \mathcal{Y}\}}$, and $q_{z}=-n_{z} \mathbf{1}_{\{z \in \mathcal{X}\}}+m_{z} \mathbf{1}_{\{z \in \mathcal{Y}\}}{ }^{11}$ The stability problem then reformulates as

$$
q \in \mathbb{Q}(p)
$$

where $\mathbb{Q}(p)$ is the set of $q \in \mathbb{R}^{\mathcal{Z}}$ such that there exists $w \in \mathbb{R}^{\mathcal{X} \times \mathcal{Y}}$ and $\mu \in \mathbb{R}_{+}^{\mathcal{X}} \times \mathcal{Y}$ with $\sum_{y \in \mathcal{Y}} \mu_{x y}=-q_{x}$ for all $x \in \mathcal{X}$ and $\sum_{x \in \mathcal{X}} \mu_{x y}=q_{y}$ for all $y \in \mathcal{Y}$ and also 19)[^9]

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-26.jpg?height=365&width=537&top_left_y=300&top_left_x=794)

Figure 3: Network associated with a bipartite matching problem without singles.

is satisfied with $p_{z}=\max _{y \in \mathcal{Y}} \mathcal{U}_{x y}\left(w_{x y}\right)$ for $z \in \mathcal{X}$ and $-p_{z}=\max _{x \in \mathcal{X}} \mathcal{V}_{x y}\left(w_{x y}\right)$ for $z \in \mathcal{Y}$.

As a immediate result of the equilibrium flow formulation illustrated in Figure 3, it follows from Theorem 5 that:

Theorem 6. The correspondence that maps the vector of payoffs $p$ to the vector of populations $q$ is an M0-correspondence.

As noted in Galichon [13, Section 4.3.2], it may be paradoxical to see substituability arise in matching problems, given that the latter are meant to capture complementarity. However, the "change-of-sign" technique applied here, consisting of adding a negative sign in front of $v_{y}$ and in front of $n_{x}$, allows one to turn a problem with complementarity into a problem with substitutes. This exploits the bipartite nature of the problem. $\sqrt{12}$

Remark 4 (Equilibrium utilities constitute a lattice). Appendix A.9 generalizes this matching problem to accommodate unmatched agents, showing it is equivalent to an equilibrium flow problem. Theorem 5 again applies, and in each case Corollary 5 then implies that $\mathrm{Q}$ is an $\mathrm{M} 0$-correspondence. Hence, given a specification $q$ of buyers and sellers, the set of equilibrium utilities consistent with a stable match constitutes a lattice, providing an alternative route to the lattice result of Demange and Gale 99, Lemma 2 and Property 2].

Remark 5 (Comparative Statics). Once again, the inverse isotonicity of the equilibrium correspondence gives comparative static results. For example, as the number of firms increases, the set of equilibrium payoffs of firms decreases (in the strong set order) while set set of equilibrium payoffs of workers increases. An increase in the number of workers has the reverse effects. This result is proven in [10].

### 4.5 Matching Without Transfers

We now consider bipartite matching with non-transferable utility. We borrow the traditional language of "men" and "women" and heterosexual unions. Let $\mathcal{X}$ the set[^10]of men and $\mathcal{Y}$ be the set of women. Let $\mathcal{X}_{0}=\mathcal{X} \cup\{0\}$ be the set of marital options available to women, where 0 is being unmatched, and similarly let $\mathcal{Y}_{0}=\mathcal{Y} \cup\{0\}$ be the set of marital options available to men.

A match between a man $x \in \mathcal{X}$ and a woman $y \in \mathcal{Y}$ generates utility $\alpha_{x y}$ for the man and $\gamma_{x y}$ for the woman; if $x$ remains unmatched he receives $\alpha_{x 0}$, while if $y$ remains unmatched, she receives $\gamma_{0 y}$. As is common in the literature, we impose strict preferences:

Assumption 2. Strict preferences. $\alpha_{x y} \neq \alpha_{x y^{\prime}}$ for every $x \in \mathcal{X}$ and $y \neq y^{\prime} \in \mathcal{Y}_{0}$, and $\gamma_{x y} \neq \gamma_{x^{\prime} y}$ for every $y \in \mathcal{Y}$ and $x \neq x^{\prime} \in \mathcal{X}_{0}$.

Matchings, feasible matchings. A matching $\mu=\left(\mu_{x y}, \mu_{x 0}, \mu_{0 y}\right)$ is such that $\mu_{x y}=1$ if man $x$ and woman $y$ are matched and equals 0 otherwise, $\mu_{x 0}=1$ if man $x$ remains unmatched and 0 otherwise, and $\mu_{0 y}=1$ if woman $y$ remains unmatched, and 0 otherwise. A feasible matching is such that each individual has at most one partner, that is

$$
\sum_{y \in \mathcal{Y}_{0}} \mu_{x y}=1 \text { and } \sum_{x \in \mathcal{X}_{0}} \mu_{x y}=1
$$

Given a feasible matching $\mu$, one introduces

$$
\begin{equation*}
u_{x}^{\mu}=\sum_{y \in \mathcal{Y}_{0}} \mu_{x y} \alpha_{x y} \text { and } v_{y}^{\mu}=\sum_{x \in \mathcal{X}_{0}} \mu_{x y} \gamma_{x y} \tag{20}
\end{equation*}
$$

which are the utilities obtained by each individual under this matching.

Stable matchings. A stable matching is a feasible matching such that there is no pair $x y \in \mathcal{X} \times \mathcal{Y}$ for which $\alpha_{x y}>u_{x}^{\mu}$ and $\gamma_{x y}>v_{y}^{\mu}$ and such that $u_{x} \geq \alpha_{x 0}$ for all $x \in \mathcal{X}$ and $v_{y} \geq \gamma_{0 y}$ for all $y \in \mathcal{Y}$.

Define $Q: \mathbb{R}^{\mathcal{Y}} \rightarrow \mathbb{Z}^{\mathcal{Y}}$ by

$$
\mathbf{Q}_{y}(v):=1-\sum_{x \in \mathcal{X}} \mathbf{1}_{\left\{y \in \arg \max _{y \in \mathcal{Y}}\left\{\alpha_{x y}: \gamma_{x y} \geq v_{y}, \alpha_{x 0}\right\}\right\}}-\mathbf{1}_{\left\{\gamma_{0 y} \geq v_{y}\right\}}
$$

which can be interpreted as the "excess supply" of type $y$, namely the "supply" of type $y$ (which is one) when this agent is in a relation that secures him a utility $v_{y}$, minus the the number of agents $x \in \mathcal{X}_{0}$ on the other side of the market who are willing to match with type $y$ (given $y$ 's utility requirement $v_{y}$ ). The following theorem (with proof in Appendix A.10 expresses stable matchings in terms of the function Q.

Theorem 7. Let assumption 2 hold. Then:

(i) If $\mu$ is a stable matching, then $\mathrm{Q}\left(v^{\mu}\right)=0$, with $v^{\mu}$ defined in 20.

(ii) Conversely, if $\mathrm{Q}(v)=0$, then define

$$
\begin{aligned}
& \mu_{x y}=\mathbf{1}_{\left\{y \in \arg \max _{y \in \mathcal{Y}}\left\{\alpha_{x y}: \gamma_{x y} \geq v_{y}, \alpha_{x 0}\right\}\right\}} \\
& \left.\mu_{x 0}=\mathbf{1}_{\left\{0 \in \arg \max _{y \in \mathcal{Y}}\left\{\alpha_{x y}: \gamma_{x y} \geq v_{y}, \alpha_{x 0}\right\}\right\}}\right\} \\
& \mu_{0 y}=\mathbf{1}_{\left\{\gamma_{0 y} \geq v_{y}\right\}},
\end{aligned}
$$

and we have that $\mu=\left(\mu_{x y}, \mu_{x 0}, \mu_{0 y}\right)$ is a stable matching.

This result is useful because we can show that $\mathrm{Q}$ is an $\mathrm{M} 0$-correspondence. Appendix A. 11 proves the following result.

Theorem 8. The map Q defined above defines a (point-valued) M0-correspondence.

This gives us an alternative route to the lattice structure of stable matchings.

### 4.6 Hedonic Pricing

The simplest models of a competitive economy assume that each of a finite number of goods is perfectly divisible and perfectly homogeneous. The hedonic pricing model, introduced by Rosen [32] and developed by Ekeland, Heckman and Nesheim [11]) and Chiappori, McCann and Nesheim [8] (among others), examines the opposite extreme, examining an economy filled with indivisible, idiosyncratic goods. To reduce the dimensionality of the prices in the latter case, one typically assumes the goods can be described by the extent to which they exhibit certain characteristics, with prices determined by these characteristics, thus giving rise to the term hedonic pricing.

Chiappori, McCann and Nesheim [8] show the the hedonic pricing problem with quasilinear utilities is equivalent to a matching problem with transferable utility, which is in turn equivalent to an optimal transport problem. They then draw on familiar results to establish that the optimal transport problem has an equilibrium, and hence so do the the associated matching and hedonic pricing problems.

We examine the hedonic pricing problem without assuming that utilities are quasilinear. Chiappori, McCann and Nesheim [8] invoke a twist condition to establish the uniqueness for equilibrium for the quasilinear case. Our counterpart of this result is to establish that for any equilibrium allocation, the set of utilities and prices supporting this equilibrium allocation is a lattice. We avoid a host of technical difficulties by working with finite sets of agents and goods.

Consumers and producers. The basic elements of the model are a set $\mathcal{X}$ of types of producers and a set $\mathcal{Y}$ of types of consumers. There are $n_{x}$ producers of each type $x \in \mathcal{X}$ and $m_{y}$ consumers of each type $y \in \mathcal{Y}$. We do not require that the total number of producers $\sum_{x \in \mathcal{X}} n_{x}$ equal the total number of consumers $\sum_{y \in \mathcal{Y}} m_{y}$.

Qualities. There is a finite set $\mathcal{W}$ of qualities, also sometimes referred to as contracts or characteristics. Each producer must choose to produce one of the qualities in $\mathcal{W}$, or to remain inactive. Each consumer must choose to consume one quality in $\mathcal{W}$ or remain inactive. We can interpret the set $\mathcal{W}$ as the set of possible (vectors of) characteristics of goods that determine prices.

Hedonic prices. Let $p: \mathcal{W} \rightarrow \mathbb{R}$ be a price vector assigning prices to qualities, with $p_{w}$ denoting the price of quality $w$. A producer of type $x$ who produces a quality $w$ that bears price $p_{w}$ earns the profit $\pi_{x w}\left(p_{w}\right)$. A consumer of type $y$ who consumes a quality $w$ bearing price $p_{w}$ reaps surplus $s_{y w}\left(p_{w}\right)$.

Indirect utilities. Given the price function $p$, a producer of type $x$ solves

$$
\max _{w \in \mathcal{W}}\left\{\pi_{x w}\left(p_{w}\right), 0\right\}=: u_{x}(p)
$$

and a consumer solves of type $y$ solves

$$
\max _{w \in \mathcal{W}}\left\{s_{y w}\left(p_{w}\right), 0\right\}=: v_{y}(p)
$$

Supply and demand allocations. Introduce $\mu_{x w}$ as the number of producers of type $x$ producing quality $w$, and $\mu_{w y}$ as the number of consumers of type $y$ consuming quality $w$. Complete this notation by introducing $\mu_{x 0}$ and $\mu_{0 y}$ as respectively the number of consumers of type $x$ and producers of type $y$ opting out. Necessarily if $\mu_{x w}>0$, it must hold that $\pi_{x w}\left(p_{w}\right)=u_{x}(p)$, that is, $w$ is produced by $x$ only if producing $w$ is optimal for $x$. Similar considerations apply for the demand allocation.

Hedonic pricing equilibrium. Given the specifications $\left\{n_{x}\right\}_{x \in \mathcal{X}}$ and $\left\{n_{y}\right\}_{y \in \mathcal{Y}}$ of producers and consumers, as well as the functions $\pi: \mathcal{X} \times \mathcal{W} \times \mathbb{R} \rightarrow \mathbb{R}$ and $s: \mathcal{Y} \times \mathcal{W} \times \mathbb{R} \rightarrow \mathbb{R}$, an equilibrium determines the price function $p$ and the specification of which good (if any) is produced by each producer and which good (if any) is consumed by each consumer. In the process, the equilibrium determines the payoff $u_{x}$ of each producer $x$ and $v_{y}$ of each consumer $y$, as well as the quantity $q_{w}$ of each quality $w$ produced.

Definition 12. A price vector $p$ and allocation $\mu$ are $a$ hedonic pricing equilibrium if the attendant utilities of producers and consumers $u_{x}$ and $v_{y}$, the prices of the qualities $p_{w}$, the numbers of producers and consumers $n_{x}$ and $m_{y}$, the excess supply of qualities $q_{w}$, the production flows $\mu_{x w}$, and the consumption flows $\mu_{w y}$ are related by the following relations:

(i) supply and demand allocations are feasible:

$$
\begin{equation*}
\sum_{w \in \mathcal{W}} \mu_{x w}+\mu_{x 0}=n_{x} \text { and } \sum_{w \in \mathcal{W}} \mu_{w y}+\mu_{0 y}=m_{y} \tag{21}
\end{equation*}
$$

(ii) markets balance holds:

$$
\begin{equation*}
q_{w}=\sum_{x \in \mathcal{X}} \mu_{x w}-\sum_{y \in \mathcal{Y}} \mu_{w y} \tag{22}
\end{equation*}
$$

(iii) rents are nonpositive and agents maximize:

$$
\left\{\begin{array}{lll}
u_{x} \geq \pi_{x w}\left(p_{w}\right) & \text { with equality if } & \mu_{x w}>0  \tag{23}\\
v_{y} \geq 0 & \text { with equality if } & \mu_{0 y}>0 \\
v_{y} \geq s_{y w}\left(p_{w}\right) & \text { with equality if } & \mu_{w y}>0 \\
u_{x} \geq 0 & \text { with equality if } & \mu_{x 0}>0
\end{array}\right.
$$

It is shown in Appendix A. 12 that:

Theorem 9. The correspondence that associates the vector $(u, p,-v)$ to the set of vectors $(-n, q, m)$ such that equations (21), (22) and (23) are satisfied for some allocation $\mu \geq 0$ is an MO-correspondence.

The proof of this result is based on a reformulation as an equilibrium flow problem, and the application of Theorem 5. This equilibrium therefore exhibits the lattice structure established in Corollary 1, and we once again obtain comparative static results.. We can again turn to Galichon, Samuelson and Vernet [15] for an existence result.

## 5 Conclusion

The concept of weak gross substitutes plays a prominent role in economic theory. We view the concept of unified gross substitutes as the natural generalization of weak gross substitutes to correspondences. It connects to the literature in multiple points, generalizing some results and unifying others.

The concept of unified gross substitutes allows one to derive the inverse isotonicity and lattice-valued-inverse properties of general correspondences, which in turn gives rise to comparative static results. This provides a tool that should be useful in two directions. First, it should be useful in extending familiar results developed under the assumption of quasilinearity to more general settings. Second, it should allow research to address a broader class of problems. In particular, there is great potential for formulating a variety of problems as special cases of the equilibrium flow problem, allowing immediate application of the implications of unified gross substitutes.

## A Appendix

## A. 1 Aggregation Preserves Unified Gross Substitutes

We prove one of the four implications in the definition of unified gross substitutes, noting that the others follow along similar lines. Fix $p$ and $p^{\prime}$ and let

$$
\begin{aligned}
& q=\lambda q^{1}+\mu q^{2}, \quad q^{1} \in \mathbb{Q}^{1}(p), \quad q^{2} \in \mathbb{Q}^{2}(p) \\
& q^{\prime}=\lambda q^{\prime 1}+\mu q^{\prime 2} \quad q^{\prime 1} \in \mathbb{Q}^{1}\left(p^{\prime}\right), \quad q^{\prime 2} \in \mathbb{Q}^{2}\left(p^{\prime}\right)
\end{aligned}
$$

Because $\mathbb{Q}^{1}$ and $\mathbf{Q}^{2}$ satisfy unified gross substitutes, there exist $q^{\vee 1} \in \mathbb{Q}^{1}\left(p \vee p^{\prime}\right)$ and $q^{\vee 2} \in \mathrm{Q}^{2}\left(p \vee p^{\prime}\right)$ with

$$
\begin{aligned}
& p_{z} \leq p_{z}^{\prime} \quad \Longrightarrow \quad q_{z}^{\vee 1} \leq q_{z}^{\prime 1} \\
& p_{z} \leq p_{z}^{\prime} \quad \Longrightarrow \quad q_{z}^{\vee 2} \leq q_{z}^{\prime 2}
\end{aligned}
$$

But then we have

$$
p_{z} \leq p_{z}^{\prime} \Longrightarrow \lambda q_{z}^{\vee 1}+\mu q_{z}^{\vee 2} \leq \lambda q_{z}^{\prime 1}+\mu q_{z}^{\prime 2}
$$

giving the condition for unified gross substitutes.

## A. 2 The Sum of Two M0-correspondences is Not Always an M0-correspondence

Let $\mathrm{Q}(p)=\{M p\}$ and $\mathrm{Q}^{\prime}(p)=\left\{M^{\top} p\right\}$ be two point-valued correspondences respectively associated with matrices $M$ and $M^{\top}$, where

$$
M=\left(\begin{array}{rr}
5 & -1 \\
-4 & 1
\end{array}\right)
$$

Because $M$ and $M^{\top}$ have positive entries on the diagonal and negative entries off the diagonal, the functions $\mathrm{Q}$ and $\mathrm{Q}^{\prime}$ both satisfy weak gross substitutes and hence unified gross substitutes (cf. Property 1). We have

$$
M^{-1}=\left(\begin{array}{ll}
1 & 1 \\
4 & 5
\end{array}\right)
$$

The inverses of $M$ and $M^{\prime}$ are both composed of positive entries, so $\mathrm{Q}$ and $\mathrm{Q}^{\prime}$ are both inverse isotone and hence nonreversing (Property 10) and hence are M0-correspondences. However,

$$
\left(M+M^{\top}\right)^{-1}=\frac{1}{10}\left(\begin{array}{cr}
-4 & -10 \\
-10 & 20
\end{array}\right)
$$

is not entrywise positive. Hence, the inverse of $Q+Q^{\prime}$ is not isotone and so $Q+Q^{\prime}$ is not an M0-correspondence (Theorem 1). Unified gross substitutes is satisfied (see Property (4) but $\mathrm{Q}+\mathrm{Q}^{\prime}$ is not nonreversing.

## A. 3 Kelso and Crawford's Substitutes Does Not Imply Unified Gross Substitutes

We show that unified gross substitutes is strictly stronger than Kelso and Crawford's notion of gross substitutes.

Let $N=4$ and consider the price vectors

$$
\begin{aligned}
p & =(1,1,2,2) & p \vee p^{\prime} & =(2,2,2,2) \\
p \wedge p^{\prime} & =(1,1,1,1) & p^{\prime} & =(2,2,1,1)
\end{aligned}
$$

Let the supply correspondence be

$$
\begin{aligned}
\mathrm{Q}(p) & =\{(1,0,1,1),(0,1,1,0)\} & \mathrm{Q}\left(p \vee p^{\prime}\right) & =\{(1,1,1,0),(0,1,1,1)\} \\
\mathrm{Q}\left(p \wedge p^{\prime}\right) & =\{(1,0,0,0),(0,0,0,1)\} & \mathrm{Q}\left(p^{\prime}\right) & =\{(1,1,0,1),(0,1,1,0)\}
\end{aligned}
$$

Then Kelso and Crawford's condition holds, but unified gross substitutes fails. The difficulty is that unified gross substitutes requires the allocations $q^{\vee}$ and $q^{\wedge}$ that appear in the two parts of Definition 1 to be identical, while Kelso and Crawford's definition has no counterpart of this requirement.

Note also that $\mathrm{Q}$ is nonreversing, but Kelso and Crawford's condition is not strong enough to ensure total inverse isotonicity, as $(0,1,1,0) \in Q(p)$ and $(0,1,1,0) \in$ $Q\left(p^{\prime}\right)$, yet $(0,1,1,0) \notin Q\left(p \wedge p^{\prime}\right)$.

## A. 4 Unified Gross Substitutes and Polterovich and Spivak's Property Are Independent

The following example shows that Polterovich and Spivak's definition of gross substitutes does not imply unified gross substitutes.

Let $N=4$ and

$$
\begin{aligned}
p & =(1,1,2,2) & p \vee p^{\prime} & =(2,2,2,2) \\
p \wedge p^{\prime} & =(1,1,1,1) & p^{\prime} & =(2,2,1,1)
\end{aligned}
$$

and let the supply correspondence be

$$
\begin{aligned}
\mathrm{Q}(p) & =(0,1,2,1) & \mathrm{Q}\left(p \vee p^{\prime}\right) & =(0,2,2,0) \\
\mathrm{Q}\left(p \wedge p^{\prime}\right) & =(1,0,2,1) & \mathrm{Q}\left(p^{\prime}\right) & =(1,2,2,0)
\end{aligned}
$$

Then Polterovich and Spivak's [29] notion of gross substitutability is satisfied. For each of the four relevant increasing-price comparisons ( $p \wedge p^{\prime}$ to $p, p \wedge p^{\prime}$ to $p^{\prime}, p$ to $p \vee p^{\prime}$ and $p^{\prime}$ to $p \vee p^{\prime}$ ), among the prices that remain constant, there is at least one dimension on which the allocation decreases. However, unified gross substitutes fails. We have $p_{2}<p_{2}^{\prime}$, but $q_{2} \leq q_{2}^{\wedge}$ fails. Similarly, $p_{4}^{\prime}<p_{4}$, but $q_{4}^{\vee} \leq q_{4}^{\prime}$ fails.

We next show that one can have unified gross substitutes without having Peltorovich and Spivak's notion of gross substitutability. Let $N=2$ and

$$
p=(1,1) \quad p^{\prime}=(1,2)
$$

and let the supply correspondence be

$$
\mathbf{Q}(p)=\{(1,0),(3,0)\} \quad \mathbf{Q}\left(p^{\prime}\right)=\{(0,0),(2,0)\}
$$

Then Polterovich and Spivak's [29] notion of gross substitutes fails-as we move from $p$ to $p^{\prime}$, the price of good 2 increases while that of good 1 remains constant, but some
allocations in $\mathrm{Q}\left(p^{\prime}\right)$ supply more good 1 than do some allocations in $\mathrm{Q}(p)$. Unified gross substitutes is satisfied-for every allocation in $\mathrm{Q}\left(p^{\prime}\right)$, there is an allocation in $\mathrm{Q}(p)$ that supplies less good 1 , and for every allocation in $\mathrm{Q}(p)$, there is an allocation in $\mathrm{Q}\left(p^{\prime}\right)$ that supplies more good 1 , which in this simple case exhausts the implications of unified gross substitutes.

## A. 5 Outside Goods and Weighted Monotonicity

Given a correspondence $\mathrm{Q}: P \rightrightarrows Q$, we can introduce a fictitious good 0 with price $p_{0}$ and constants $k \in \mathbb{R}_{++}^{N}$, and define the extended correspondence $\tilde{\mathbb{Q}}: P \times P_{0} \rightrightarrows Q \times \mathbb{R}$ by letting

$$
\tilde{\mathbb{Q}}\left(p, p_{0}\right)=\left\{\left(q, q_{0}\right) \in Q \times \mathbb{R}: q \in E(p), q_{0}=p_{0}-\sum_{z=1}^{N} k_{z} q_{z}\right\}
$$

The obvious candidates for extended correspondences will set $P_{0}=\{1\}$ and each of the constants $k_{z}=1$.

We then have:

Lemma 1. If the extended correspondence $\tilde{Q}$ satisfies unified gross substitutes, then the correspondence $\mathrm{Q}$ satisfies unified gross substitutes and weighted monotonicity.

Proof. Let $\tilde{Q}$, derived from $\mathrm{Q}$ via the constants $k \in \mathbb{R}_{++}^{N}$, satisfy unified gross substitutes. The conditions for $\mathrm{Q}$ to satisfy unified gross substitutes are a subset of the conditions for $\tilde{Q}$ to do so, and hence it is immediate that $\mathrm{Q}$ satisfies unified gross substitutes. Next, fix the price vectors $\left(p, p_{0}\right)$ and $\left(p^{\prime}, p_{0}^{\prime}\right)$. Then applying unified gross substitutes to $\tilde{Q}$, we have

$$
p_{0}<p_{0}^{\prime} \Longrightarrow q_{0} \leq q_{0}^{\wedge} \quad \text { and } q_{0}^{\vee} \leq q_{0}^{\prime}
$$

We then note that $p_{0}=p_{0}^{\wedge}$ and $p_{0}^{\prime}=p_{0}^{\vee}$, and hence

$$
\begin{gathered}
p_{0}-q_{0} \geq p_{0}^{\wedge}-q_{0}^{\wedge} \\
p_{0}^{\prime}-q_{0}^{\prime} \leq p_{0}^{\vee}-q_{0}^{\vee}
\end{gathered}
$$

Applying the definition of the extended correspondence gives

$$
\begin{aligned}
& p_{0}-q_{0} \geq p_{0}^{\wedge}-q_{0}^{\wedge} \quad \Longrightarrow \quad \sum_{z=1}^{N} k_{z} q_{z} \geq \sum_{z=1}^{N} k_{z} q_{z}^{\wedge} \\
& p_{0}^{\prime}-q_{0}^{\prime} \leq p_{0}^{\vee}-q_{0}^{\vee} \quad \Longrightarrow \quad \sum_{z=1}^{N} k_{z} q_{z}^{\vee} \geq \sum_{z=1}^{N} k_{z} q_{z}^{\prime}
\end{aligned}
$$

giving the weighted monotonicity of $\mathrm{Q}$.

## A. 6 Connections with Monotone Comparative Statics

We first present an example in which the correspondence $\mathrm{Q}$ fails unified gross substitutes, but satisfies (12) for a function $g(p, q)$ satisfying (13) and hence Topkis' assumptions, and hence $\mathrm{Q}^{-1}$ is isotone.

Let $P=S=\mathbb{R}^{3}$ and let $\mathrm{Q}(p)=\{Y p\}$ where $Y$ is the matrix

$$
\frac{1}{28}\left[\begin{array}{ccc}
63 & -28 & -28 \\
-28 & 16 & 12 \\
-28 & 12 & 16
\end{array}\right]
$$

It is easy to see that the correspondence $\mathrm{Q}$ is a function that fails weak gross substitutes (because $Y$ has some positive off-diagonal terms), and hence fails unified gross substitutes (cf. Property 1). The inverse is the point-valued correspondence $\mathrm{Q}^{-1}=\{X q\}$ where $X$ is the inverse of $Y$, given by

$$
\left[\begin{array}{lll}
4 & 4 & 4 \\
4 & 8 & 1 \\
4 & 1 & 8
\end{array}\right]
$$

Since $X$ has strictly positive terms, it is immediate that $\mathrm{Q}^{-1}$ is isotone. The function $\mathrm{Q}^{-1}$ is the solution to the maximization problem ${ }^{13}$

$$
\max _{p \in \mathbb{R}^{3}} g(p, q)=\max _{p \in \mathbb{R}^{3}} p X q-\frac{1}{2} p_{1}^{2}-\frac{1}{2} p_{2}^{2}-\frac{1}{2} p_{3}^{2}
$$

The function $g(p, q)=p X q-\frac{1}{2} p_{1}^{2}-\frac{1}{2} p_{2}^{2}-\frac{1}{2} p_{3}^{2}$ is strictly concave and satisfies Topkis' assumptions given in 13 ).

We next present an equilibrium correspondence that satisfies unified gross substitutes and aggregate monotonicity, and hence has an isotone inverse, but for which the corresponding function $g$ satisfying (12) fails the formulation of Milgrom and Shannon's conditions given by (14) (and hence, fails those of Topkis).

Let $P=Q=\mathbb{R}_{+}^{2}$ and let the correspondence $\mathrm{Q}$ be given by

$$
\begin{aligned}
& q_{1}(p)=p_{2} \\
& q_{2}(p)=p_{1}
\end{aligned}
$$

Clearly $\mathrm{Q}$ is point-valued, and satisfies unified gross substitutes and aggregate monotonicity. Let $g(p, q)=1$ if $q=\left(p_{2}, p_{1}\right)$ and $g(p, q)=0$ otherwise, and note that (12) holds. Consider the second implication in (14), namely

$$
g\left(p \vee p^{\prime}, q\right)-g\left(p^{\prime}, q\right) \leq 0 \Longrightarrow g\left(p, q^{\prime}\right)-g\left(p \wedge p^{\prime}, q^{\prime}\right) \leq 0
$$[^11]

## Letting

$$
\begin{aligned}
p=(3,3) & q=(5,2) \\
p^{\prime}=(2,5) & q^{\prime}=(4,1)
\end{aligned}
$$

gives us a violation.

## A. 7 Proof of Theorem 3

We present a proof of Theorem 3 that establishes the equivalence between unified gross substitute of $\partial c^{*}$ and the submodularity of $c$. In order to do this, we prove a series of lemmas regarding convex functions and how to characterize their submodularity. Let $f$ be a convex function. Our interpretation will be that $f$ is an indirect profit function $f=c^{*}$ associated with a cost function $c(q)$, but we will not use that interpretation in the lemmas.

The first result is a well-known result in convex analysis (Theorem 23.4 in Rockafellar [31]), recalled here for convenience, which essentially asserts that the support function of the subdifferential of a convex function coincides with the directional derivatives.

Lemma 2. Let $f: \mathbb{R}^{N} \rightarrow \mathbb{R}$ be a convex function. We have

$$
\partial f(p)=\left\{q \in \mathbb{R}^{N}: q^{\top} b \leq\left.\frac{d}{d t} f(p+t b)\right|_{0^{+}}, \forall b \in \mathbb{R}^{N}\right\}
$$

Proof of Lemma 2. By definition, one has that $\partial f(p)$ is the set of $q \in \mathbb{R}^{N}$ such that the quantity $q^{\top} p^{\prime}-f\left(p^{\prime}\right)$ is maximal for $p^{\prime}=p$. Because $f$ is convex, the function $p^{\prime} \rightarrow q^{\top} p^{\prime}-f\left(p^{\prime}\right)$ is maximal at $p$ if and only if all the directional derivatives at $p$ are nonpositive, thus for all $b \in \mathbb{R}^{N}$,

$$
\left.\frac{d}{d t}\left\{q^{\top}(p+t b)-f(p+t b)\right\}\right|_{0^{+}} \leq 0
$$

or equivalently,

$$
q^{\top} b \leq\left.\frac{d}{d t} c^{*}(p+t b)\right|_{0^{+}}
$$

For $X \subseteq \mathbb{R}^{N}$, define $\tilde{X}$ as the set of vectors of $\mathbb{R}^{N}$ that are dominated by some vector in $X$, or more formally:

$$
\begin{equation*}
\tilde{X}=\left\{\tilde{q} \in \mathbb{R}^{N}: \exists q \in X \text { s.t. } \tilde{q} \leq q\right\} \tag{24}
\end{equation*}
$$

and define the support function of $X$ as

$$
\begin{equation*}
h_{X}(b)=\sup _{q \in X}\left\{q^{\top} b:\right\} \tag{25}
\end{equation*}
$$

Let $\operatorname{cch}(X)$ be the convex closure of $X$, which is the closure of the convex hull of $X$. It is well-known that $c c h(X)$ is the set of elements $x \in \mathbb{R}^{N}$ such that $x^{\top} b \leq h_{X}(b)$ for all $b \in \mathbb{R}^{N}$.

The next result states that the support function of $\tilde{C}$ is the support function of $C$ whose domain has been restricted to nonnegative coordinates.

Lemma 3. If $C$ is a closed convex set of $\mathbb{R}^{N}$, then $\tilde{C}$ as defined in expression (24) can be expressed as

$$
\tilde{C}=\left\{q: q^{\top} b \leq h_{C}(b), \forall b \in \mathbb{R}_{+}^{N}\right\}
$$

where $h_{C}$ has been defined in (25).

Proof of Lemma 3. By the supporting hyperplane theorem, for any convex set $C$ and any boundary point $q_{0}=\arg \max _{q \in C} q^{\top} b$ of the boundary of $C$ there exists a supporting hyperplane for $C$ at $q_{0}$. Therefore one has

$$
C=\left\{q: q^{\top} b \leq h(b), \forall b \in \mathbb{R}^{N}\right\}
$$

Further, note that $\hat{C}=\left\{\hat{q}: \hat{q}^{\top} b \leq \hat{h}(b), \forall b \in \mathbb{R}^{N}\right\}$, where $\hat{h}(b)=h(b)$ if $b \in \mathbb{R}_{+}^{N}$ and $\hat{h}(b)=+\infty$ otherwise, and thus

$$
\hat{h}(b)=\max _{\hat{q} \in \hat{C}} \hat{q}^{\top} b
$$

Now compute $\tilde{h}(b)=\max _{\tilde{q} \in \tilde{C}} \tilde{q}^{\top} b$. One has $\tilde{C}=\left\{q-\delta: q \in C, \delta \in \mathbb{R}_{+}^{N}\right\}$, and so

$$
\tilde{h}(b)=\max _{q \in C} \max _{\delta \geq 0}(q-\delta)^{\top} b
$$

Thus, if $b \in \mathbb{R}_{+}^{N}$, one has $\tilde{h}(b)=\max _{q \in C} q^{\top} b=h(b)$. Now if $b_{z}<0$ for some $z$, one has clearly $\tilde{h}(b)=+\infty$. Hence

$$
\tilde{h}(b)=\hat{h}(b)=h(b)+\iota_{\mathbb{R}_{+}^{N}}(b)
$$

where $\iota_{K}(b)=0$ if $b \in K$ and $\iota_{K}(b)=+\infty$ otherwise. This implies that $\hat{C}$ and $\tilde{C}$ have the same support function, and thus coincide.

From Lemma 3, it follows that:

Lemma 4. The inequality $b^{\top} x \leq h_{X}(b)$ holds for all $b \in \mathbb{R}_{+}^{N}$ if and only if there is $\tilde{x} \in \operatorname{cch}(X)$ with $x \leq \tilde{x}$.

Proof of Lemma 4. First, we assume $b^{\top} x \leq h_{X}(b)$ for all $b \geq 0$, and show that $x \in Y$ where $Y=\left\{x^{\prime}: \exists \tilde{x} \in \operatorname{cch}(X): x^{\prime} \leq \tilde{x}\right\}$. One has $X \subseteq Y$. Consider $h_{Y}(b)$ for $b \in R^{Z}$. First, if $b_{z}<0$ for some $z$, then $h_{Y}(b)=+\infty$. Next, if $b \geq 0$, then $h_{Y}(b)=h_{X}(b)$. Indeed, one has $h_{X}(b) \leq \iota_{Y}^{*}(b)$, but taking $y \in Y$ such that $b^{\top} y$ attains $h_{Y}(b)$, we have
$\iota_{Y}^{*}(b)=b^{\top} y$ and by definition of $y \in Y$, there is $\tilde{x} \in \operatorname{cch}(X)$ such that $y \leq \tilde{x}$. Hence as $b \geq 0, b^{\top} y \leq b^{\top} \tilde{x}$, and as $\tilde{x} \in \operatorname{cch}(X)$, we get $b^{\top} \tilde{x} \leq h_{X}(b)$, thus $h_{Y}(b) \leq h_{X}(b)$. As a result $h_{Y}(b)=h_{X}(b)$ as soon as $b \geq 0$, and we have that

$$
b^{\top} x \leq h_{Y}(b) \text { for all } b \in R^{Z}
$$

and therefore, given that $Y$ is a closed convex set, this implies that $x \in Y$.

Conversely, assume there is $\tilde{x} \in \operatorname{cch}(X)$ with $x \leq \tilde{x}$. Then $\tilde{x}=\int_{0}^{1} x_{t} d \mu(t)$ where $\mu$ is a probability measure on $[0,1]$ and $x_{t} \in X$. Then we have $x_{t}^{\top} b \leq h_{X}(b)$ and thus $x^{\top} b \leq \tilde{x}^{\top} b=\int_{0}^{1} x_{t}^{\top} b d \mu(t) \leq \int_{0}^{1} h_{X}(b) d \mu(t)=h_{X}(b)$.

By combining Lemma 2 and Lemma 3 , we get:

Lemma 5. For a convex function $f: \mathbb{R}^{N} \rightarrow \mathbb{R}$, one has

$$
\begin{equation*}
\left\{\tilde{q} \in \mathbb{R}^{N}: \exists q \in \partial f(p) \text { s.t. } \tilde{q} \leq q\right\}=\left\{q \in \mathbb{R}^{N}: q^{\top} b \leq\left.\frac{d}{d t} f(p+t b)\right|_{0^{+}}, \forall b \in \mathbb{R}_{+}^{N}\right\} \tag{26}
\end{equation*}
$$

and both these values coincide with $\widetilde{\partial f(p)}$.

Proof of Lemma 5. Let the function $h$ in the specification of $\hat{C}$ be given by $h(b)=$ $\left.\frac{d}{d t} f(p+t b)\right|_{0^{+}}$. From Claim 1, we then have $h(b)=\max _{q \in a f(p)} q^{\top} b$ and hence can take $C=\partial f(p)$ in the specification of $\tilde{C}$. The equality of $\hat{C}$ and $\tilde{C}$ established in Lemma 3 then gives the required identity (26).

In the sequel, we shall consider a pair of prices $p$ and $p^{\prime}$ in $\mathbb{R}^{N}$, and for a vector $b \in \mathbb{R}^{N}$, we define two vectors $b^{>}$and $b^{\leq}$in $\mathbb{R}^{N}$ such that

$$
\begin{equation*}
b_{z}^{\leq}=b_{z} 1_{\left\{p_{z} \leq p_{z}^{\prime}\right\}} \text { and } b_{z}^{>}=b_{z} 1_{\left\{p_{z}>p_{z}^{\prime}\right\}} \tag{27}
\end{equation*}
$$

Lemma 6. A function $f: \mathbb{R}^{N} \rightarrow \mathbb{R}$ is submodular if and only if for any $p, p^{\prime}$ in $\mathbb{R}^{N}$, $b \in R_{+}^{N}$ such that $b^{>} \leq\left(p-p^{\prime}\right)^{+}$, one has

$$
f\left(p+b^{\leq}\right)+f\left(p^{\prime}+b^{>}\right)+f\left(p \wedge p^{\prime}\right) \leq f(p)+f\left(p^{\prime}\right)+f\left(p \wedge p^{\prime}+b\right)
$$

Proof of Lemma 6. Suppose $f$ is submodular. Then we have, by the submodularity of $f$,

$$
f(p)+f\left(p \wedge p^{\prime}+b\right) \geq f\left(p \wedge\left(p \wedge p^{\prime}+b\right)\right)+f\left(p \vee\left(p \wedge p^{\prime}+b\right)\right)
$$

However, $p \wedge\left(p \wedge p^{\prime}+b\right)=p \wedge p^{\prime}+b^{>}$and $p \vee\left(p \wedge p^{\prime}+b\right)=p+b^{\leq}$, and so

$$
f(p)+f\left(p \wedge p^{\prime}+b\right) \geq f\left(p \wedge p^{\prime}+b^{>}\right)+f\left(p+b^{\leq}\right)
$$

This implies

$$
f(p)+f\left(p^{\prime}\right)+f\left(p \wedge p^{\prime}+b\right) \geq f\left(p \wedge p^{\prime}+b^{>}\right)+f\left(p^{\prime}\right)+f\left(p+b^{\leq}\right)
$$

Again by the submodularity of $f$, we have

$$
f\left(p \wedge p^{\prime}+b^{>}\right)+f\left(p^{\prime}\right) \geq f\left(\left(p \wedge p^{\prime}+b^{>}\right) \wedge p^{\prime}\right)+f\left(\left(p \wedge p^{\prime}+b^{>}\right) \vee p^{\prime}\right)
$$

and hence

$$
\begin{align*}
& f(p)+f\left(p^{\prime}\right)+f\left(p \wedge p^{\prime}+b\right)  \tag{28}\\
\geq & f\left(\left(p \wedge p^{\prime}+b^{>}\right) \wedge p^{\prime}\right)+f\left(\left(p \wedge p^{\prime}+b^{>}\right) \vee p^{\prime}\right)+f\left(p+b^{\leq}\right)
\end{align*}
$$

But $\left(p \wedge p^{\prime}+b^{>}\right) \wedge p^{\prime}=p \wedge p^{\prime}$ and $\left(p \wedge p^{\prime}+b^{>}\right) \vee p^{\prime}=p^{\prime}+b^{>}$, and therefore (28) becomes

$$
f(p)+f\left(p^{\prime}\right)+f\left(p \wedge p^{\prime}+b\right) \geq f\left(p \wedge p^{\prime}\right)+f\left(p^{\prime}+b^{>}\right)+f\left(p+b^{\leq}\right)
$$

giving the required result.

Conversely, assume we have for all $p, p^{\prime}$ and $b \geq 0$ that

$$
f(p)+f\left(p^{\prime}\right)+f\left(p \wedge p^{\prime}+b\right) \geq f\left(p+b^{\leq}\right)+f\left(p^{\prime}+b^{>}\right)+f\left(p \wedge p^{\prime}\right)
$$

Choose $b$ to be specified by $b^{\leq}=\left(p^{\prime}-p\right)^{+}$and $b^{>}=0$. We have

$$
\begin{aligned}
p \wedge p^{\prime}+b & =p^{\prime} \\
p+b^{\leq} & =p \vee p^{\prime}
\end{aligned}
$$

and thus

$$
f(p)+f\left(p^{\prime}\right) \geq f\left(p \vee p^{\prime}\right)+f\left(p \wedge p^{\prime}\right)
$$

giving the submodularity of $f$.

Lemma 7. A convex function $f: \mathbb{R}^{N} \rightarrow \mathbb{R}$ is submodular if and only if for any $b \in \mathbb{R}_{+}^{N}$

$$
\begin{equation*}
\left.\frac{d}{d t} f\left(p+t b^{\leq}\right)\right|_{0^{+}}+\left.\frac{d}{d t} f\left(p^{\prime}+t b^{>}\right)\right|_{0^{+}} \leq\left.\frac{d}{d t} f\left(p \wedge p^{\prime}+t b\right)\right|_{0^{+}} \tag{29}
\end{equation*}
$$

where $b \leq$ and $b^{>}$are defined in equation 27).

Proof of Lemma 7. Applying Lemma 6, if $f$ is submodular it follows that for $t \geq 0$, we have

$$
f\left(p+t b^{\leq}\right)-f(p)+f\left(p^{\prime}+t b^{>}\right)-f\left(p^{\prime}\right) \leq f\left(p \wedge p^{\prime}+t b\right)-f\left(p \wedge p^{\prime}\right)
$$

and thus, using the convexity of $f$, it follows that

$$
\left.\frac{d}{d t} f\left(p+t b^{\leq}\right)\right|_{0^{+}}+\left.\frac{d}{d t} f\left(p^{\prime}+t b^{>}\right)\right|_{0^{+}} \leq\left.\frac{d}{d t} f\left(p \wedge p^{\prime}+t b\right)\right|_{0^{+}}
$$

The converse holds by integration over $t \in[0,1]$.

Theorem 3, direct implication. If $f$ is submodular then $\partial f(p)$ exhibits unified gross substitutes.

Proof of the direct implication of Theorem 3. Assume $f$ is submodular. Take $q \in$ $\partial f(p)$ and $q^{\prime} \in \partial f\left(p^{\prime}\right)$. We want to show that there exists $q^{\wedge} \in \partial f\left(p \wedge p^{\prime}\right)$ such that

$$
\begin{aligned}
& p_{z} \leq p_{z}^{\prime} \quad \Longrightarrow \quad q_{z} \leq q_{z}^{\wedge} \\
& p_{z}>p_{z}^{\prime} \quad \Longrightarrow \quad q_{z}^{\prime} \leq q_{z}^{\wedge}
\end{aligned}
$$

To show this, we need to show that $q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}}>\leq q^{\wedge}$, i. e, we need to show that $q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}}>\in \widetilde{\partial f}\left(p \wedge p^{\prime}\right)$, where the tilde notation $\widetilde{\partial f}$ was introduced in (24). By Lemma 5, it suffices to show that

$$
\forall b \in \mathbb{R}_{+}^{N}:\left(q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}}>\right)^{\top} b \leq\left.\frac{d}{d t} f\left(p \wedge p^{\prime}+t b\right)\right|_{0^{+}}
$$

In order to do this, take $b \in \mathbb{R}_{+}^{N}$ and express that $q \in \partial f(p)$ and $q^{\prime} \in \partial f\left(p^{\prime}\right)$ by writing

$$
q^{\top} b^{\leq} \leq\left.\frac{d}{d t} f\left(p+t b^{\leq}\right)\right|_{0^{+}} \text {and } q^{\prime \top} b^{>} \leq\left.\frac{d}{d t} f\left(p^{\prime}+t b^{>}\right)\right|_{0^{+}}
$$

and then note that, by summation of these two inequalities we get

$$
\left(q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}>}\right)^{\top} b \leq\left.\frac{d}{d t} f\left(p+t b^{\leq}\right)\right|_{0^{+}}+\left.\frac{d}{d t} f\left(p^{\prime}+t b^{>}\right)\right|_{0^{+}}
$$

and so by Lemma 7, we have

$$
\forall b \in \mathbb{R}_{+}^{N}:\left(q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}>}\right)^{\top} b \leq\left.\frac{d}{d t} f\left(p \wedge p^{\prime}+t b\right)\right|_{0^{+}}
$$

and hence (again, by Lemma 5$) q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}>} \in \widetilde{\partial f}\left(p \wedge p^{\prime}\right)$ as required.

We set $\hat{f}=f(-p)$, and we introduce $\hat{p}=p^{\prime}$ and $\hat{p}^{\prime}=p$. We note that $\hat{f}$ is submodular, and we apply the previous claim to $\hat{p}$ and $\hat{p}^{\prime}$ to get the existence of $q^{\vee} \in \partial f\left(p \vee p^{\prime}\right)$ such that

$$
\begin{aligned}
& p_{z} \leq p_{z}^{\prime} \quad \Longrightarrow \quad q_{z} \geq q_{z}^{\vee} \\
& p_{z}>p_{z}^{\prime} \quad \Longrightarrow \quad q_{z}^{\prime} \geq q_{z}^{\vee}
\end{aligned}
$$

Theorem 3, backward implication. The converse holds, i.e. if $\partial f(p)$ satisfies unified gross substitutes, then $f(p)$ is submodular.

Proof of the backward implication of Theorem 3. Assume unified gross substitutes holds. Then for $q \in \partial f(p)$ and $q^{\prime} \in \partial f\left(p^{\prime}\right)$, there exists $q^{\wedge} \in \partial f\left(p \wedge p^{\prime}\right)$ such that

$$
q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}>} \leq q^{\wedge}
$$

Hence $q \mathbf{1}_{\mathcal{Z} \leq}+q^{\prime} \mathbf{1}_{\mathcal{Z}>} \in \widetilde{\partial f}\left(p \wedge p^{\prime}\right)$, and therefore (using Lemma 3), for all $q \in \partial f(p)$ and $q^{\prime} \in \partial f\left(p^{\prime}\right)$

$$
\forall b \in \mathbb{R}_{+}^{Z}: q^{\top} b^{\leq}+q^{\prime \top} b^{<} \leq\left.\frac{d}{d t} f\left(p \wedge p^{\prime}+t b\right)\right|_{0^{+}}
$$

and thus, by maximizing over $q \in \partial f(p)$ and $q^{\prime} \in \partial f\left(p^{\prime}\right)$, we get

$$
\left.\frac{d}{d t} f\left(p+t b^{\leq}\right)\right|_{0^{+}}+\left.\frac{d}{d t} f\left(p^{\prime}+t b^{>}\right)\right|_{0^{+}} \leq\left.\frac{d}{d t} c^{*}\left(p \wedge p^{\prime}+t b\right)\right|_{0^{+}}
$$

for all $b \geq 0$, hence (by Lemma 7) $f$ is submodular.

## A. 8 Proof of Theorem 5

Let $q \in \mathbf{Q}(p)$ and $q^{\prime} \in \mathbf{Q}\left(p^{\prime}\right)$. Rewriting (1)-(2), it suffices for unified gross substitutes to show that there exists $q^{\vee} \in \mathbb{Q}\left(p \vee p^{\prime}\right)$ and $q^{\wedge} \in \mathrm{Q}\left(p \wedge p^{\prime}\right)$ such that for all $z \in \mathcal{Z}$,

$$
\begin{aligned}
& \mathbf{1}_{\{z \in \mathcal{Z} \leq\}} q_{z}+\mathbf{1}_{\{z \in \mathcal{Z}>\}} q_{z}^{\prime} \leq q_{z}^{\wedge} \\
& \mathbf{1}_{\{z \in \mathcal{Z} \leq\}} q_{z}^{\prime}+\mathbf{1}_{\{z \in \mathcal{Z}>\}} q_{z} \geq q_{z}^{\vee}
\end{aligned}
$$

where we have defined $\mathcal{Z} \leq=\left\{z \in \mathcal{Z}: p_{z} \leq p_{z}^{\prime}\right\}$ and $\mathcal{Z}^{>}=\left\{z \in \mathcal{Z}: p_{z}>p_{z}^{\prime}\right\}$.

First, note that $\mu_{x z}>0$ and $p_{z} \leq p_{z}^{\prime}$ implies $p_{x}^{\prime} \geq G_{x z}\left(p_{z}^{\prime}\right) \geq G_{x z}\left(p_{z}\right)=p_{x}$, which implies

$$
\begin{equation*}
\mu_{x z} \mathbf{1}_{\{z \in \mathcal{Z} \leq\}} \leq \mu_{x z} \mathbf{1}_{\{x \in \mathcal{Z} \leq\}} \tag{30}
\end{equation*}
$$

Similarly, $\mu_{x z}^{\prime}>0$ and $p_{z}>p_{z}^{\prime}$ implies $p_{x} \geq G_{x z}\left(p_{z}\right)>G_{x z}\left(p_{z}^{\prime}\right)=p_{x}^{\prime}$, thus

$$
\begin{equation*}
\mu_{x z}^{\prime} \mathbf{1}_{\{z \in \mathcal{Z}>\}} \leq \mu_{x z}^{\prime} \mathbf{1}_{\{x \in \mathcal{Z}>\}} \tag{31}
\end{equation*}
$$

Given these results, set:

$$
\begin{aligned}
\mu_{x z}^{\wedge} & =1_{\{x \in \mathcal{Z} \leq\}} \mu_{x z}+1_{\{x \in \mathcal{Z}>\}} \mu_{x z}^{\prime} \\
q_{z}^{\wedge} & =\sum_{x} \mu_{x z}^{\wedge}-\sum_{y} \mu_{z y}^{\wedge}
\end{aligned}
$$

We have $\mu_{x y}^{\wedge}>0$ implies $p_{x}=G_{x y}\left(p_{y}\right)$, and, using (30) and (31) for the inequality, we obtain

$$
\begin{aligned}
q_{z}^{\wedge} & =\sum_{x}\left(\mathbf{1}_{\{x \in \mathcal{Z} \leq\}} \mu_{x z}+\mathbf{1}_{\{x \in \mathcal{Z}>\}} \mu_{x z}^{\prime}\right)-\sum_{y}\left(\mathbf{1}_{\{z \in \mathcal{Z} \leq\}} \mu_{z y}+\mathbf{1}_{\{x \in \mathcal{Z}>\}} \mu_{z y}^{\prime}\right) \\
& \geq \sum_{x}\left(\mathbf{1}_{\{z \in \mathcal{Z} \leq\}} \mu_{x z}+\mathbf{1}_{\{z \in \mathcal{Z}>\}} \mu_{x z}^{\prime}\right)-\sum_{y}\left(\mathbf{1}_{\{z \in \mathcal{Z} \leq\}} \mu_{z y}+\mathbf{1}_{\{z \in \mathcal{Z}>\}} \mu_{z y}^{\prime}\right) \\
& =\mathbf{1}_{\{z \in \mathcal{Z} \leq\}} q_{z}+\mathbf{1}_{\{z \in \mathcal{Z}>\}} q_{z}^{\prime}
\end{aligned}
$$

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-41.jpg?height=517&width=526&top_left_y=300&top_left_x=797)

Figure 4: Network associated with a bipartite matching problem with singles.

giving the required result for $q^{\wedge}$. A similar argument shows that $\mathbb{1}_{\{z \in \mathcal{Z} \leq\}} q_{z}^{\prime}+$ $1_{\{z \in \mathcal{Z}>\}} q_{z}^{\prime} \geq q_{z}^{\vee}$.

## A. 9 Matching and Equilibrium Flows

We associate an equilibrium flow problem with this matching market, generalized to accommodate unmatched agents. See figure 4 .

$$
\begin{aligned}
\mathcal{Z} & =\mathcal{X} \cup \mathcal{Y} \cup\{0\} \\
\mathcal{A} & =((\mathcal{X} \cup\{0\}) \times(\mathcal{Y} \cup\{0\})) \backslash\{(0,0)\} \\
q_{z} & =-n_{z}, \quad z \in \mathcal{X} \\
q_{z} & =m_{z}, \quad z \in \mathcal{Y}
\end{aligned}
$$

Given a price $p$, we define the connection function

$$
\begin{aligned}
G_{x y}\left(p_{y}\right) & =\mathcal{U}_{x y} \circ \mathcal{V}_{x y}^{-1}\left(-p_{y}\right) \text { for } x \in \mathcal{X}, y \in \mathcal{Y} \\
G_{x 0}(p) & =p_{0} \text { for } x \in \mathcal{X} \\
G_{0 y}(p) & =p_{y} \text { for } y \in \mathcal{Y}
\end{aligned}
$$

As required, $G_{x y}\left(p_{y}\right)$ is increasing in $p_{y}$. We adopt the normalization $p_{0}=0$. We now establish a relationship between stable matchings of the matching market and equilibria of the equilibrium flow problem. First, let $(q, \mu, p)$ be an equilibrium of the equilibrium flow problem. To obtain a stable matching $(\mu, w)$, choose $w_{x y}$ so that $\mathcal{V}_{x y}^{-1}\left(-p_{y}\right) \leq w_{x y} \leq \mathcal{U}_{x y}^{-1}\left(p_{x}\right)$. Because we have $p_{x} \geq G_{x y}\left(p_{y}\right)$ in equilibrium, this is
possible. Then for worker $x$ we have

$$
\begin{aligned}
\mu_{x y}>0 & \Longrightarrow p_{x}=G_{x y}\left(p_{y}\right) \\
& \Longrightarrow w_{x y}=\mathcal{U}_{x y}^{-1}\left(p_{x}\right) \\
p_{x} \geq G_{x z}\left(p_{z}\right) \leq 0 & \Longrightarrow w_{x z} \leq \mathcal{U}_{x z}^{-1}\left(p_{x}\right) \\
& \Longrightarrow \mathcal{U}_{x y}\left(w_{x y}\right) \geq \mathcal{U}_{x z}\left(w_{x z}\right)
\end{aligned}
$$

which gives

$$
y \in \arg \max _{y \in \mathcal{Y}} \mathcal{U}_{x y}\left(w_{x y}\right)
$$

as needed. The argument for firms is similar, giving a stable matching.

Conversely, suppose we have a stable matching $(\mu, w)$. Define $q_{z}=-n_{x}$ for $z \in \mathcal{X}$ and $q_{z}=m_{y}$ for $z \in \mathcal{Y}$. We identify prices $p$ such that $(q, \mu, p)$ is an equilibrium of the equilibrium flow problem. Define the indirect utilities

$$
\begin{aligned}
& u_{x}=\max _{x \in \mathcal{X}}\left\{\mathcal{U}_{x y}\left(w_{x y}\right), 0\right\} \\
& v_{y}=\max _{y \in \mathcal{Y}}\left\{\mathcal{V}_{x y}\left(w_{x y}\right), 0\right\}
\end{aligned}
$$

Then define $p$ by $p_{x}=u_{x}$ if $x \in \mathcal{X}, p_{y}=-v_{y}$ if $y \in \mathcal{Y}$ and $p_{0}=0$, and define $q_{z}=-n_{x}$ for $z \in \mathcal{X}$ and $q_{z}=m_{y}$ for $z \in \mathcal{Y}$. Define the connection functions $G_{x y}$ as above. If $\mu_{x y}=0$, then it follows from the stability condition for a stable matching that $p_{x}=G_{x y}\left(p_{y}\right)$. For other pairs $(x, y)$, the stability condition implies that there is no wage $w_{x y}$ at which $x$ and $y$ can match and obtain utilities in excess of $u_{x}$ and $v_{y}$, which is equivalent to the statement that $p_{x} \geq G_{x y}\left(p_{y}\right)$. We thus have an equilibrium flow.

## A. 10 Proof of Theorem 7

Statement (i): Assume $\mu$ is a stable matching. Let $y \in \mathcal{Y}$ and let $x \in \mathcal{X}_{0}$ be the match of $y$ under $\mu$. We need to consider two cases:

First case: Let $x \in \mathcal{X}$. We have that $v_{y}^{\mu}=\gamma_{x y}$, and there cannot be another $y^{\prime} \in \mathcal{Y}$ with $\gamma_{x y^{\prime}} \geq v_{y^{\prime}}^{\mu}$ and $\alpha_{x y^{\prime}}>u_{x}^{\mu}=\alpha_{x y}$; for if this were the case, $y \neq y^{\prime}$, and hence $x$ is not matched with $y^{\prime}$, and thus $\gamma_{x y^{\prime}} \geq v_{y^{\prime}}^{\mu}$ would imply $\gamma_{x y^{\prime}}>v_{y^{\prime}}^{\mu}$. As a result,

$$
\begin{equation*}
y \in \arg \max _{y \in \mathcal{Y}}\left\{\alpha_{x y}: \gamma_{x y} \geq v_{y}^{\mu}, \alpha_{x 0}\right\} \tag{32}
\end{equation*}
$$

Now assume that $y \in \arg \max _{y}\left\{\alpha_{x^{\prime} y}: \gamma_{x^{\prime} y} \geq v_{y}, \alpha_{x^{\prime} 0}\right\}$ for some $x^{\prime} \neq x$; but then $x^{\prime} y$ would be a blocking pair; further, $v_{y}^{\mu}=\gamma_{x y}>\gamma_{0 y}$. As a result, for any $x^{\prime} \in \mathcal{X} \backslash\{x\}$, we have

$$
\begin{equation*}
y \notin \arg \max _{y}\left\{\alpha_{x^{\prime} y}: \gamma_{x^{\prime} y} \geq v_{y}, \alpha_{x^{\prime} 0}\right\} \tag{33}
\end{equation*}
$$

Finally, because $\mu$ is stable and $x \neq 0$, we have

$$
\begin{equation*}
v_{y}^{\mu}=\gamma_{x y}>\gamma_{0 y} \tag{34}
\end{equation*}
$$

By putting (32), (33), and (34) together, we get that $Q_{y}\left(v^{\mu}\right)=0$.

Second case: Let $x=0$. Then $v_{y}^{\mu}=\gamma_{0 y}$ and a similar logic as above shows that for any $x^{\prime} \in \mathcal{X}$, we have

$$
y \notin \arg \max _{y}\left\{\alpha_{x^{\prime} y}: \gamma_{x^{\prime} y} \geq v_{y}, \alpha_{x^{\prime} 0}\right\}
$$

and as a result we get that $Q_{y}\left(v^{\mu}\right)=0$.

Statement (ii): Conversely, assume $Q(v)=0$. Then for $x \in \mathcal{X}$ and $y \in \mathcal{Y}$, we define

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-43.jpg?height=123&width=1029&top_left_y=833&top_left_x=537)

We have $\sum_{x \in \mathcal{X}_{0}} \mu_{x y}=1$ by assumption and it is straightforward to see that $\sum_{y \in \mathcal{Y}_{0}} \mu_{x y}=$ 1 by the strict preferences assumption.

We need to show that $\mu$ is a stable matching. First, let us show that there is no blocking pair. By contradiction, assume $x y$ is a blocking pair. Consider $x^{*} \in \mathcal{X}_{0}$, the match of $y$ under $\mu$, and $y^{*} \in \mathcal{Y}_{0}$, the match of $x$ under $\mu$. Because $x y$ is a blocking pair, we have $\gamma_{x y}>\gamma_{x^{*} y}$ and $\alpha_{x y}>\alpha_{x y^{*}}$.

We show that $\gamma_{x y}>v_{y}$. Indeed, if $x^{*} \neq 0$ we have that because $x^{*}$ is matched with $y$, then $y \in \arg \max _{y}\left\{\alpha_{x^{*} y}: \gamma_{x^{*} y} \geq v_{y}, \alpha_{x^{*} 0}\right\}$, and $\gamma_{x^{*} y} \geq v_{y}$, and thus $\gamma_{x y}>\gamma_{x^{*} y} \geq v_{y}$. Otherwise, if $x^{*}=0$, we have $\mu_{0 y}=1$, and hence $\gamma_{0 y} \geq v_{y}$; but we have $\gamma_{x y}>\gamma_{0 y}$, because $x y$ is a blocking pair, and thus $\gamma_{x y}>\gamma_{0 y} \geq v_{y}$. In either case, $\gamma_{x y}>v_{y}$ as announced.

As $\alpha_{x y^{*}}=\max _{y}\left\{\alpha_{x y}: \gamma_{x y} \geq v_{y}, \alpha_{x 0}\right\}$ and $\gamma_{x y}>v_{y}$, it follows that $\alpha_{x y^{*}} \geq \alpha_{x y}$, a contradiction.

Finally, we need to show that there is no blocking individual. Assume $x y$ is a matched pair. As $\mu_{x y}=1$, we have $\alpha_{x y} \geq \alpha_{x 0}$ by definition of $\mu$. Next, we have $\mu_{0 y}=0$ therefore $\gamma_{0 y}<v_{y}$ and in particular $\gamma_{0 y} \leq v_{y}$.

## A. 11 Proof of Theorem 8

It is straightforward to verify that Q satisfies weak gross substitutes, and hence it defines a point-valued correspondence for which unified gross substitutes holds, by Property 1. Next, we show that is it a M0-correspondence by showing that it satisfies
monotone total output. We have

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-44.jpg?height=122&width=1258&top_left_y=394&top_left_x=409)

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-44.jpg?height=111&width=1044&top_left_y=514&top_left_x=622)

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-44.jpg?height=122&width=1089&top_left_y=622&top_left_x=621)

$$
\begin{aligned}
& =|Y|-|X|-\sum_{x \in X} 1_{\left\{\alpha_{x 0} \geq \max _{y \in Y}\left\{\alpha_{x y}: \gamma_{x y} \geq v_{y}\right\}\right\}}-\sum_{y \in Y} 1_{\left\{\gamma_{0 y} \geq v_{y}\right\}}
\end{aligned}
$$

We then note that $\mathbb{1}_{\left\{\alpha_{x 0} \geq \max _{y \in Y}\left\{\alpha_{x y}: \gamma_{x y} \geq v_{y}\right\}\right\}}$ is nondecreasing in each $v_{y}$, and similarly $\mathbf{1}_{\left\{\gamma_{0 y} \geq v_{y}\right\}}$ is also nondecreasing in each $v_{y}$. Hence monotone total output holds, and nonreversingness follows.

## A. 12 Proof of Theorem 9

We show that the hedonic pricing problem is an equilibrium flow problem, as illustrated in Figure 5 .

![](https://cdn.mathpix.com/cropped/2024_06_04_c85bf03912cd40a810aeg-44.jpg?height=542&width=533&top_left_y=1336&top_left_x=796)

Figure 5: Network associated with a hedonic model.

Consider $\mathcal{Z}=\mathcal{X} \cup \mathcal{Y} \cup \mathcal{W}$ and $\mathcal{Z}_{0}=\mathcal{Z} \cup\{0\}$, where 0 is an additional node. Denote as well $\mathcal{W}_{0}=\mathcal{W} \cup\{0\}$. The set of arcs $\mathcal{A}$ is given by

$$
\mathcal{A}=\left(\mathcal{X} \times \mathcal{W}_{0}\right) \cup\left(\mathcal{W}_{0} \times \mathcal{Y}\right)
$$

To define the connection functions, first let $p_{x}=u_{x}$ for all $x \in \mathcal{X}, p_{w}=p_{w}$ for all $w \in \mathcal{W}$ and $p_{y}=-v_{y}$ for all $y \in \mathcal{Y}$.

Then the connections functions are given by $G_{x w}\left(p_{w}\right)=\pi_{x w}\left(p_{w}\right), G_{x 0}\left(p_{0}\right)=$ $p_{0}, G_{w y}\left(p_{y}\right)=s_{y w}^{-1}\left(-p_{y}\right)$ and $G_{0 y}\left(p_{y}\right)=p_{y}$.

The equilibrium stocks are given by $q_{w}=\sum_{x \in \mathcal{X}} \mu_{x 0}-\sum_{y \in \mathcal{Y}} \mu_{0 y}$ for all $w \in \mathcal{W}$, $q_{x}=-n_{x}$ for all $x \in \mathcal{X}, q_{w}=0$ for all $w \in \mathcal{W}$ and $q_{y}=m_{y}$ for all $y \in \mathcal{Y}$.

We can then reformulate the equilibrium conditions of Definition 12 as an equilibrium flow on this network, along with the normalization $p_{0}=0$.

## References

[1] Ravindra K. Ahuja, Thomas L. Magnanti, and James B. Orlin. Network Flows: Theory, Algorithms and Applications. Prentice Hall, Englewood Cliffs, NJ, 1993.

[2] Kenneth J. Arrow and Frank Hahn. General Competitive Analysis. Holden-Day, San Francisco, 1971.

[3] Lawrence M. Ausubel and Paul R. Milgrom. Ascending auctions with package bidding. Advances in Theoretical Economics, 1(1), 2002. Article 1.

[4] Richard Bellman. On a routing problem. Quarterly of Applied Mathematics, $16: 87-90,1958$.

[5] Steven Berry, Amit Gandhi, and Philip Haile. Connected substitutes and invertibility of demand. Econometrica, 81(5):2087-2111, 2013.

[6] J. Frédéric Bonnans and Alexander Shapiro. Perturbation analysis of optimization problems. Springer Science \& Business Media, 2013.

[7] Xin Chen and Menglong Li. S-convexity and gross substitutability. Unpublished, University of Illinois, 2020.

[8] Pierre-Andre Chiappori, Robert J. McCann, and Lars P. Nesheim. Hedonic price equilibria, stable matching, and optimal transport: Equivalence, topology and uniqueness. Economic Theory, 42(2):317-354, 2010.

[9] Gabrielle Demange and David Gale. The strategy structure of two-sided matching markets. Econometrica, 53(4):873-888, 1985.

[10] Gabrielle Demange, David Gale, and Maria Sotomayor. Multi-item auctions. Journal of Political Economy, 94(4):863-872, 1986.

[11] Ivar Ekeland, James Heckman, and Lars P. Nesheim. Identification and estimation of hedonic models. Journal of Political Economy, 112(1):S60-S109, 2004.

[12] David Gale and Hukukane Nikaido. The Jacobian matrix and global univalence of mappings. Mathematische Annalen, 159:81-93, 1965.

[13] Alfred Galichon. The unreasonable effectiveness of optimal transport in economics. arXiv preprint arXiv:2107.04700, 2021.

[14] Alfred Galichon, Yu-Wei Hiseh, and Maxime Sylvestre. Monotone comparative statics for submodular functions, with an application to aggregated deferred acceptance. Unpublished, New York University and Sciences Po, 2022.

[15] Alfred Galichon, Larry Samuelson, and Lucas Vernet. The existence of equilibrium flows. Unpublished, New York University and Sciences Po, Yale University, and Sciences Po and Banque de France, 2022.

[16] Faruk Gul and Ennio Stacchetti. Walrasian equilibrium with gross substitutes. Journal of Economic Theory, 87(1):95-124, 1999.

[17] Philip Hall. On representatives of subsets. Journal of the London Mathematical Society, 10(1):26-30, 1935.

[18] John William Hatfield and Paul R. Milgrom. Matching with contracts. American Economic Review, 95(4):913-935, 2005.

[19] Peter Howitt. Gross substitutability with multi-valued excess demand functions. Econometrica, 48(6):1567-1573, 1980.

[20] Alexander S. Kelso and Vincent P. Crawford. Job matching, coalition formation, and gross substitutes. Econometrica, 50(6):1483-1504, 1982.

[21] Andreu Mas-Colell, Michael D. Whinston, and Jerry R. Green. Microeconomic Theory. Oxford University Press, Oxford, 1995.

[22] Paul R. Milgrom and Chris Shannon. Monotone comparative statics. Econometrica, 62:157-180, 1994.

[23] Gaspard Monge. Mèmoire sur la thèorie des dèblais et des remblais. Technical report, De l'Imprimerie Royale, 1781.

[24] J. Moré and W. Rheinboldt. On P- and S-functions and related classes of $n$ dimensional nonlinear mappings. Linear Algebra and its Applications, 6:45-68, 1973.

[25] Hukukane Nikaido. Convex Structures and Economic Theory. Academic Press, New York, 1968.

[26] Georg Nöldeke and Larry Samuelson. The implementation duality. Econometrica, 86(4):1283-1384, 2018.

[27] James M. Ortega and Werner C. Rheinboldt. Iterative Solution of Nonlinear Equations in Several Variables. Society for Industrial and Applied Mathematics, 2000 .

[28] R. J. Plemmons. M-matrix characterizations I. Nonsingular M-matrices. Linear Algebra and its Applications, 18:175-188, 1977.

[29] V. M. Polterovich and V. A. Spivak. Gross substitutability of point-to-set correspondences. Journal of Mathematical Economics, 1:117-140, 1983.

[30] Jean-Charles Rochet. A necessary and sufficient condition for rationalizability in a quasi-linear context. Journal of Mathematical Economics, 16:191-200, 1987.

[31] R. Tyrrell Rockafellar. Convex Analysis. Princeton University Press, Princeton, 1997 .

[32] Shewin Rosen. Hedonic prices and implicit markets: Product differentiation in pure competition. Journal of Politcal Economy, 82(1):34-55, 1974.

[33] Donald M. Topkis. Minimizing a submodular function on a lattice. Operations Research, 26:305-321, 1978.

[34] Donald M. Topkis. Supermodularity and Complementarity. Princeton University Press, Princeton, 1998.

[35] Richard S. Varga. Matrix Iterative Analysis. Springer-Verlag, Berlin, 2000.

[36] A. Veinott. Lattice programming: Qualitative optimization and equilibria. Unpublished, Stanford University, 1992.
