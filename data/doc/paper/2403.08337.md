# LLM-Assisted Light: Leveraging Large Language Model Capabilities for Human-Mimetic Traffic Signal Control in Complex Urban Environments 

Maonan Wang, Aoyu Pang, Yuheng Kan, Man-On Pun, Chung Shue Chen and Bo Huang


#### Abstract

Traffic congestion in metropolitan areas presents a formidable challenge with far-reaching economic, environmental, and societal ramifications. Therefore, effective congestion management is imperative, with traffic signal control (TSC) systems being pivotal in this endeavor. Conventional TSC systems, designed upon rule-based algorithms or reinforcement learning (RL), frequently exhibit deficiencies in managing the complexities and variabilities of urban traffic flows, constrained by their limited capacity for adaptation to unfamiliar scenarios. In response to these limitations, this work introduces an innovative approach that integrates Large Language Models (LLMs) into TSC, harnessing their advanced reasoning and decision-making faculties. Specifically, a hybrid framework that augments LLMs with a suite of perception and decision-making tools is proposed, facilitating the interrogation of both the static and dynamic traffic information. This design places the LLM at the center of the decision-making process, combining external traffic data with established TSC methods. Moreover, a simulation platform is developed to corroborate the efficacy of the proposed framework. The findings from our simulations attest to the system's adeptness in adjusting to a multiplicity of traffic environments without the need for additional training. Notably, in cases of Sensor Outage (SO), our approach surpasses conventional RL-based systems by reducing the average waiting time by $20.4 \%$. This research signifies a notable advance in TSC strategies and paves the way for the integration of LLMs into real-world, dynamic scenarios, highlighting their potential to revolutionize traffic management. The related code is available at https://github.com/Traffic-Alpha/LLM-Assisted-Light


Index Terms-Traffic Signal Control, Autonomous Agent, Large Language Model, Human-Machine Interface.

## I. INTRODUCTION

TRAFFIC congestion poses a significant challenge globally, leading to adverse economic, environmental, and social impacts [1]. Managing traffic flow efficiently, especially at road intersections, is crucial to alleviate congestion. Traffic signal control (TSC) systems are vital in this effort [2].

This work was supported in part by Shanghai Pujiang Program (21PJD092), the National Key R\&D Program of China with grant No. 2018YFB1800800, the Basic Research Project No. HZQB-KCZYZ-2021067 of Hetao ShenzhenHK S\&T Cooperation Zone. (Corresponding author: Man-On Pun)

Maonan Wang is with the Future Network of Intelligence Institute (FNii), the Chinese University of Hong Kong, Shenzhen, China and the Shanghai AI Laboratory, Shanghai, China.

Aoyu Pang and Man-On Pun are with the School of Science and Engineering, the Chinese University of Hong Kong, Shenzhen, China.

Yuheng Kan is with the SenseTime Group Limited, Shanghai, China and the Shanghai AI Laboratory, Shanghai, China.

Chung Shue Chen is with Nokia Bell Labs, Paris-Saclay, 12 Rue Jean Bart, 91300 Massy, France.

Bo Huang is with the Department of Geography, The University of Hong Kong, Hong Kong, SAR 999077, China.
Traditional rule-based TSC methods, such as the Webster method [3] and Self-Organizing Traffic Light Control (SOTL) [4], have been somewhat effective in managing traffic flow and reducing congestion. Yet, these systems are inherently limited by their static, rule-based algorithms that do not fully adapt to the ever-changing patterns of urban traffic [5].

Recently, the evolution of sensor technology and data collection has led to the development of more adaptive TSC strategies. In particular, Reinforcement Learning (RL) has emerged as an attractive approach, utilizing real-time data to dynamically adjust traffic signals [6]. Despite their potentials, these RL-based TSC systems are not without limitations. These systems may suffer from overfitting to specific traffic patterns. Additionally, RL systems typically rely on reward functions that may not be able to capture infrequent but critical events, such as emergency vehicles' sudden arrivals or unexpected road blockages. This can reduce their practicality in real-world conditions [7].

In response to these limitations, this paper introduces a novel approach that integrates Large Language Models (LLMs) into the TSC framework to assist in the decisionmaking process, named LLM-Assist Light (LA-Light). Our method leverages the extensive knowledge and "common sense" reasoning abilities of LLMs to enhance decisionmaking in complex and uncommon traffic situations. LLMs, with their sophisticated natural language processing capabilities, can interpret intricate traffic scenarios and recommend actions that may be overlooked by rule-based or RL-based systems. Furthermore, we introduce a set of tools specifically designed to bridge the gap between the TSC system and the LLM. These tools act as intermediaries, collecting environmental data and communicating with the LLM, which then guides the TSC system. This collaborative process allows for a well-rounded control strategy that not only makes informed decisions but also provides justifications for these decisions, thus improving the transparency of the system and building trust with traffic management operators.

Fig. 1 shows the difference between the method proposed in this paper and existing signal light control methods. The existing TSC systems, as shown in Fig. 1a, operate by making decisions based on predefined rules and observations, which may not suffice in unusual or unpredictable events. In contrast, our approach, depicted in Fig. 10, integrates an LLM Agent Module to enhance the system's comprehension of various traffic scenarios and the logic behind its decisions. Given that LLMs intrinsically lack the capacity for direct engagement
with traffic ecosystems or their data, an array of enhanced tools are devised to collect both the static and dynamic traffic information, subsequently facilitating the decision-making procedure. Crucially, this ensemble integrates existing rulebased and RL-based algorithms, guaranteeing that our methodology sustains state-of-the-art (SOTA) performance under conventional traffic conditions while also adapting effectively to exceptional situations.

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-02.jpg?height=144&width=781&top_left_y=562&top_left_x=195)

(a)

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-02.jpg?height=279&width=789&top_left_y=760&top_left_x=207)

(b)

Fig. 1. Comparative framework analysis between LA-Light and conventional TSC systems. (a) illustrates a conventional TSC system wherein decisions are made directly by an algorithm that processes environmental inputs. (b) depicts the proposed LA-Light framework, which employs an LLM for the task of traffic signal control. In LA-Light, the LLM begins by selecting the most relevant tools from an enhanced set, including perception tools and decisionmaking algorithms, to collect and analyze traffic data. It then evaluates the information, adjusting its choice of tools as needed, until a definitive traffic control decision is formulated.

To corroborate the efficacy of the proposed framework, a simulation platform is developed. Extensive experiments are conducted on the simulation platform considering various intersection configurations. It is shown that the proposed LALight system achieves good performance in typical scenarios as well as in situations involving rare events. We also provide several qualitative examples where LA-Light accurately analyzes intricate traffic conditions and makes more reasonable decisions than conventional TSC methods. The experiments highlight the LLM-assisted system's capability to deeply understand traffic scenarios and to provide clear explanations for its actions. LA-Light is shown to make informed decisions that enhance safety, efficiency, and comfort, outperforming existing methods that may otherwise fail or yield suboptimal results under challenging conditions. The key contributions of this study are summarized as follows.

- We propose LA-Light, a hybrid TSC framework that integrates the human-mimetic reasoning capabilities of LLMs, enabling the signal control algorithm to interpret and respond to complex traffic scenarios with the nuanced judgment typical of human cognition. This innovation allows for seamless adaptation to urban traffic challenges, particularly in addressing the unpredictable and rare events that conventional systems may overlook;
- A closed-loop traffic signal control system has been developed, integrating LLMs with a comprehensive suite of interoperable tools. This integration yields in-depth insights into consistent and variable traffic patterns, thereby equipping the system with the capability for realtime analysis and decision-making that mirrors human intelligence. Furthermore, the system has been designed with a standardized interface, ensuring straightforward integration and facilitating customization by users;
- Through comprehensive experimentation, the results show that our model is adept at understanding and responding to a variety of environmental changes. In particular, it is able to address rare or unexpected events and provide superior performance, thereby validating its practical applicability and efficacy in real-world settings.

The remainder of this paper is organized as follows: Section [II provides an overview of existing literature in the fields of TSC and LLMs whereas Section III defines key terminologies pertaining to TSC that are referenced throughout this paper. After that, Section IV details the architecture of the proposed LLM-Assist Light framework, encompassing the utilized tools and the construction of prompts. Section V describes the experiments conducted to validate our approach. Finally, Section VI provides some concluding remarks and suggestions for future research directions.

## II. RELATED WORK

## A. Traffic Signal Control Methods

The pursuit of effective traffic signal control (TSC) strategies in urban settings is a well-established challenge with the goal of alleviating congestion. The rule-based TSC methods have been designed to optimize traffic signals under a variety of traffic conditions [8]. For example, the Webster method [3] calculates the ideal cycle length and distribution of traffic signal phases at intersections, based on traffic volumes and the assumption of a stable flow of traffic over a specific period. The Self-Organizing Traffic Light Control (SOTL) scheme [4] uses a set of predetermined rules to decide whether to continue with the current traffic signal phase or to change it. Adaptive TSC systems such as the Split Cycle Offset Optimization Technique (SCOOT) [9] and the Sydney Coordinated Adaptive Traffic System (SCATS) [10] dynamically alter cycle lengths, phase divisions, and offsets by choosing from a collection of predefined plans in response to live traffic sensor data. Although conventional TSC methods have achieved some success in mitigating congestion, their effectiveness is hindered by limitations in real-time traffic data utilization and difficulties in adapting to quickly changing traffic situations. Moreover, these methods often fall short in complex traffic scenarios [6].

Recent advancements in TSC have seen a shift towards RLbased systems, which are increasingly favored for their ability to dynamically manage traffic lights [11]. These systems typically use factors such as queue length [12]-[15], vehicle waiting time [16]-[18] or intersection pressure [12], [19], [20] as key indicators in their reward functions, training agents to reduce congestion. Furthermore, the frequency of signal switching has been considered [21] to prevent the negative impacts of rapid signal changes, such as increased stop-andgo driving and the risk of accidents. Although RL-based TSC systems offer flexibility in optimizing traffic flow by adjusting the reward function, finding the right balance for
these factors is a complex task [22]. Furthermore, if the reward function does not encompass infrequent but critical events, it may not provide the agent with sufficient direction to handle unexpected conditions effectively [7].

## B. Large Language Models

Large language models (LLMs), such as the Generative Pretrained Transformer (GPT) series [23], including its advanced versions like GPT-3.5 and GPT-4 Turbo [24], as well as open-source counterparts like Llama [25] and Llama2 [26], constitute a category of artificial intelligence systems designed to understand, generate and modify human language. These models rely on complex machine learning algorithms, specifically the transformer architecture [27], and are trained on extensive text datasets. Such comprehensive training grants them a sophisticated grasp of language nuances. A specialized version, InstructGPT [28], has been further refined to interpret user instructions with greater precision, providing relevant responses in a range of applications, from creating content to retrieving information. The "Chain-of-Thought" reasoning method [29] has introduced improved functionality within LLMs, enhancing their capability to solve complex problems by processing a series of logical steps. This significantly improves their performance in tasks that require arithmetic, commonsense, and symbolic reasoning. The "ReAct" strategy [30] extends the abilities of LLMs in complex tasks that require both reasoning and decision making. By prompting models to alternate between verbal reasoning and action generation, this approach enables dynamic reasoning and interaction with external systems.

Motivated by their superior performance, LLMs have been recently investigated for a multitude of tasks, as documented in recent surveys [31], [32]. These models have found applications in transportation planning and decision support systems [33]. For instance, [34] involves LLMs as decision-makers in conjunction with perception and positioning systems to aid autonomous vehicles whereas the Open-TI framework [35] integrates LLMs with traffic analysis tools, facilitating complex command execution through natural language interactions. This integration facilitates comprehensive traffic analysis, encompassing the acquisition and application of map data within sophisticated simulation platforms, thereby enhancing traffic signal control to more effectively address traffic requirements. Furthermore, LLMs have also been utilized to enhance lanechanging maneuvers in vehicles, aligning them more closely with human-like decision-making [36]. In instances of suboptimal outputs from rule-based planners, LLMs have been employed to evaluate the scenario and suggest alternative trajectories [37]. Finally, the amalgamation of LLMs with bird's-eye view (BEV) maps has been examined, offering a more holistic insight into traffic scenarios [38]. However, until now, LLMs have not been utilized to interpret complex traffic scenarios and control traffic signals to solve long-tail issues. Our proposed framework, LA-Light, seeks to employ LLMs together with a range of perception and decision-making tools. This approach allows the traffic signal control algorithm to understand and address complex traffic situations with the detailed judgment typical of human cognition.

## III. PRELIMINARIES

This section provides definitions for the key terminologies about TSC that are utilized throughout this paper. These terms are described with reference to a typical four-legged intersection, which is illustrated in Fig. 2

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-03.jpg?height=748&width=789&top_left_y=466&top_left_x=1118)

Fig. 2. A standard four-legged road intersection with eight traffic movements and signal phases.

Lanes: In the context of traffic intersections, lanes are categorized according to their purpose for the intersection. Incoming lanes guide vehicles toward the intersection, allowing them to enter. Conversely, outgoing lanes are designed to allow vehicles to depart from the intersection.

Traffic Movements: The directional flow of vehicles from incoming to outgoing lanes defines traffic movement at an intersection. A conventional four-way intersection typically includes four directional paths: East (E), West (W), North $(\mathrm{N})$, and South (S). Each path facilitates two main vehicular movements for exiting: a left turn, indicated by $l$, and a straight-ahead movement, denoted by $s$. In the context of this study, right-turn movements are excluded on the assumption that they are not signal-controlled in regions with right-hand traffic systems. Therefore, the traffic control system at the intersection administers eight distinct movements, labeled as $m_{1}$ through $m_{8}$.

Movement Signals: Movement signals are the controls that dictate the flow of traffic for each direction at an intersection. A green signal authorizes the traffic to proceed, while a red signal indicates a stop condition. As depicted in Fig. 2, at a standard four-way intersection, if movement signals $m_{4}$ and $m_{8}$ are green, this indicates that the corresponding movements-specifically, the westbound and eastbound left turns-are allowed, and all other movements are halted.

Phases: A traffic signal phase is a combination of movement signals that are displayed at the same time to manage multiple traffic flows. This configuration is designed so that all movements within a phase can proceed safely and without interference from other directions. As shown in Fig. 2, the

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-04.jpg?height=108&width=608&top_left_y=192&top_left_x=736)

Decision Unit

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-04.jpg?height=199&width=658&top_left_y=272&top_left_x=720)
Planning congestion

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-04.jpg?height=588&width=572&top_left_y=476&top_left_x=175)

## Environment

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-04.jpg?height=65&width=41&top_left_y=1057&top_left_x=439)

Toolkit for TSC

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-04.jpg?height=892&width=601&top_left_y=275&top_left_x=1334)

Fig. 3. The LA-Light framework: A schematic representation of the five-step process for integrating LLM in TSC. Step 1 outlines the task planning phase where the LLM defines its role in traffic management. Step 2 involves the selection of appropriate perception and decision-making tools by the LLM. In Step 3, these tools interact with the traffic environment to gather data. Step 4 depicts the analysis of this data by the Decision Unit to inform decision-making. Finally, Step 5 illustrates the implementation of the LLM's decisions and the provision of explanatory feedback for system transparency and validation.

intersection operates using four distinct phases, identified as $P_{1}$ through $P_{4}$. For example, during phase $P_{4}$, the green signals for movements $m_{4}$ and $m_{8}$ are activated concurrently, which enables vehicles to make left turns from both the westbound and eastbound approaches without conflict.

## IV. LLM-ASSISTED LIGHT

## A. Overview of LA-Light

The LA-Light framework introduces an innovative hybrid decision-making process for TSC that leverages the cognitive capabilities of LLMs alongside traditional traffic management methodologies. As illustrated in Fig. 3, the framework operates through a sequence of five methodical steps for decisionmaking, commencing with the specification of the LLM's role. In this initial phase, the LLM is assigned the function of regulating traffic signals at busy intersections to alleviate congestion, drawing on a combination of analytical and control tools.

Following this, the LLM is responsible for choosing the most appropriate tools from a predefined set of tools. These tools are divided into two categories, namely the perception tools and the decision-making tools. The perception tools are tasked with collecting a range of environmental data, both dynamic and static, to form a detailed picture of the traffic conditions. Conversely, the decision-making tools are specifically engineered for facilitating decisions and can be further classified into two categories: decision support tools, which utilize extant TSC algorithms to aid the decisionmaking process, and decision verification tools that assess the precision of decisions rendered by the LLM.

In the third stage, the chosen tools are activated within the traffic environment to collate traffic data, which is critical for informed decision-making. The collected data are then conveyed to the LLM, including the chat history, constituting the fourth step. At this point, the LLM scrutinizes the data to determine the next course of action. It evaluates the adequacy of the current data set and determines whether there is a necessity to activate supplementary tools for enhanced data acquisition.

Once sufficient data are obtained, the LLM proceeds to formulate traffic signal timing recommendations. These recommendations are then transmitted to the traffic control systems, implementing the recommended adjustments to the traffic light phases. The specific action taken in this study is the selection of an appropriate traffic phase ID for the junction, which the traffic lights then adopt. Concurrently, the LLM elucidates the reasoning behind its recommendations, thus improving the system's transparency and intelligibility. This aspect is vital for traffic operators, as it bolsters the reliability and trust in the system's operations.

The discussions above delineate the decision-making process at each juncture. In Algorithm 1, we introduce an elaborate control sequence that incorporates several decisionmaking cycles. Each cycle embodies the five steps previously outlined. Furthermore, the content of the dialogue is preserved
in the context dialogue memory $(M)$, which allows the LLM to integrate contextual data and construct a logical sequence for future decisions.

```
Algorithm 1 LA-Light: LLM-Assisted Traffic Signal Control
    Input: Total simulation time $T$, current time $t$, Intervention
    Frequency $\Delta t$, task description $D_{\text {task }}$, tool $x \in \mathcal{X}$, context
    dialogue memory $M$
    Initialize: $t=0, M=[$
    while $t<T$ do
        // Append task description to memory
        $M$.append $\left(D_{\text {task }}\right)$
        done $=$ False
        while not done do
            // Choose the appropriate tool
            $x=\operatorname{LLM}(M)$
            // Interact with environment
            $o b s=x(\mathrm{env})$
            // Record the tool used and observation
            $M$.append $((x, o b s))$
            // Determine if decision can be made
            done $=$ DecisionCriterion $(o b s)$
        // Execute decision in environment
        env.execute(decision)
        $t=t+\Delta t$
    Output: Implemented traffic signal timing adjustments and ra-
    tionale
```


## B. Toolkit for TSC

The LA-Light framework incorporates a comprehensive set of tools that facilitate the interaction of LLMs with the traffic environment. These tools, acting as sensory and cognitive extensions, enable the LLMs to accurately perceive traffic conditions and make well-informed decisions. The toolkit is divided into two main categories: Perception Tools and Decision Tools. Perception Tools are focused on the acquisition of static and dynamic traffic information, while Decision Tools support and evaluate the decision-making process. The design of these tools is modular and scalable, ensuring easy integration of new functionalities to accommodate various traffic management challenges. This approach allows the LLM to effectively combine traditional traffic control methods with its advanced reasoning capabilities, improving its performance in complex traffic scenarios.

Perception Tools (Static): The static subset of Perception Tools is responsible for capturing the unchanging aspects of the traffic environment. These include:

- Get_Intersection_Layout: This tool delineates the intersection's configuration, detailing the number and function of lanes associated with each direction, which is fundamental for understanding potential traffic flow scenarios.
- Get_Signal_Phase_Structure: This tool offers a detailed description of the traffic signal phases at the intersection, outlining the sequence and associated traffic movements for each phase.

Perception Tools (Dynamic): The dynamic category of Perception Tools are responsible for gathering real-time, fluctuating traffic parameters:

- Get_Occupancy: This function calculates the proportion of space currently occupied by vehicles in each move- ment, providing insights into congestion levels and the distribution of vehicles at the intersection.
- Get_Queue_Length: It measures the length of vehicle queues for each traffic movement, providing quantitative data to gauge traffic backlogs.
- Get_Phase_ID: This tool identifies the currently active traffic signal phase at the intersection, which is crucial for the LLM to understand which traffic flows are being allowed at any given moment.
- Get_Junction_Situation: This tool is designed to detect and assess unusual or emergency situations at the intersection, such as the arrival of emergency vehicles or traffic accidents, that may require immediate action or a departure from standard traffic control measures.

Decision Tools (Support): These tools are designed to aid the LLM in the decision-making process by offering reference points and additional insights:

- Get_Auxiliary_Decision: This function offers alternative decisions that can act as a reference or provide additional viewpoints to the LLM's decision-making process. Within LA-Light, the UniTSA method [18] is implemented as the foundational approach. UniTSA is an RL strategy that uses queue length as the reward metric. It is a universal RL-based method suitable for junctions with diverse configurations, eliminating the need for separate training for different junctions and still achieving good performance in standard situations.
- Get_Available_Actions: This tool lists the potential actions available to the LLM at any given time, outlining the range of immediate decision-making options.

Decision Tools (Evaluate): The evaluative subset of Decision Tools facilitates the validation and justification of the decisions proposed by the LLM:

- Evaluate_Action_Feasibility: Before a decision is implemented, this tool checks whether the proposed traffic signal phase is viable within the current signalization structure of the intersection. This preemptive evaluation helps prevent the selection of incompatible traffic phases.
- Justify_Decision_Logic: This function allows the LLM to explain the reasoning behind its decisions. Such explanations increase the transparency and understanding of the TSC process for traffic managers.

The toolkit described above is essential for the operation of the LA-Light framework, serving to connect the LLM's sophisticated reasoning abilities with the practical needs of TSC. Although the current set of tools is tailored to the particular requirements identified in this study, the framework's flexible architecture allows for the easy addition of new tools. This adaptability ensures that the framework can meet the changing demands of traffic management and fulfill future objectives.

## C. Prompt Design

The LA-Light system harnesses the interpretative capabilities of the LLM and refines its decision-making process through careful prompt engineering. This approach directs the model's decisions in complex traffic situations. The system prompt is meticulously crafted to encompass a broad spectrum

TABLE I

THE DETAILS OF THE PROMPT COMPONENTS FOR Get_Intersection_Layout

| Name | Description |
| :---: | :---: |
| Description | The Get_Intersection_Layout function provides a detailed configuration of an intersection's layout. <br> It returns the number and function of lanes for each direction at the specified intersection. |
| Input | junction_id (str): A string identifier for the intersection you wish to query. |
| Output | A dictionary where each key represents a traffic movement id at the intersection. <br> The corresponding value is another dictionary with the following keys: <br> - "direction": A string indicating the lane direction, where 's' is for straight, ' 1 ' is for left turn, and 'r' is for right turn. <br> - "number_of_lanes": An integer representing the number of lanes for the specified direction. |
| Example | To get the layout of intersection 'J1', call the function as follows: <br> layout = Get_Intersection_Layout('J1") <br> The expected output would be a dictionary describing the intersection layout, such as: <br> layout= $\{$ "E1": \{"direction": "s", "number_of_lanes": 2$\}$, "E2": $\{$ "direction": "l", "number_of_lanes": 1$\}, \ldots\}$ |

of considerations, enabling the LLM to accurately interpret traffic conditions and effectively manage traffic signals to mitigate congestion. The system prompt comprises five components, as depicted in Fig. 4.

The initial component is the task description, which articulates the LLM's objective in traffic signal control. After the task description, the second component is a detailed briefing on the functionalities of each integrated tool within the LALight framework. This briefing encompasses a list of tools, their respective purposes, the types of input they require, the output they generate, and illustrative examples of their use in practice. The third component consolidates observational data, which includes the most recent outputs from tool usage as well as the preceding chat history. This compilation of data equips the LLM with the relevant information needed for informed decision-making in subsequent interactions.

The fourth element of the system prompt addresses traffic regulations and other essential considerations that the LLM must take into account. This includes adherence to specific traffic laws and the integration of vital factors that influence the decision-making process when utilizing the tools. It ensures that the LLM's actions are not only optimized for traffic flow but also compliant with legal and safety standards. The final component of the system prompt outlines the expected output format. By defining the output format, the system facilitates seamless communication between the LLM and the traffic control tools, ensuring that the decisions are implemented effectively and efficiently.

To further refine the decision-making process, each tool within the LA-Light system is accompanied by its own tailored prompt. These prompts are composed of four parts, enhancing the clarity and precision with which the tools can be operated. For instance, Table I shows the prompt structure for the tool Get_Intersection_Layout. The first part provides a detailed description of the tool's capabilities. The second part outlines the necessary inputs required by the tool and the third part describes the output generated by the tool. Finally, a practical example is provided in Table $I$ to illustrate how the tool is used and the example of the output.

## V. EXPERIMENTS

## A. Experiment Setting

The experiments were carried out using the Simulation of Urban MObility (SUMO) [39], a widely recognized open source traffic simulator. To accurately capture traffic dynamics at intersections, we used virtual lane area detectors in the simulation to collect data such as vehicle count and queue length for each lane. Due to the constraints of simulated camera resolution, the scope of data collection was limited to a maximum of 150 meters from the intersection. This limitation was imposed to reflect realistic urban traffic monitoring conditions, although it is acknowledged that this may truncate actual queue lengths exceeding this distance.

In configuring the traffic signals, we adhered to common urban signaling sequences: a green light phase, followed by a 3-second yellow light, and then a red light phase. We set the parameters to match the realistic urban traffic flow, with a maximum speed limit of $13.9 \mathrm{~m} / \mathrm{s}$ (i.e., $50 \mathrm{~km} / \mathrm{h}$ ). The minimum distance between vehicles was kept at 2.5 meters, consistent with safe driving distances in city environments. Vehicle speeds were modeled with a Gaussian distribution, having a mean of $10 \mathrm{~m} / \mathrm{s}$ and a standard deviation of $\sqrt{3} \mathrm{~m} / \mathrm{s}$, to account for the variability in driver behavior. For the purposes of this study, we employed the GPT-4 Turbo model without any additional fine-tuning specific to TSC tasks. This choice was made to evaluate the model's out-of-the-box capabilities in managing complex traffic scenarios.

## B. Datasets and Scenarios

Our experiment utilizes both synthetic and real-world datasets to evaluate the performance of the proposed LA-Light in traffic signal control. The synthetic dataset includes scenarios of isolated intersections with varying layouts: a threeway intersection and a four-way intersection, both featuring three lanes per approach. For real-world data, we focus on the urban road network surrounding Chenta Road in the Songjiang District of Shanghai, a region known for its heavy traffic congestion due to high-density construction and commercial activities. The network, illustrated in Fig. 5. encompasses 18 intersections, comprising a combination of twelve four-way and six three-way intersections. To collect traffic flow data,

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-07.jpg?height=1593&width=868&top_left_y=434&top_left_x=173)

Fig. 4. System Prompt structure within the LA-Light framework. The design incorporates five components: (1) Task Description, detailing the LLM's role in traffic signal management; (2) Tools Synopsis, providing a catalog and description of available traffic control tools; (3) Observations Data, compiling data from tool feedback and chat history of the preceding cycle; (4) Attention Points, emphasizing compliance with traffic regulations and safety guidelines in tool deployment; and (5) Output Format, defining the protocol for the LLM's decision communication to ensure proper tool utilization. we analyzed video surveillance from these intersections on 30 July 2021. We recorded the number of vehicles per minute, which was then utilized to recreate the traffic scenarios in the SUMO platform.

To ensure a comprehensive evaluation of LA-Light's performance in complex urban traffic situations, we designed three specific test scenarios for each road network, as illustrated in Fig. 6. The first scenario, depicted in Fig. 6a, is the Emergency Vehicle (EMV) Scenario. In this scenario, emergency vehicles, such as ambulances, are introduced into the normal traffic flow, making up $1 \%$ of the overall traffic volume. These vehicles are assigned random origins and destinations to test the system's capability to prioritize them effectively. The second scenario, presented in Fig. 6b, is the Roadblock Incident (RBI) Scenario. This scenario mimics the dynamic nature of urban traffic by introducing random roadblocks, which stand in for unexpected incidents like traffic accidents. These roadblocks occur for $10 \%$ of the total simulation time, temporarily closing off affected lanes and testing the system's responsiveness to such events. The final scenario, shown in Fig. 6c, is the Sensor Outage (SO) Scenario. This scenario simulates sensor reliability challenges by introducing a $10 \%$ chance of sensor failure at any moment during the simulation. Such a failure results in the complete loss of vehicle detection data for that direction, challenging the system's ability to maintain efficient traffic control despite missing information.

## C. Metrics

To evaluate the effectiveness of TSC strategies, this study utilizes a dual-perspective approach to metrics. We measure the Average Travel Time (ATT), which is the time taken by vehicles to travel from their origin to their destination. ATT is a critical metric for assessing traffic flow efficiency within the network. Alongside ATT, we examine the Average Waiting Time (AWT). AWT measures the average time vehicles spend traveling at speeds below $0.1 \mathrm{~m} / \mathrm{s}$, typically while waiting for the green signal, thus providing a direct measure of intersection delay.

To address the urgency of emergency services, we incorporate specific metrics for emergency vehicles. The Average Emergency Travel Time (AETT) and the Average Emergency Waiting Time (AEWT) are calculated separately to underscore the TSC's impact on prioritized vehicle movement. These metrics are essential for comparing TSC strategies that can adapt in emergency situations, an integral aspect of proficient urban traffic management.

## D. Compared Methods

To assess the efficacy of the LA-Light model, we benchmarked it against a range of established TSC strategies. This benchmarking includes traditional transportation approaches as well as algorithms based on RL. We also evaluated the effectiveness of an LLM when used directly for decisionmaking, without the aid of Chain-of-Thought reasoning [40] and integration with existing TSC algorithms. The traditional traffic control methods are as follows:

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-08.jpg?height=889&width=914&top_left_y=217&top_left_x=153)

(a)

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-08.jpg?height=889&width=897&top_left_y=217&top_left_x=1053)

(b)

Fig. 5. Traffic Network at Chenta Road, Songjiang District, Shanghai. (a) on Google Maps. (b) in the SUMO simulator.

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-08.jpg?height=559&width=556&top_left_y=1279&top_left_x=188)

(a)

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-08.jpg?height=559&width=572&top_left_y=1279&top_left_x=771)

(b)

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-08.jpg?height=556&width=566&top_left_y=1283&top_left_x=1365)

(c)

Fig. 6. Illustration of the three test scenarios. (a) Emergency Vehicle (EMV) Scenario, where ambulances are integrated into traffic flow; (b) Roadblock Incident (RBI) Scenario, depicting temporary road closures due to accidents or other events; (c) Sensor Outage (SO) Scenario, demonstrating the effects of sensor failures on traffic data accuracy.

- Webster [3]: This approach involves calculating the optimal signal cycle lengths and phase splits based on current traffic volumes and signal phase sequences. For this study, we implemented a real-time version of Webster's method, which dynamically adjusts the traffic signals in response to actual traffic conditions.
- SOTL [4]: The SOTL method evaluates the maximum queue length in the lanes associated with the current and subsequent signal phases. If the queue for the current phase is long, the green signal is extended; otherwise, the system triggers a shift to the next phase.
- Maxpressure [19]: This advanced transportation method for traffic light control aims to reduce congestion in the lanes that exhibit the highest pressure. This pressure is quantified by the difference in queue lengths between upstream and downstream lanes. The method focuses on alleviating congestion where it is most needed.

For the RL-based models, we include:

- IntelliLight [21]: This model leverages a state representation enriched with lane-specific details, including vehicle count and waiting time, thus providing a nuanced view of traffic conditions beyond simple queue length. The reward function of IntelliLight accounts for the frequency of signal changes, and it introduces a phase-gate model to
mitigate the challenge of skewed phase data distribution.
- PressLight [12]: An extension of the Maxpressure algorithm, PressLight combines deep reinforcement learning with the pressure optimization concept to dynamically adjust signals at intersections, aiming to maintain optimal flow.
- AttendLight [20]: Implementing an attention mechanism, AttendLight builds a set of observational features that inform the probability of phase changes, thus refining the signal timing optimization process.
- UniTSA [18]: Introducing a sophisticated intersection representation known as the junction matrix, UniTSA also brings five novel traffic state augmentation methods tailored to enhance signal control system performance.

Additionally, this study contrasts the proposed LA-Light system with a baseline LLM-based TSC method, herein referred to as Vanilla-LLM, which utilizes an LLM directly for TSC decision-making. Unlike LA-Light, the Vanilla-LLM approach does not incorporate Chain-of-Thought reasoning or supplemental decision-support tools. It relies solely on the model's inherent capabilities to interpret traffic data and make determinations based on the real-time traffic conditions. Key differences between the LA-Light framework and the VanillaLLM method are delineated in Table II.

TABLE II

COMPARISON OF LA-LIGHT AND VANILLA-LLM

| Tool/Component | Vanilla-LLM | LA-Light |
| :---: | :---: | :---: |
| Perception Tools (Static) |  |  |
| Get_Intersection_Layout | $\times$ | $\checkmark$ |
| Get_Signal_Phase_Structure | $\times$ | $\checkmark$ |
| Perception Tools (Dynamic) |  |  |
| Get_Occupancy | $\times$ | $\checkmark$ |
| Get_Queue_Length | $\times$ | $\checkmark$ |
| Get_Phase_ID | $\times$ | $\checkmark$ |
| Get_Junction_Situation | $\times$ | $\checkmark$ |
| Decision Tools (Support) | $\times$ |  |
| Get_Auxiliary_Decision | $\times$ | $\checkmark$ |
| Get_Available_Actions |  | $\checkmark$ |
| Decision Tools (Evaluate) | $\checkmark$ |  |
| Evaluate_Action_Feasibility | $\checkmark$ |  |
| Justify_Decision_Logic |  | $\checkmark$ |
| Additional Capabilities |  |  |
| Chain-of-Thought Reasoning |  |  |
| Ehat History Analysis |  |  |

## E. Performance Analysis

In this section, we assess the performance of the proposed LA-Light framework alongside various benchmark methods across three distinct road maps, with each map featuring three unique scenarios. Table III presents the results under the EMV
Scenario. LA-Light's comparative analysis against traditional traffic signal control methods, RL-based approaches, and other LLM-based methods demonstrates a comprehensive enhancement in traffic signal control efficiency for both regular and emergency vehicles. For example, in comparison with the Maxpressure approach, LA-Light achieves a $32.1 \%$ reduction in ATT for the four-way intersection (4-Way INT) and a $10.8 \%$ reduction for the Shanghai network. In terms of emergency vehicle efficiency, indicated by AETT, LA-Light shows a significant improvement, reducing AETT by $15.3 \%$ in the Shanghai network compared to Maxpressure. This improvement is attributed to the integration of RL algorithms within LA-Light, which refines decision-making processes in standard traffic scenarios.

When compared with RL-based methods, LA-Light does not always surpass in ATT and AWT, yet it significantly outperforms in emergency vehicle efficiency. For instance, while AttendLight records a lower ATT by $3.3 \%$ for the three-way intersection (3-Way INT), LA-Light outperforms it in AEWT by $67.3 \%$ for the same scenario. This highlights LA-Light's capability to assimilate environmental observations and adjust to dynamic changes, emphasizing its robustness in urgent situations without specialized fine-tuning. Furthermore, when LA-Light is compared to another LLM-based method, Vanilla-LLM, it exhibits a notable improvement in ATT and AWT across all tested networks. Specifically, in the complex Shanghai network, LA-Light reduces ATT and AWT by $16.5 \%$ and $24.2 \%$, respectively, compared to Vanilla-LLM. The integration of existing TSC methods within LA-Light's decision-making framework likely contributes to its enhanced traffic efficiency, demonstrating the potential of LLM-assisted approaches in urban traffic management.

Table IV details the performance outcomes in the RBI Scenario, where LA-Light's adaptability to unforeseen traffic events is pronounced. Traditional transportation methods like Webster, SOTL, and Maxpressure, which depend on fixed algorithms, are less adept at adjusting to sudden changes such as those introduced by roadblocks. RL-based methods are more adaptable but are still constrained by their reliance on previously learned strategies, which may not be sufficiently flexible for drastic alterations in road capacity. LA-Light, leveraging the real-time processing abilities of its LLM, dynamically responds to these traffic alterations. In the 3-Way INT scenario, LA-Light shows a $2.2 \%$ reduction in ATT and a $6.3 \%$ reduction in AWT in comparison to IntelliLight, the most effective RL-based method. In the more intricate Shanghai network, LA-Light's performance is even more notable, with a $6.8 \%$ improvement in ATT and a $11.3 \%$ improvement in AWT over UniTSA, the best RL-based approach.

Furthermore, LA-Light's proficiency extends to emergency response metrics, such as AETT and AEWT. On the 4way INT, LA-Light shows a $35.6 \%$ betterment in AETT and a $74.5 \%$ enhancement in AEWT compared to UniTSA. Against another LLM-based method, Vanilla-LLM, LA-Light underscores the value of not only LLM's decision-making capabilities but also the sophisticated integration of chainof-thought reasoning with effective tool utilization. This is particularly evident in the Shanghai network, where LA-Light

TABLE III

PERFORMANCE COMPARISON UNDER THE EMERGENCY VEHICLE (EMV) SCENARIO. THE BEST, SECOND-BEST RESULTS ARE HIGHLIGHTED THROUGH BOLD, AND UNDERLINING, RESPECTIVELY.

| Method | 3-Way INT |  |  |  | 4 Way INT |  |  |  | Shanghai |  |  |  |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
|  | ATT | $\overline{A W T}$ | AETT | AEWT | ATT | AWT | AETT | AEWT | ATT | AWT | AETT | AEWT |
|  | Traditional Transportation Approaches |  |  |  |  |  |  |  |  |  |  |  |
| Webster | 71.708 | 34.443 | 89.738 | 45.730 | 122.135 | 64.074 | 139.550 | 86.188 | 538.614 | 152.957 | 504.267 | 155.110 |
| Maxpressure | 63.860 | 29.494 | 83.728 | 39.859 | 103.598 | 51.415 | 109.824 | 58.344 | 461.965 | 96.820 | 438.092 | 102.515 |
|  | RL-based Methods |  |  |  |  |  |  |  |  |  |  |  |
| AttendLight | 61.750 | 26.796 | 77.926 | 34.229 | 74.538 | 32.341 | 88.569 | 46.743 | 429.452 | 81.017 | 432.419 | 116.944 |
| UniTSA | 67.848 | $\underline{21.424}$ | 83.236 | 38.073 | 64.032 | 27.224 | 73.941 | 40.228 | 398.374 | $\underline{79.426}$ | 403.642 | 98.593 |
|  | LLM-based Methods |  |  |  |  |  |  |  |  |  |  |  |
| Vanilla-LLM | 77.423 | 36.609 | 46.970 | 9.862 | 87.738 | 48.167 | $\underline{49.324}$ | $\underline{11.010}$ | 493.577 | 109.182 | $\underline{391.836}$ | $\underline{35.246}$ |
| LA-Light | 63.853 | 22.516 | $\underline{48.824}$ | $\underline{11.251}$ | $\underline{69.965}$ | 31.457 | $\overline{47.808}$ | $\overline{10.435}$ | 411.826 | 82.802 | $\overline{371.997}$ | $\overline{17.476}$ |

TABLE IV

PERFORMANCE COMPARISON UNDER THE ROADBLOCK INCIDENT (RBI) SCENARIO.

| Method | 3-Way INT |  |  |  | 4 Way INT |  |  |  | Shanghai |  |  |  |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
|  | ATT | $\overline{\mathrm{AWT}}$ | AETT | AEWT | ATT | $\overline{\mathrm{AWT}}$ | AETT | AEWT | ATT | AWT | $\overline{\text { AETT }}$ | AEWT |
| Webster | 83.019 | 38.768 | 102.043 | 59.879 | 132.069 | 80.311 | 138.364 | 82.314 | 596.965 | 282.545 | 674.380 | 177.341 |
| Maxpressure | 73.811 | 32.910 | 96.754 | 58.398 | 115.573 | 64.153 | 102.236 | 54.278 | 512.578 | 118.984 | 477.416 | 92.406 |
|  | RL-based Methods |  |  |  |  |  |  |  |  |  |  |  |
| IntelliLight | $\underline{68.007}$ | $\underline{29.178}$ | 71.237 | 38.331 | 80.973 | 48.819 | 90.449 | 47.794 | 494.662 | 117.503 | 475.623 | 106.845 |
| AttendLight | 69.418 | 29.849 | 92.717 | 54.235 | $\underline{78.364}$ | $\underline{35.330}$ | 76.735 | 26.958 | 493.844 | 121.402 | 477.328 | 131.610 |
| UniTSA | 79.760 | 43.367 | 83.354 | 49.510 | $\overline{81.650}$ | $\overline{38.604}$ | 78.828 | 38.693 | 467.262 | 97.154 | 410.960 | 70.844 |
|  | LLM-based Methods |  |  |  |  |  |  |  |  |  |  |  |
| Vanilla-LLM | 79.967 | 34.122 | 54.912 | 15.939 | 93.009 | 47.206 | $\underline{73.451}$ | $\underline{24.523}$ | 490.522 | 93.035 | 420.371 | $\underline{51.674}$ |
| LA-Light | 66.510 | 27.208 | $\underline{55.094}$ | $\underline{20.458}$ | 71.982 | 33.266 | 64.808 | $\overline{18.900}$ | 435.698 | $\underline{86.902}$ | 379.822 | $\overline{23.031}$ |

TABLE V

PERFORMANCE COMPARISON UNDER THE SENSOR OUTAGE (SO) SCENARIO.

| Method | 3-Way INT |  |  |  | 4 Way INT |  |  |  | Shanghai |  |  |  |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: | :---: |
|  | ATT | AWT | AETT | AEWT | ATT | AWT | AETT | AEWT | ATT | AWT | AETT | AEWT |
|  | Traditional Transportation Approaches |  |  |  |  |  |  |  |  |  |  |  |
| Webster | 78.449 | 33.250 | 82.845 | 45.740 | 124.008 | 67.745 | 134.664 | 80.372 | 548.485 | 159.720 | 582.200 | 202.231 |
| Maxpressure | $\underline{69.076}$ | 28.555 | 68.010 | 39.950 | 107.863 | 62.312 | 127.463 | 82.852 | 538.497 | 128.103 | 551.391 | 174.590 |
|  | RL-based Methods |  |  |  |  |  |  |  |  |  |  |  |
| AttendLight | 73.108 | $\underline{29.473}$ | 77.385 | 36.563 | 86.714 | 41.764 | 99.366 | 55.019 | 557.932 | 192.267 | 625.205 | 282.224 |
| UniTSA | 83.429 | 50.217 | 89.839 | 47.719 | $\underline{81.370}$ | $\underline{39.792}$ | 82.158 | 41.203 | $\underline{474.909}$ | 103.004 | 497.134 | 124.262 |
|  | LLM-based Methods |  |  |  |  |  |  |  |  |  |  |  |
| Vanilla-LLM | 81.125 | 44.184 | $\underline{49.412}$ | $\underline{13.754}$ | 85.993 | 40.698 | $\underline{56.215}$ | $\underline{13.356}$ | 496.504 | 109.405 | $\underline{407.128}$ | $\underline{38.696}$ |
| LA-Light | 67.726 | 23.520 | 46.568 | 10.759 | 72.071 | 33.874 | 47.204 | 9.741 | 438.408 | 82.600 | 380.228 | 21.086 |

achieves a $16.6 \%$ reduction in ATT and a remarkable $51.4 \%$ improvement in AEWT compared to Vanilla-LLM.

Finally, Table V shows the performance under SO Scenario. Similar to the conclusion under RBI Scenario, the result demonstrates LA-Light's capability to effectively manage traffic even with sensor failures, a rare but critical challenge. For example, in the complex Shanghai network, LA-Light significantly reduces ATT and AWT by $20.0 \%$ and $35.9 \%$, respectively, compared to the Maxpressure method. While RLbased methods exhibit a degree of adaptability, they struggle in the absence of sensor data. Our method, LA-Light, addresses this shortcoming by utilizing common sense reasoning and the tools at hand. Compared to UniTSA, the top-performing RLbased method in this scenario, LA-Light achieves a $7.7 \%$ improvement in ATT and a $20.4 \%$ reduction in AWT. Moreover, LA-Light's performance excels against another LLM-based method, Vanilla-LLM, with an $11.7 \%$ betterment in ATT and a $24.8 \%$ enhancement in AWT, highlighting the efficiency of its decision-making process in scenarios with incomplete data, and confirming its robustness as a reliable traffic management solution.

The comparative analysis of LA-Light's performance in varying scenarios underscores its reliable effectiveness amidst environmental uncertainties. Notably, within the Shanghai network, the shift from the EMV to the SO scenario resulted in a modest increase $6.9 \%$ in ATT and a $0.2 \%$ in AWT, demonstrating LA-Light's commendable stability. This performance is markedly superior to RL-based methods, such as UniTSA, which exhibited a significant performance drop, $16.1 \%$ in ATT and $23.3 \%$ in AWT, under the same conditions. Further, LALight's emergency response metrics, specifically AETT and AEWT, remain the best among all benchmarks in all three scenarios. This consistency confirms the resilience of the LALight framework, which leverages LLMs to ensure minimal performance decline even in less common situations. These results emphasize LA-Light's capability to deliver dependable traffic signal control in diverse and complex urban environments.

## F. Case Study Insights

In this section, we conduct a comprehensive analysis of the decision-making processes utilized by the LA-Light across a variety of traffic conditions. We first compare the decision of our method with that of the UniTSA in different traffic scenarios. These results are depicted in Fig. 7 for the synthetic dataset and Fig. 8 for scenarios in Shanghai. In the synthetic dataset, as depicted in Fig. 7, the LA-Light framework demonstrates enhanced adaptability. For example, in the EMV Scenario at the 3 Way INT, UniTSA changes the signal from phase $P_{1}$ to $P_{2}$, giving priority to the larger volume of vehicles turning left from the west side (W-1). However, this action inadvertently causes a delay for the emergency vehicle. In contrast, LA-Light, utilizing the LLM's nuanced understanding of the scenario, changes the green phase to $P_{2}$, which, despite the queue forming on the north side (N-1), allows the emergency vehicle to pass without delay. Similarly, in the SO Scenario at the 4 Way INT, UniTSA fails to receive accurate data from the north side due to a damaged sensor. As a result, it mistakenly extends the green phase for $P_{4}$, which worsens the congestion on the north side. LA-Light, on the other hand, identifies the faulty sensor data and integrates this information with the real-time traffic conditions on the south side. It infers that congestion is increasing on the north side and accordingly adjusts the signal to green phase $P_{1}$, which is for the north-south through traffic, effectively reducing the congestion at the intersection.

The real-world scenarios presented in Fig. 8 further highlight the effectiveness of the LA-Light system in navigating the complexities of urban traffic networks. In the EMV Scenario within the Shanghai network, LA-Light aptly prolongs the current green phase $P_{4}$, allowing the emergency vehicle to pass swiftly. In contrast, UniTSA does not give precedence to the emergency vehicle, opting instead to clear lanes with higher vehicle accumulation, thereby neglecting the urgency of emergency response. In the RBI Scenario, where an obstruction is present on the east exit road, LA-Light successfully infers the larger traffic impact and redirects the green phase towards lanes that are not affected, preventing further congestion. UniTSA, however, defaults to activating the green phase for $P_{3}$, which is rendered ineffective as the blockage hinders northbound traffic from proceeding, leading to a suboptimal use of the green phase. These case studies demonstrate that LA-Light can dynamically adapt to diverse and unpredictable environments, showcasing its potential for zero-shot adaptation in real-time traffic management.

In the following analysis, we explore the decision-making process of LA-Light in response to various urban traffic scenarios. Fig. 9 illustrates the steps taken under the SO Scenario. LA-Light begins its evaluation by analyzing both the static and dynamic aspects of the traffic intersection. These include the intersection's physical configuration, preset signal phase timings, and real-time traffic density for each lane and direction. During this initial phase, LA-Light identifies a discrepancy: the sensor on the "E1-s" (E1 straight) approach reports an occupancy of $-100 \%$, clearly signaling a fault, as negative occupancy is not feasible. Simultaneously, it notes significant congestion on the "E3-s" direction, with an occupancy of $62.87 \%$, and the "E2-l" direction, with $54.00 \%$ occupancy. Facing incomplete data, LA-Light uses an auxiliary decision-support tool for a reference solution. This tool suggests prioritizing phase $P_{4}$, managing left turns from E2 and E4 approaches, aiming to reduce queue lengths, especially for the congested "E2-l" movement.

However, LA-Light applies more complex reasoning. It considers the heavy congestion on the "E3-s" direction and the inoperative "E1-s" sensor, requiring a strategic response. The faulty sensor makes it impossible to estimate the queue on the "E1-s" approach accurately, which may be significant. LA-Light decides to deviate from UniTSA's advice, opting for phase $P_{1}$ to alleviate traffic from the "E1-s" and "E3$s$ " directions, likely facing higher demand. Additionally, LALight recommends a prompt on-site inspection of the "E1s" approach by traffic personnel to counter unreliable sensor data. This human intervention ensures the resilience of the decision-making process, even when automated systems are

EMV Scenario at 3 Way INT
![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-12.jpg?height=990&width=506&top_left_y=245&top_left_x=168)

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-12.jpg?height=485&width=409&top_left_y=245&top_left_x=663)

SO Scenario at 4 Way INT
![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-12.jpg?height=996&width=838&top_left_y=240&top_left_x=1096)

Fig. 7. Comparative analysis of UniTSA and LA-Light strategies in handling EMV and SO scenarios at synthetic intersections. The top row illustrates the decision and subsequent traffic flow impact of the UniTSA method, while the bottom row demonstrates the same for the LA-Light method. The sequence of actions and their effects on traffic dynamics are depicted, with the left side of each panel displaying the intersection conditions considered by each agent, and the right side showing the implemented actions and resultant traffic flow alterations at 3 Way INT and 4 Way INT.

EMV Scenario at Shanghai Network
![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-12.jpg?height=994&width=512&top_left_y=1512&top_left_x=167)
![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-12.jpg?height=992&width=428&top_left_y=1514&top_left_x=663)

RBI Scenario at Shanghai Network

![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-12.jpg?height=998&width=852&top_left_y=1512&top_left_x=1100)

Fig. 8. Comparative analysis of UniTSA and LA-Light strategies in handling EMV and RBI scenarios at the Shanghai network.
![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-13.jpg?height=1420&width=734&top_left_y=190&top_left_x=234)

## LA-Light (SO Scenario)

Thought 1: To make a decision, I first need to understand the static state of the traffic light $[. .$.

Act 1: Get_Intersection_Layout

Obs 1: The description of this intersection layout, "E1-s": \{"direction": "Through", "number of lanes": 2\}, "E1-l": \{"direction": “Left Turn","number of lanes": 1\}, [...] ...

Thought 4: The signal phase indicates that there are four phases controlling different sets of movements. Phase 1 controls the straight for E1 and E3, [...]. Next, I need to assess the dynamic state of the intersection to understand the congestion levels for each movement. [...]

Act 4: Get_Occupancy

Obs 4: At the current moment 136.0, the congestion situation of each movement is: \{"E1-s": "-100\%", "E1-l": "-100\%", "E2-s": "13.98\%", ...\} [...]

Thought 5: Currently, the "E3-s" movement has the highest congestion at $62.87 \%$, followed by [...]. The occupancy for "E1-s" and "E1-l" is reported as "-100\%", which indicates a malfunctioning detector or an error in the data. Before making a decision, I need to know what the Traditional Decision would be under the current circumstances and what actions are available to me.

Act 5: Get_Auxiliary_Decision

Obs 5: The decision is to set Phase 4 as the green signal.

Thought 6: The Traditional Decision suggests setting Phase 4 as the green signal. However, I must also consider the high congestion on the "E3-s". [...]. To ensure that I am making the best decision, I need to know what actions are available to me at this step.

Act 6: Get Available Actions

Obs 6: Phase 1; Phase 2; Phase 3; Phase 4.

...

## Final Decision \& Explanations

Decision: Phase 1

Explanations: The Traditional Decision recommends activating Phase 4. However, I also need to consider the high congestion on the "E3-s" movement and the fact that the "E1-s" detector is not working. [...] Phase 1 would address the highest congestion observed, which is on the "E3-s" movement. Balancing the need to follow the traditional decision with the observed congestion levels, I will prioritize the movement with the highest congestion, which is "E3-s". Therefore, my decision will be to activate Phase 1. I will also suggest that the Crossing Guard manually monitor the "E2-s" movement due to the malfunctioning detector.

Fig. 9. Decision-making process and explanation of LA-Light during the SO Scenario.

compromised.

Fig. 10 illustrates LA-Light's decision-making process in the RBI Scenario, starting with gathering crucial data from the intersection as done in the SO Scenario depicted in Fig. 9. The "get junction situation" function is then used, revealing a blockage on the E2 outgoing edge due to a vehicular accident. After that, LA-Light performs a detailed evaluation of the intersection's condition, determining that the "E1-l" and "E4s" movements, associated with $P_{2}$ and $P_{3}$ phases of the traffic signals, are the most affected by the accident.

Having pinpointed the affected phases, LA-Light employs the tool to list all potential signal phases, then eliminates those hindered by the incident. This process leaves $P_{1}$ and $P_{4}$ as the feasible choices. In choosing between them, LALight examines the current congestion at the intersection. The decision-making is strategically grounded: the previous decision involved setting phase $P_{1}$ to a green signal to reduce congestion in the "E1-s" and "E3-s" directions. This move has effectively shortened queue lengths according to the latest data. Thus, to continue efficient traffic management and to alleviate congestion elsewhere, LA-Light opts for $P_{4}$. This phase controls the "E2-l" and "E4-l" movements, which, though congested, are clear of obstructions and can therefore benefit from a longer green signal. The selection of $P_{4}$ is deliberate, in line with LA-Light's goal to manage congestion proactively while avoiding the areas affected by the accident. This decision showcases LA-Light's capacity to adjust dynamically to real-time traffic situations, using its computational capabilities to maintain traffic flow as smoothly as possible despite unexpected challenges. Additionally, the rationale behind the decisions made in both the SO and RBI scenarios is also clarified in Fig. 9 and Fig. 10. This transparency in the decision-making process enhances the reliability and trustworthiness of the signal control system.

## VI. CONCLUSION

In this work, we have presented the LA-Light framework, which incorporates LLMs to improve decision-making in the dynamic and complex environment of urban traffic management. By combining the sophisticated reasoning abilities
![](https://cdn.mathpix.com/cropped/2024_06_04_5923beedb385e7d0036dg-14.jpg?height=1428&width=692&top_left_y=190&top_left_x=236)

## LA-Light (RBI Scenario)

Thought 4: Now I need to determine if there is a long-tail problem, such as [...]. If there is a long-tail problem, I will need to analyze the available actions and make a judgment. If it's a standard situation, I will refer to the Traditional Decision.

Act 4: Get Junction Situation

Obs 4: Due to an accident, E2 outgoing lane is impassable.

Thought 5: The Junction Situation shows E2 outgoing lane is impassable. It indicates that movements E1-s, E2-s, E2-l, E3-s, E3-l and E4-l are passable, while E1-l and E4-s is blocked due to an accident, respectively. Given this information, I must avoid activating phases that include the impassable movements. [...] Next, I need to consider the available actions that do not include the impassable movements 'E1-l' and 'E4-s'. Phase 1 and Phase 4 are potential candidates since they do not include these movements. I will now check the available actions to make a final decision.

Act 5: Get_Available_Actions

Obs 5: Phase 1; Phase 2; Phase 3; Phase 4.

Thought 6: Having reviewed the available actions, I am inclined to activate Phase 4 as the green signal. [...] However, before I commit to this decision, it is critical to reassess the viability of this action in the current traffic context to ensure it does not exacerbate the situation or overlook any unseen complications.

Act 6: Evaluate_Action_Feasibility ("Phase 4")

Obs 6: Activation of Phase 4 is feasible and will not interfere with emergency response efforts $\cdots$


#### Abstract

Final Decision \& Explanations Decision: Phase 4

Explanations: Given the available actions and the need to avoid phases that include impassable movements, I must choose between Phase 1 and Phase 4. [...] To make an informed decision between Phase 1 and Phase 4, I should consider the current occupancy rates for the movements included in these phases. Phase 1 controls the movements 'E1-s' and 'E3-s', while Phase 4 controls the movements 'E2-l', 'E4-l'. Since the last decision made was to activate Phase 1 to alleviate congestion in the 'E1-s' and 'E3-s' movements, and considering that these movements queue length have reduced, it would be reasonable to change to Phase 4 to reduce congestion in 'E2-l', 'E4-l' movement. Therefore, my decision is to activate Phase 4, as it addresses the congested movements that are passable and does not include any impassable movements.


Fig. 10. Decision-making process and explanation of LA-Light during the RBI Scenario.

of LLMs with established TSC methods and real-time data collection tools, we have established a new approach to traffic signal control. Our comprehensive evaluation of LALight, conducted across three distinct traffic networks and nine unique scenarios, has shown its effectiveness without necessitating further training. Compared to traditional methods, LALight has consistently achieved reductions in ATT and AWT. Additionally, it has demonstrated improvements in metrics for emergency response vehicles, such as AETT and AEWT. Analysis of the decision-making process in various contexts revealed that LA-Light excels not only in operational performance but also in decision-making clarity, courtesy of the LLMs' explanatory capabilities. LA-Light adeptly identifies and utilizes the most suitable tools for a given traffic situation, providing clear insights into its decision-making rationale.

While the LA-Light framework marks a significant step forward, it does have areas that require further refinement. The framework's current dependency on frequent interactions with the LLM for decision-making introduces a delay that could impact the promptness of traffic signal adjustments. Moreover, the framework's reliance on textual descriptions to depict traffic scenarios may not encompass all the details needed for the most effective decision-making, pointing to the potential benefits of a more direct, image-based approach that can interpret traffic conditions from visual data. Future work will aim to address these issues by refining the interaction process to expedite response times and by incorporating vision-based models capable of directly processing visual information. These enhancements are expected to improve the framework's proficiency in managing the complexities of real-world traffic systems with increased speed and less reliance on textual descriptions.

## REFERENCES

[1] M. Sweet, "Does traffic congestion slow the economy?," Journal of Planning Literature, vol. 26, no. 4, pp. 391-404, 2011.

[2] D. Zhao, Y. Dai, and Z. Zhang, "Computational intelligence in urban traffic signal control: A survey," IEEE Transactions on Systems, Man, and Cybernetics, Part C (Applications and Reviews), vol. 42, no. 4, pp. 485-494, 2011.

[3] P. Koonce and L. Rodegerdts, "Traffic signal timing manual.," tech. rep., United States. Federal Highway Administration, 2008.

[4] S.-B. Cools, C. Gershenson, and B. D'Hooghe, "Self-organizing traffic lights: A realistic simulation," Advances in applied self-organizing systems, pp. 45-55, 2013.

[5] S. S. S. M. Qadri, M. A. Gökçe, and E. Öner, "State-of-art review of traffic signal control methods: challenges and opportunities," European transport research review, vol. 12, pp. 1-23, 2020.

[6] H. Wei, G. Zheng, V. Gayah, and Z. Li, "A survey on traffic signal control methods," arXiv preprint arXiv:1904.08117, 2019.

[7] H. Vardhan and J. Sztipanovits, "Rare event failure test case generation in learning-enabled-controllers," in 6th International Conference on Machine Learning Technologies, pp. 34-40, 2021.

[8] F. J. Martinez, C. K. Toh, J.-C. Cano, C. T. Calafate, and P. Manzoni, "A survey and comparative study of simulators for vehicular ad hoc networks (VANETs)," Wireless Communications and Mobile Computing, vol. 11, no. 7, pp. 813-828, 2011.

[9] P. Hunt, D. Robertson, R. Bretherton, and M. C. Royle, "The scoot on-line traffic signal optimisation technique," Traffic Engineering \& Control, vol. 23, no. 4, 1982.

[10] P. Lowrie, "Scats-a traffic responsive method of controlling urban traffic," Sales information brochure published by Roads \& Traffic Authority, Sydney, Australia, 1990.

[11] C. Wu, I. Kim, and Z. Ma, "Deep reinforcement learning based traffic signal control: A comparative analysis," Procedia Computer Science, vol. 220, pp. 275-282, 2023.

[12] H. Wei, C. Chen, G. Zheng, K. Wu, V. Gayah, K. Xu, and Z. Li, "Presslight: Learning max pressure control to coordinate traffic signals in arterial network," in Proceedings of the 25th ACM SIGKDD International Conference on Knowledge Discovery \& Data Mining, pp. 12901298,2019

[13] X. Zang, H. Yao, G. Zheng, N. Xu, K. Xu, and Z. Li, "Metalight: Value-based meta-reinforcement learning for traffic signal control," in Proceedings of the AAAI Conference on Artificial Intelligence, vol. 34, pp. 1153-1160, 2020

[14] C. Chen, H. Wei, N. Xu, G. Zheng, M. Yang, Y. Xiong, K. Xu, and Z. Li, "Toward a thousand lights: Decentralized deep reinforcement learning for large-scale traffic signal control," in Proceedings of the AAAI Conference on Artificial Intelligence, vol. 34, pp. 3414-3421, 2020.

[15] A. Pang, M. Wang, Y. Chen, M.-O. Pun, and M. Lepech, "Scalable reinforcement learning framework for traffic signal control under communication delays," IEEE Open Journal of Vehicular Technology, 2024.

[16] T. Chu, J. Wang, L. Codecà, and Z. Li, "Multi-agent deep reinforcement learning for large-scale traffic signal control," IEEE Transactions on Intelligent Transportation Systems, vol. 21, no. 3, pp. 1086-1095, 2019.

[17] M. Wang, Y. Xu, X. Xiong, Y. Kan, C. Xu, and M.-O. Pun, "ADLight: A universal approach of traffic signal control with augmented data using reinforcement learning," in Transportation Research Board (TRB) 102nd Annual Meeting, 2023.

[18] M. Wang, X. Xiong, Y. Kan, C. Xu, and M.-O. Pun, "UniTSA: A universal reinforcement learning framework for $\mathrm{v} 2 \mathrm{x}$ traffic signal control," arXiv preprint arXiv:2312.05090, 2023.

[19] P. Varaiya, "Max pressure control of a network of signalized intersections," Transportation Research Part C: Emerging Technologies, vol. 36, pp. 177-195, 2013.

[20] A. Oroojlooy, M. Nazari, D. Hajinezhad, and J. Silva, "Attendlight: Universal attention-based reinforcement learning model for traffic signal control," Advances in Neural Information Processing Systems, vol. 33, pp. 4079-4090, 2020.

[21] H. Wei, G. Zheng, H. Yao, and Z. Li, "Intellilight: A reinforcement learning approach for intelligent traffic light control," in Proceedings of the 24th ACM SIGKDD International Conference on Knowledge Discovery \& Data Mining, pp. 2496-2505, 2018.

[22] S. Bouktif, A. Cheniki, A. Ouni, and H. El-Sayed, "Deep reinforcement learning for traffic signal control with consistent state and reward design approach," Knowledge-Based Systems, vol. 267, p. 110440, 2023.

[23] L. Floridi and M. Chiriatti, "GPT-3: Its nature, scope, limits, and consequences," Minds and Machines, vol. 30, pp. 681-694, 2020.

[24] OpenAI, "Introducing ChatGPT." https://openai.com/blog/chatgpt/ 2023.

[25] H. Touvron, T. Lavril, G. Izacard, X. Martinet, M.-A. Lachaux, T. Lacroix, B. Rozière, N. Goyal, E. Hambro, F. Azhar, et al., "Llama: Open and efficient foundation language models," arXiv preprint arXiv:2302.13971, 2023.

[26] H. Touvron, L. Martin, K. Stone, P. Albert, A. Almahairi, Y. Babaei, N. Bashlykov, S. Batra, P. Bhargava, S. Bhosale, et al., "Llama 2: Open foundation and fine-tuned chat models," arXiv preprint arXiv:2307.09288, 2023.
[27] A. Vaswani, N. Shazeer, N. Parmar, J. Uszkoreit, L. Jones, A. N. Gomez, Ł. Kaiser, and I. Polosukhin, "Attention is all you need," Advances in neural information processing systems, vol. 30, 2017.

[28] L. Ouyang, J. Wu, X. Jiang, D. Almeida, C. Wainwright, P. Mishkin, C. Zhang, S. Agarwal, K. Slama, A. Ray, et al., "Training language models to follow instructions with human feedback," Advances in Neural Information Processing Systems, vol. 35, pp. 27730-27744, 2022.

[29] J. Wei, X. Wang, D. Schuurmans, M. Bosma, F. Xia, E. Chi, Q. V. Le, D. Zhou, et al., "Chain-of-thought prompting elicits reasoning in large language models," Advances in Neural Information Processing Systems, vol. 35, pp. 24824-24837, 2022.

[30] S. Yao, J. Zhao, D. Yu, N. Du, I. Shafran, K. Narasimhan, and Y. Cao, "React: Synergizing reasoning and acting in language models," arXiv preprint arXiv:2210.03629, 2022.

[31] W. X. Zhao, K. Zhou, J. Li, T. Tang, X. Wang, Y. Hou, Y. Min, B. Zhang, J. Zhang, Z. Dong, et al., "A survey of large language models," arXiv preprint arXiv:2303.18223, 2023.

[32] Z. Xi, W. Chen, X. Guo, W. He, Y. Ding, B. Hong, M. Zhang, J. Wang, S. Jin, E. Zhou, et al., "The rise and potential of large language model based agents: A survey," arXiv preprint arXiv:2309.07864, 2023.

[33] C. Cui, Y. Ma, X. Cao, W. Ye, Y. Zhou, K. Liang, J. Chen, J. Lu, Z. Yang, K.-D. Liao, et al., "A survey on multimodal large language models for autonomous driving," in Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, pp. 958-979, 2024.

[34] C. Cui, Y. Ma, X. Cao, W. Ye, and Z. Wang, "Receive, reason, and react: Drive as you say with large language models in autonomous vehicles," arXiv preprint arXiv:2310.08034, 2023.

[35] L. Da, K. Liou, T. Chen, X. Zhou, X. Luo, Y. Yang, and H. Wei, "OpenTI: Open traffic intelligence with augmented language model," arXiv preprint arXiv:2401.00211, 2023.

[36] D. Fu, X. Li, L. Wen, M. Dou, P. Cai, B. Shi, and Y. Qiao, "Drive like a human: Rethinking autonomous driving with large language models," in Proceedings of the IEEE/CVF Winter Conference on Applications of Computer Vision, pp. 910-919, 2024.

[37] S. Sharan, F. Pittaluga, M. Chandraker, et al., "LLM-Assist: Enhancing closed-loop planning with language-based reasoning," arXiv preprint arXiv:2401.00125, 2023.

[38] V. Dewangan, T. Choudhary, S. Chandhok, S. Priyadarshan, A. Jain, A. K. Singh, S. Srivastava, K. M. Jatavallabhula, and K. M. Krishna, "Talk2BEV: Language-enhanced bird's-eye view maps for autonomous driving," arXiv preprint arXiv:2310.02251, 2023.

[39] P. A. Lopez, M. Behrisch, L. Bieker-Walz, J. Erdmann, Y.-P. Flötteröd, R. Hilbrich, L. Lücken, J. Rummel, P. Wagner, and E. Wießner, "Microscopic traffic simulation using sumo," in 21 st international conference on intelligent transportation systems (ITSC), pp. 2575-2582, IEEE, 2018.

[40] Z. Chu, J. Chen, Q. Chen, W. Yu, T. He, H. Wang, W. Peng, M. Liu, B. Qin, and T. Liu, "A survey of chain of thought reasoning: Advances, frontiers and future," arXiv preprint arXiv:2309.15402, 2023.

